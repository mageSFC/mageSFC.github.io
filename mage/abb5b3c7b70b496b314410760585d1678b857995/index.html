<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>jenkins学习之Jenkins流水线语法 | 马哥私房菜</title><meta name="author" content="mage"><meta name="copyright" content="mage"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="https:&#x2F;&#x2F;www.jenkins.io&#x2F;doc&#x2F;book&#x2F;pipeline&#x2F;syntax&#x2F; Declarative Pipeline所有有效的声明性管道都必须包含在管道块中，例如： 123pipeline &amp;#123;    &#x2F;* insert Declarative Pipeline here *&#x2F;&amp;#125;   agent代理 agent 部分指定整个pipeline或特定阶段 sta">
<meta property="og:type" content="article">
<meta property="og:title" content="jenkins学习之Jenkins流水线语法">
<meta property="og:url" content="https://magesfc.github.io/mage/abb5b3c7b70b496b314410760585d1678b857995/">
<meta property="og:site_name" content="马哥私房菜">
<meta property="og:description" content="https:&#x2F;&#x2F;www.jenkins.io&#x2F;doc&#x2F;book&#x2F;pipeline&#x2F;syntax&#x2F; Declarative Pipeline所有有效的声明性管道都必须包含在管道块中，例如： 123pipeline &amp;#123;    &#x2F;* insert Declarative Pipeline here *&#x2F;&amp;#125;   agent代理 agent 部分指定整个pipeline或特定阶段 sta">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg">
<meta property="article:published_time" content="2022-02-23T09:47:21.000Z">
<meta property="article:modified_time" content="2022-02-23T09:47:21.000Z">
<meta property="article:author" content="mage">
<meta property="article:tag" content="jenkins">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg"><link rel="shortcut icon" href="http://www.blackshark.com/favicon.ico"><link rel="canonical" href="https://magesfc.github.io/mage/abb5b3c7b70b496b314410760585d1678b857995/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":150,"languages":{"author":"作者: mage","link":"链接: ","source":"来源: 马哥私房菜","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'jenkins学习之Jenkins流水线语法',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-02-23 17:47:21'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><style type="text/css">.card-announcement .social-button{margin:.6rem 0 0 0;text-align:center}.card-announcement .social-button a{display:block;background-color:var(--btn-bg);color:var(--btn-color);text-align:center;line-height:2.4;margin:4px 0}.card-announcement .social-button a:hover{background-color:var(--btn-hover-color)}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">154</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">171</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">34</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> 精选文档</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/21cfbf15/"><span> 🚀 快速开始</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/dc584b87/"><span> 📑 主题页面</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4aa8abbe/"><span> 🛠 主题配置-1</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/ceeb73f/"><span> 🛠 主题配置-2</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/98d20436/"><span> ❓ 主题问答</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4073eda/"><span> ⚡️ 进阶教程</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/198a4240/"><span> ✨ 更新日志</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://butterfly.js.org/link/"><i class="fa-fw fas fa-thumbs-up"></i><span> 其他示例</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">马哥私房菜</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> 精选文档</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/21cfbf15/"><span> 🚀 快速开始</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/dc584b87/"><span> 📑 主题页面</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4aa8abbe/"><span> 🛠 主题配置-1</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/ceeb73f/"><span> 🛠 主题配置-2</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/98d20436/"><span> ❓ 主题问答</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4073eda/"><span> ⚡️ 进阶教程</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/198a4240/"><span> ✨ 更新日志</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://butterfly.js.org/link/"><i class="fa-fw fas fa-thumbs-up"></i><span> 其他示例</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">jenkins学习之Jenkins流水线语法</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-02-23T09:47:21.000Z" title="发表于 2022-02-23 17:47:21">2022-02-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-02-23T09:47:21.000Z" title="更新于 2022-02-23 17:47:21">2022-02-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/jenkins/">jenkins</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="jenkins学习之Jenkins流水线语法"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><a target="_blank" rel="noopener" href="https://www.jenkins.io/doc/book/pipeline/syntax/">https://www.jenkins.io/doc/book/pipeline/syntax/</a></p>
<h1 id="Declarative-Pipeline"><a href="#Declarative-Pipeline" class="headerlink" title="Declarative Pipeline"></a>Declarative Pipeline</h1><p>所有有效的声明性管道都必须包含在管道块中，例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    /* insert Declarative Pipeline here */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="agent"><a href="#agent" class="headerlink" title="agent"></a>agent</h2><p>代理 agent 部分指定整个pipeline或特定阶段 stage 将在 Jenkins 环境中执行的位置，具体取决于代理部分的放置位置。<br>该部分必须在pipeline块内的顶层定义，但阶段级别的 stage 使用也是可以的的。 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Required     Yes 是否必须有,</span><br><span class="line"></span><br><span class="line">Parameters   有参数，详细说明往下看</span><br><span class="line"></span><br><span class="line">Allowed      可以在顶层 pipeline 代码块里用，也可以在 stage 代码块里面用</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Top Level Agents</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">In agents declared at the outermost level of the Pipeline, the options are invoked after entering the agent. As an example, when using timeout it will be only applied to the execution within the agent.</span><br><span class="line">在 Pipeline 最外层声明的代理中，选项在进入代理后被调用。 例如，当使用超时时，它将仅应用于代理内的执行。这个时候 agent 代理已经分配好了，分配agent就不会算时间了</span><br><span class="line"></span><br><span class="line">node(&quot;myAgent&quot;) &#123;</span><br><span class="line">    timeout(unit: &#x27;SECONDS&#x27;, time: 5) &#123;</span><br><span class="line">        stage(&quot;One&quot;)&#123;</span><br><span class="line">            sleep 10</span><br><span class="line">            echo &#x27;hello&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>Stage Agents</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">In agents declared within a stage, the options are invoked before entering the agent and before checking any when conditions. In this case, when using timeout, it is applied before the agent is allocated.</span><br><span class="line">在阶段内声明的代理中，在进入代理之前和检查任何 when 条件之前调用选项。例如， 在这种情况下，当使用超时时，它会在分配代理之前应用。 </span><br><span class="line">此超时将包括代理配置时间。 由于超时包括代理供应时间，因此在代理分配延迟的情况下，管道可能会失败。 这种情况，如果你的节点是 用完销毁，用完下线的话，这次分配新的节点，或者重新连上节点，这一段的时间都会算在超时里面</span><br><span class="line"></span><br><span class="line">timeout(unit: &#x27;SECONDS&#x27;, time: 5) &#123;</span><br><span class="line">    stage(&quot;One&quot;)&#123;</span><br><span class="line">        node &#123;</span><br><span class="line">            sleep 10</span><br><span class="line">            echo &#x27;Hello&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="agent-参数"><a href="#agent-参数" class="headerlink" title="agent 参数"></a>agent 参数</h2><ol>
<li><p>any  Execute the Pipeline, or stage, on any available agent.<br>For example:<br> agent any</p>
</li>
<li><p>none When applied at the top-level of the pipeline block no global agent will be allocated for the entire Pipeline run and each stage section will need to contain its own agent section.<br>none 当应用于管道块的顶层时，不会为整个管道运行分配全局代理，每个阶段部分都需要包含自己的代理部分。<br>For example:<br> agent none</p>
</li>
<li><p>label    Execute the Pipeline, or stage, on an agent available in the Jenkins environment with the provided label.<br>For example:<br>agent { label ‘my-defined-label’ }</p>
</li>
</ol>
<p>Label conditions can also be used. For example:<br>    agent { label ‘my-label1 &amp;&amp; my-label2’ }<br>or<br>    agent { label ‘my-label1 || my-label2’ }</p>
<ol start="4">
<li><p>node  node 和label 类似，但是 node 支持 额外的更多的参数，例如customWorkspace<br> agent { node { label ‘labelName’ } } behaves the same as agent { label ‘labelName’ },<br> but node allows for additional options (such as customWorkspace).</p>
</li>
<li><p>docker Execute the Pipeline, or stage, with the given container which will be dynamically provisioned on a node pre-configured<br>to accept Docker-based Pipelines, or on a node matching the optionally defined label parameter.<br>docker also optionally accepts an args parameter which may contain arguments to pass directly to a docker run invocation, and an alwaysPull option, which will<br>force a docker pull even if the image name is already present.<br>使用给定的容器执行管道或阶段，该容器将在预先配置的节点上动态配置, 接受基于 Docker 的管道，或在与可选定义的标签参数匹配的节点上。<br>docker 也可以选择接受 一个 args 参数，它可能包含直接传递给 docker run 调用的参数，以及一个 alwaysPull 选项，它将  即使image名称已经存在，也强制执行 docker pull。</p>
</li>
</ol>
<p>For example:<br>    agent { docker ‘maven:3.8.1-adoptopenjdk-11’ }<br>or<br>    agent {<br>        docker {<br>            image ‘maven:3.8.1-adoptopenjdk-11’<br>            label ‘my-defined-label’<br>            args  ‘-v &#x2F;tmp:&#x2F;tmp’<br>        }<br>    }</p>
<p>docker 还可以选择接受 registryUrl 和 registryCredentialsId 参数，这将有助于指定要使用的 Docker Registry 及其凭据。 参数 registryCredentialsId 可以单独用于 docker hub 内的私有存储库。 例如：<br>    agent {<br>        docker {<br>            image ‘myregistry.com&#x2F;node’<br>            label ‘my-defined-label’<br>            registryUrl ‘<a target="_blank" rel="noopener" href="https://myregistry.com/&#39;">https://myregistry.com/&#39;</a><br>            registryCredentialsId ‘myPredefinedCredentialsInJenkins’<br>        }<br>    }</p>
<ol start="6">
<li><p>dockerfile Execute the Pipeline, or stage, with a container built from a Dockerfile contained in the source repository.<br>In order to use this option, the Jenkinsfile must be loaded from either a Multibranch Pipeline or a Pipeline from SCM.<br>Conventionally this is the Dockerfile in the root of the source repository: agent { dockerfile true }.<br>If building a Dockerfile in another directory, use the dir option: agent { dockerfile { dir ‘someSubDir’ } }.<br>If your Dockerfile has another name, you can specify the file name with the filename option.<br>You can pass additional arguments to the docker build …​ command with the additionalBuildArgs option,<br>like agent { dockerfile { additionalBuildArgs ‘–build-arg foo&#x3D;bar’ } }.<br>For example, a repository with the file build&#x2F;Dockerfile.build, expecting a build argument version:<br>使用从源存储库中包含的 Dockerfile 构建的容器执行管道或阶段。 为了使用此选项，必须从多分支管道或来自 SCM 的管道加载 Jenkinsfile。 通常这是源存储库根目录中的 Dockerfile：agent { dockerfile true }。 如果在另一个目录中构建 Dockerfile，请使用 dir 选项：agent { dockerfile { dir ‘someSubDir’ } }。 如果您的 Dockerfile 有其他名称，您可以使用 filename 选项指定文件名。 您可以使用 additionalBuildArgs 选项将其他参数传递给 docker build … 命令，例如 agent { dockerfile { additionalBuildArgs ‘–build-arg foo&#x3D;bar’ } }。 例如，具有文件 build&#x2F;Dockerfile.build 的存储库，需要构建参数版本：<br>agent {<br> &#x2F;&#x2F; Equivalent to “docker build -f Dockerfile.build –build-arg version&#x3D;1.0.2 .&#x2F;build&#x2F;<br> dockerfile {<br>     filename ‘Dockerfile.build’<br>     dir ‘build’<br>     label ‘my-defined-label’<br>     additionalBuildArgs  ‘–build-arg version&#x3D;1.0.2’<br>     args ‘-v &#x2F;tmp:&#x2F;tmp’<br> }<br> }</p>
<p>dockerfile also optionally accepts a registryUrl and registryCredentialsId parameters which will help to specify the Docker Registry to use and its credentials. For example:<br>dockerfile 还可以选择接受 registryUrl 和 registryCredentialsId 参数，这将有助于指定要使用的 Docker Registry 及其凭据。 例如：<br>agent {<br> dockerfile {<br>     filename ‘Dockerfile.build’<br>     dir ‘build’<br>     label ‘my-defined-label’<br>     registryUrl ‘<a target="_blank" rel="noopener" href="https://myregistry.com/&#39;">https://myregistry.com/&#39;</a><br>     registryCredentialsId ‘myPredefinedCredentialsInJenkins’<br> }<br> }</p>
</li>
<li><p>kubernetes Execute the Pipeline, or stage, inside a pod deployed on a Kubernetes cluster.<br>In order to use this option, the Jenkinsfile must be loaded from either a Multibranch Pipeline or a Pipeline from SCM.<br>The Pod template is defined inside the kubernetes { } block. For example, if you want a pod with a Kaniko container inside it,<br>you would define it as follows:<br>在 Kubernetes 集群上部署的 pod 内执行管道或阶段。 为了使用此选项，必须从多分支管道或来自 SCM 的管道加载 Jenkinsfile。<br>Pod 模板在 kubernetes { } 块内定义。 例如，如果你想要一个里面有 Kaniko 容器的 pod，你可以这样定义它：<br>agent {<br> kubernetes {<br>     label podlabel<br>     yaml “””<br> kind: Pod<br> metadata:<br>   name: jenkins-agent<br> spec:<br>   containers:</p>
<ul>
<li>name: kaniko<br>image: gcr.io&#x2F;kaniko-project&#x2F;executor:debug<br>imagePullPolicy: Always<br>command:<ul>
<li>&#x2F;busybox&#x2F;cat<br>tty: true<br>volumeMounts:<ul>
<li>name: aws-secret<br>mountPath: &#x2F;root&#x2F;.aws&#x2F;</li>
<li>name: docker-registry-config<br>mountPath: &#x2F;kaniko&#x2F;.docker<br> restartPolicy: Never<br> volumes:</li>
</ul>
</li>
<li>name: aws-secret<br>secret:<br>  secretName: aws-secret</li>
<li>name: docker-registry-config<br>configMap:<br>  name: docker-registry-config<br> “””<br>  }</li>
</ul>
</li>
</ul>
<p>You will need to create a secret aws-secret for Kaniko to be able to authenticate with ECR. This secret should contain the contents of ~&#x2F;.aws&#x2F;credentials. The other volume is a ConfigMap which should contain the endpoint of your ECR registry. For example:<br>您需要为 Kaniko 创建一个秘密 aws-secret 才能使用 ECR 进行身份验证。 此机密应包含 ~&#x2F;.aws&#x2F;credentials 的内容。 另一个卷是一个 ConfigMap，它应该包含您的 ECR 注册表的端点。 例如：<br>{<br>       “credHelpers”: {<br>         “<your-aws-account-id>.dkr.ecr.eu-central-1.amazonaws.com”: “ecr-login”<br>       }<br> }</p>
<p> Refer to the following example for reference: <a target="_blank" rel="noopener" href="https://github.com/jenkinsci/kubernetes-plugin/blob/master/examples/kaniko.groovy">https://github.com/jenkinsci/kubernetes-plugin/blob/master/examples/kaniko.groovy</a></p>
</li>
</ol>
<h2 id="agent-Common-Options"><a href="#agent-Common-Options" class="headerlink" title="agent Common Options"></a>agent Common Options</h2><ol>
<li><p>label  A string. The label or label condition on which to run the Pipeline or individual stage.</p>
<p>在使用 node、docker、dockerfile、的时候有使用 这个label选项,并且是 使用node时候这个label是必须的</p>
</li>
<li><p>customWorkspace A string. Run the Pipeline or individual stage this agent is applied to within this custom workspace, rather than the default. It can be either a relative path, in which case the custom workspace will be under the workspace root on the node, or an absolute path. For example:<br>一个字符串。 在此自定义工作区中运行此代理应用到的管道或单个阶段，而不是默认阶段。 它可以是相对路径，在这种情况下，自定义工作区将位于节点上的工作区根目录下，也可以是绝对路径。 例如：<br>agent {<br> node {<br>     label ‘my-defined-label’<br>     customWorkspace ‘&#x2F;some&#x2F;other&#x2F;path’<br> }<br> }<br> 在使用 node、docker、dockerfile、的时候有使用 这个customWorkspace选项,</p>
</li>
<li><p>reuseNode    A boolean, false by default. If true, run the container on the node specified at the top-level of the Pipeline, in the same workspace, rather than on a new node entirely.<br>布尔值，默认为 false。 如果为 true，则在同一工作区中的 Pipeline 顶层指定的节点上运行容器，而不是完全在新节点上运行。<br>此选项对 docker 和 dockerfile 有效，并且仅在用于单个阶段的代理时有效。 </p>
</li>
<li><p>args    A string. Runtime arguments to pass to docker run.<br>此选项对 docker 和 dockerfile 有效.</p>
</li>
</ol>
<h2 id="agent-Example"><a href="#agent-Example" class="headerlink" title="agent Example"></a>agent Example</h2><p>Example 1. Docker Agent, Declarative Pipeline</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent &#123; docker &#x27;maven:3.8.1-adoptopenjdk-11&#x27; &#125;</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;Example Build&#x27;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                sh &#x27;mvn -B clean verify&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在给定名称和标签的新创建容器中执行此管道中定义的所有步骤 , docker 镜像使用 ‘maven:3.8.1-adoptopenjdk-11’</p>
<p>Example 2. Stage-level Agent Section</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent none   //在 Pipeline 的顶层定义 agent none 可确保 不必要地分配 Executor。 使用 agent none 还会强制每个阶段 stage 部分必须要配置代理部分。 </span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;Example Build&#x27;) &#123;</span><br><span class="line">            agent &#123; docker &#x27;maven:3.8.1-adoptopenjdk-11&#x27; &#125;  //使用此镜像在新创建的容器中执行此阶段的步骤。 这个容器使用的 &#x27;maven:3.8.1-adoptopenjdk-11&#x27; 这个镜像</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &#x27;Hello, Maven&#x27;</span><br><span class="line">                sh &#x27;mvn --version&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stage(&#x27;Example Test&#x27;) &#123;</span><br><span class="line">            agent &#123; docker &#x27;openjdk:8-jre&#x27; &#125;  //使用与上一阶段不同的映像在新创建的容器中执行此阶段中的步骤。 这个容器使用的 &#x27;openjdk:8-jre&#x27; 这个镜像</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &#x27;Hello, JDK&#x27;</span><br><span class="line">                sh &#x27;java -version&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="post"><a href="#post" class="headerlink" title="post"></a>post</h2><p>post 部分定义了一个或多个在管道或阶段运行完成时运行的附加步骤（取决于管道中 post 部分的位置）。<br>post 可以支持以下任何后置条件块：always、changed、fixed、regression、aborted、failure、success、unstable、unsuccessful 和 cleanup。<br>这些条件块允许根据管道或阶段的完成状态在每个条件内执行步骤。 条件块按如下所示的顺序执行。 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Required     no是否必须有，不是</span><br><span class="line"></span><br><span class="line">Parameters   没有参数</span><br><span class="line"></span><br><span class="line">Allowed      可以在顶层 pipeline 代码块里用，也可以在 stage 代码块里面用</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol>
<li>always<br> Run the steps in the post section regardless of the completion status of the Pipeline’s or stage’s run.</li>
<li>changed<br> Only run the steps in post if the current Pipeline’s or stage’s run has a different completion status from its previous run.</li>
<li>fixed<br> Only run the steps in post if the current Pipeline’s or stage’s run is successful and the previous run failed or was unstable.</li>
<li>regression<br> Only run the steps in post if the current Pipeline’s or stage’s run’s status is failure, unstable, or aborted and the previous run was successful.</li>
<li>aborted<br> Only run the steps in post if the current Pipeline’s or stage’s run has an “aborted” status, usually due to the Pipeline being manually aborted. This is typically denoted by gray in the web UI.</li>
<li>failure<br> Only run the steps in post if the current Pipeline’s or stage’s run has a “failed” status, typically denoted by red in the web UI.</li>
<li>success<br> Only run the steps in post if the current Pipeline’s or stage’s run has a “success” status, typically denoted by blue or green in the web UI.</li>
<li>unstable<br> Only run the steps in post if the current Pipeline’s or stage’s run has an “unstable” status, usually caused by test failures, code violations, etc. This is typically denoted by yellow in the web UI.</li>
<li>unsuccessful<br> Only run the steps in post if the current Pipeline’s or stage’s run has not a “success” status. This is typically denoted in the web UI depending on the status previously mentioned.</li>
<li>cleanup<br>Run the steps in this post condition after every other post condition has been evaluated, regardless of the Pipeline or stage’s status.</li>
</ol>
<h2 id="stages"><a href="#stages" class="headerlink" title="stages"></a>stages</h2><p>Containing a sequence of one or more stage directives, the stages section is where the bulk of the “work” described by a Pipeline will be located.<br>At a minimum, it is recommended that stages contain at least one stage directive for each discrete part of the continuous delivery process, such as Build, Test, and Deploy.<br>阶段部分包含一系列一个或多个阶段指令，是流水线描述的大部分“工作”所在的位置。 对于持续交付过程的每个离散部分，建议阶段至少包含一个阶段指令，例如构建、测试和部署。<br>这个和 angent，post, environment 等都是并列的，在 pipeline 代码块内</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Required     Yes, 是否必须有，是</span><br><span class="line"></span><br><span class="line">Parameters   没有参数</span><br><span class="line"></span><br><span class="line">Allowed      Only once, inside the pipeline block.只能在顶层 pipeline 代码块里用</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line">    stages &#123; </span><br><span class="line">        stage(&#x27;Example&#x27;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &#x27;Hello World&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    post &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="stage"><a href="#stage" class="headerlink" title="stage"></a>stage</h2><p>The stage directive goes in the stages section and should contain a steps section, an optional agent section, or other stage-specific directives.<br>Practically speaking, all of the real work done by a Pipeline will be wrapped in one or more stage directives.<br>stage 指令位于 stage 部分，应该包含一个 steps 部分、一个可选的 agent 部分或其他特定于 stage 的指令。 实际上，流水线完成的所有实际工作都将包含在一个或多个阶段指令中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Required    At least one 至少有一个</span><br><span class="line"></span><br><span class="line">Parameters  一个强制参数，stage名称的字符串。 </span><br><span class="line"></span><br><span class="line">Allowed     Inside the stages section. 在 stages 代码块中</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;Example&#x27;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &#x27;Hello World&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;Example Build&#x27;) &#123;  //像这个 stage 在  stages 下面，可以出现多个的</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &#x27;Hello World&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stage(&#x27;Example Deploy&#x27;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &#x27;Deploying&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="steps"><a href="#steps" class="headerlink" title="steps"></a>steps</h2><p>The steps section defines a series of one or more steps to be executed in a given stage directive.<br>steps 部分定义了在给定阶段指令中要执行的 一个 或 多个 步骤。 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Required     Yes, 是否必须有，是</span><br><span class="line"></span><br><span class="line">Parameters   None 没有参数</span><br><span class="line"></span><br><span class="line">Allowed      Inside each stage block. 只能用在 stage 代码块中</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;Example&#x27;) &#123;</span><br><span class="line">            steps &#123; </span><br><span class="line">                echo &#x27;Hello World&#x27;   // 像这样的  可以在 steps 中出现多个的</span><br><span class="line">                sh &#x27;xxxxx&#x27;</span><br><span class="line">                junit &#x27;xxxx&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Sequential-Stages-连续阶段"><a href="#Sequential-Stages-连续阶段" class="headerlink" title="Sequential Stages 连续阶段"></a>Sequential Stages 连续阶段</h2><p>Stages in Declarative Pipeline may have a stages section containing a list of nested stages to be run in sequential order.<br>Note that a stage must have one and only one of steps, stages, parallel, or matrix. It is not possible to nest a parallel or<br>matrix block within a stage directive if that stage directive is nested within a parallel or matrix block itself. However,<br>a stage directive within a parallel or matrix block can use all other functionality of a stage, including agent, tools, when, etc.<br>声明式管道中的 有一个 stages 部分，其中包含要 按顺序运行的嵌套 stages列表。 请注意，一个stage 必须具有且只有一个steps、stages、parallel 或 matrix。 这里说白了就是 嵌套 stages 怎么书写</p>
<p>如果阶段指令嵌套在并行或矩阵块本身内，则不可能在阶段指令内嵌套并行或矩阵块。 但是，并行或矩阵块中的阶段指令可以使用阶段的所有其他功能，包括代理、工具、何时等。 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent none</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;Non-Sequential Stage&#x27;) &#123;</span><br><span class="line">            agent &#123;</span><br><span class="line">                label &#x27;for-non-sequential&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &quot;On Non-Sequential Stage&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        stage(&#x27;Sequential&#x27;) &#123; // 嵌套了</span><br><span class="line">            agent &#123;</span><br><span class="line">                label &#x27;for-sequential&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">            environment &#123;</span><br><span class="line">                FOR_SEQUENTIAL = &quot;some-value&quot;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            stages &#123;</span><br><span class="line">                stage(&#x27;In Sequential 1&#x27;) &#123;</span><br><span class="line">                    steps &#123;</span><br><span class="line">                        echo &quot;In Sequential 1&quot;</span><br><span class="line">                        echo &quot;In Sequential 1&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                stage(&#x27;In Sequential 2&#x27;) &#123;</span><br><span class="line">                    steps &#123;</span><br><span class="line">                        echo &quot;In Sequential 2&quot;</span><br><span class="line">                        echo &quot;In Sequential 2&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                stage(&#x27;Parallel In Sequential&#x27;) &#123;</span><br><span class="line">                    parallel &#123;</span><br><span class="line">                        stage(&#x27;In Parallel 1&#x27;) &#123;</span><br><span class="line">                            steps &#123;</span><br><span class="line">                                echo &quot;In Parallel 1&quot;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        stage(&#x27;In Parallel 2&#x27;) &#123;</span><br><span class="line">                            steps &#123;</span><br><span class="line">                                echo &quot;In Parallel 2&quot;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;// 嵌套在内容的一个 stages 然后里面又是一个一个的  stage、然后stage 里面又是一个 steps</span><br><span class="line">        &#125; //end stage(&#x27;Sequential&#x27;) &#123; // 嵌套了</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    &#125;// end stages</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Parallel-并行阶段"><a href="#Parallel-并行阶段" class="headerlink" title="Parallel 并行阶段"></a>Parallel 并行阶段</h2><p>Stages in Declarative Pipeline may have a parallel section containing a list of nested stages to be run in parallel.<br>Note that a stage must have one and only one of steps, stages, parallel, or matrix. It is not possible to nest a<br>parallel or matrix block within a stage directive if that stage directive is nested within a parallel or matrix block itself.<br>However, a stage directive within a parallel or matrix block can use all other functionality of a stage, including agent, tools, when, etc.<br>In addition, you can force your parallel stages to all be aborted when any one of them fails, by adding failFast true to the<br>stage containing the parallel. Another option for adding failfast is adding an option to the pipeline definition: parallelsAlwaysFailFast()<br>声明式管道中的阶段可能有一个并行部分，其中包含要并行运行的嵌套阶段列表。 请注意，一个stage必须具有且只有一个steps、stages、parallel或matrix。<br>如果阶段指令嵌套在并行或矩阵块本身内，则不可能在阶段指令内嵌套并行或矩阵块。 但是，并行或矩阵块中的阶段指令可以使用阶段的所有其他功能，包括代理、工具、何时等。<br>此外，您可以通过将 failFast true 添加到包含并行的阶段来强制您的并行阶段在其中任何一个失败时中止。<br>添加 failfast 的另一个选项是在管道定义中添加一个选项：parallelsAlwaysFailFast() </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;Non-Parallel Stage&#x27;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &#x27;This stage will be executed first.&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;//end stage(&#x27;Non-Parallel Stage&#x27;) </span><br><span class="line">        </span><br><span class="line">        stage(&#x27;Parallel Stage&#x27;) &#123;</span><br><span class="line">            when &#123;</span><br><span class="line">                branch &#x27;master&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            failFast true</span><br><span class="line">            </span><br><span class="line">            parallel &#123; // 这里是并行， 这个 Sequential Stages 连续阶段 中那个例子里面的 和 stages 并列的</span><br><span class="line">                stage(&#x27;Branch A&#x27;) &#123;</span><br><span class="line">                    agent &#123;</span><br><span class="line">                        label &quot;for-branch-a&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                    steps &#123;</span><br><span class="line">                        echo &quot;On Branch A&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                stage(&#x27;Branch B&#x27;) &#123;</span><br><span class="line">                    agent &#123;</span><br><span class="line">                        label &quot;for-branch-b&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                    steps &#123;</span><br><span class="line">                        echo &quot;On Branch B&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                stage(&#x27;Branch C&#x27;) &#123;</span><br><span class="line">                    agent &#123;</span><br><span class="line">                        label &quot;for-branch-c&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                    stages &#123;</span><br><span class="line">                        stage(&#x27;Nested 1&#x27;) &#123;</span><br><span class="line">                            steps &#123;</span><br><span class="line">                                echo &quot;In stage Nested 1 within Branch C&quot;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        stage(&#x27;Nested 2&#x27;) &#123;</span><br><span class="line">                            steps &#123;</span><br><span class="line">                                echo &quot;In stage Nested 2 within Branch C&quot;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;//end stage(&#x27;Branch C&#x27;)</span><br><span class="line">                </span><br><span class="line">            &#125;//end parallel</span><br><span class="line">        &#125;//end stage(&#x27;Parallel Stage&#x27;)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    &#125;//end stages 最外层的那个 stages</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line">    options &#123;</span><br><span class="line">        parallelsAlwaysFailFast()</span><br><span class="line">    &#125;</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;Non-Parallel Stage&#x27;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &#x27;This stage will be executed first.&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        stage(&#x27;Parallel Stage&#x27;) &#123;</span><br><span class="line">            when &#123;</span><br><span class="line">                branch &#x27;master&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">            parallel &#123;</span><br><span class="line">                stage(&#x27;Branch A&#x27;) &#123;</span><br><span class="line">                    agent &#123;</span><br><span class="line">                        label &quot;for-branch-a&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                    steps &#123;</span><br><span class="line">                        echo &quot;On Branch A&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                stage(&#x27;Branch B&#x27;) &#123;</span><br><span class="line">                    agent &#123;</span><br><span class="line">                        label &quot;for-branch-b&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                    steps &#123;</span><br><span class="line">                        echo &quot;On Branch B&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                stage(&#x27;Branch C&#x27;) &#123;</span><br><span class="line">                    agent &#123;</span><br><span class="line">                        label &quot;for-branch-c&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                    stages &#123;</span><br><span class="line">                        stage(&#x27;Nested 1&#x27;) &#123;</span><br><span class="line">                            steps &#123;</span><br><span class="line">                                echo &quot;In stage Nested 1 within Branch C&quot;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        stage(&#x27;Nested 2&#x27;) &#123;</span><br><span class="line">                            steps &#123;</span><br><span class="line">                                echo &quot;In stage Nested 2 within Branch C&quot;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;//end stage(&#x27;Branch C&#x27;)</span><br><span class="line">            &#125;//end parallel</span><br><span class="line">        &#125;//end stage(&#x27;Parallel Stage&#x27;)</span><br><span class="line">        </span><br><span class="line">    &#125;//end stages 最外层的那个 stages</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="Matrix-矩阵"><a href="#Matrix-矩阵" class="headerlink" title="Matrix 矩阵"></a>Matrix 矩阵</h2><p>Stages in Declarative Pipeline may have a matrix section defining a multi-dimensional matrix of name-value combinations to be run in parallel.<br>We’ll refer these combinations as “cells” in a matrix.<br>Each cell in a matrix can include one or more stages to be run sequentially using the configuration for that cell.<br>Note that a stage must have one and only one of steps, stages, parallel, or matrix.<br>It is not possible to nest a parallel or matrix block within a stage directive if that stage directive is nested within a parallel or matrix block itself. </p>
<p>However, a stage directive within a parallel or matrix block can use all other functionality of a stage, including agent, tools, when, etc.<br>In addition, you can force your matrix cells to all be aborted when any one of them fails, by adding failFast true to the stage containing the matrix.<br>Another option for adding failfast is adding an option to the pipeline definition: parallelsAlwaysFailFast()<br>The matrix section must include an axes section and a stages section.<br>The axes section defines the values for each axis in the matrix.<br>The stages section defines a list of stages to run sequentially in each cell.<br>A matrix may have an excludes section to remove invalid cells from the matrix.<br>Many of the directives available on stage, including agent, tools, when, etc., can also be added to matrix to control the behavior of each cell.</p>
<p>声明式管道中的阶段可以有一个 矩阵matrix 部分，定义了要并行运行的 名称-值 组合的多维矩阵。我们将这些组合称为矩阵中的 单元cell 。<br>矩阵中的每个 单元 可以包括 一个或多个 阶段stages，以使用该单元的配置顺序运行。请注意，一个 阶段stage 必须具有且只有一个 步骤steps、阶段stages、并行parallel 或 矩阵matrix。<br>如果阶段指令嵌套在并行或矩阵块本身内，则不能在阶段指令内嵌套并行或矩阵块。</p>
<p>但是，matrix 或 parallel 块中的 阶段指令可以使用阶段的所有其他功能，包括agent、tools、when等。<br>此外，您可以通过将 failFast true 添加到包含矩阵的阶段来强制矩阵单元在其中任何一个失败时中止。<br>添加 failfast 的另一个选项是在管道定义中添加一个option：parallelsAlwaysFailFast()<br>矩阵部分必须包括 axes 部分和 stages 部分。axes 部分定义矩阵中每个轴的值。stages 部分定义了在每个单元中按顺序运行的阶段列表。<br>矩阵可以有一个 excludes 部分以从矩阵中删除无效单元。stage上可用的许多指令，包括agent、tools、when等，也可以添加到矩阵中以控制每个单元格的行为.</p>
<ol>
<li>axes 矩阵坐标<br>轴部分指定一个或多个轴指令。 每个轴都包含一个名称和一个值列表。 每个轴的所有值都与其他值组合以生成单元格。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">matrix &#123;</span><br><span class="line">    axes &#123;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;PLATFORM&#x27;</span><br><span class="line">            values &#x27;linux&#x27;, &#x27;mac&#x27;, &#x27;windows&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // ... 1x3 矩阵组合</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">matrix &#123;</span><br><span class="line">    axes &#123;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;PLATFORM&#x27;</span><br><span class="line">            values &#x27;linux&#x27;, &#x27;mac&#x27;, &#x27;windows&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;BROWSER&#x27;</span><br><span class="line">            values &#x27;chrome&#x27;, &#x27;edge&#x27;, &#x27;firefox&#x27;, &#x27;safari&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // ... 3x4 矩阵组合</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">matrix &#123;</span><br><span class="line">    axes &#123;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;PLATFORM&#x27;</span><br><span class="line">            values &#x27;linux&#x27;, &#x27;mac&#x27;, &#x27;windows&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;BROWSER&#x27;</span><br><span class="line">            values &#x27;chrome&#x27;, &#x27;edge&#x27;, &#x27;firefox&#x27;, &#x27;safari&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;ARCHITECTURE&#x27;</span><br><span class="line">            values &#x27;32-bit&#x27;, &#x27;64-bit&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // ... 3x4 矩阵组合</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li><p>stages 矩阵中使用的stages<br>stages 部分指定在每个单元中顺序执行的一个或多个阶段。 axes定义坐标组合，stages定义执行阶段</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">matrix &#123;</span><br><span class="line">    axes &#123;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;PLATFORM&#x27;</span><br><span class="line">            values &#x27;linux&#x27;, &#x27;mac&#x27;, &#x27;windows&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;build&#x27;) &#123;</span><br><span class="line">            // ...</span><br><span class="line">        &#125;</span><br><span class="line">        stage(&#x27;test&#x27;) &#123;</span><br><span class="line">            // ...</span><br><span class="line">        &#125;</span><br><span class="line">        stage(&#x27;deploy&#x27;) &#123;</span><br><span class="line">            // ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">matrix &#123;</span><br><span class="line">    axes &#123;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;PLATFORM&#x27;</span><br><span class="line">            values &#x27;linux&#x27;, &#x27;mac&#x27;, &#x27;windows&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;BROWSER&#x27;</span><br><span class="line">            values &#x27;chrome&#x27;, &#x27;edge&#x27;, &#x27;firefox&#x27;, &#x27;safari&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;build-and-test&#x27;) &#123;</span><br><span class="line">            // ...</span><br><span class="line">        &#125;</span><br><span class="line">        stage(&#x27;deploy-and-test&#x27;) &#123;</span><br><span class="line">            // ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>excludes (optional) 排除某些坐标组合，坐标组合很多，可以排除不合理的<br>The optional excludes section lets authors specify one or more exclude filter expressions that select cells to be excluded from the<br>expanded set of matrix cells (aka, sparsening). Filters are constructed using a basic directive structure of one or more of exclude<br>axis directives each with a name and values list.<br>The axis directives inside an exclude generate a set of combinations (similar to generating the matrix cells). The matrix cells that match<br>all the values from an exclude combination are removed from the matrix. If more than one exclude directive is supplied,<br>each is evaluated separately to remove cells.<br>When dealing with a long list of values to exclude, exclude axis directives can use notValues instead of values.<br>These will exclude cells that do not match one of the values passed to notValues.<br>可选的 excludes 部分允许作者指定一个或多个排除过滤表达式，这些表达式选择要从 矩阵组合（又名稀疏）中排除 单元格。<br>过滤器是使用一个或多个 排除轴指令 结构构建的，每个排除轴指令都有一个名称和值列表。<br>exclude 中的轴指令生成一组组合（类似于生成矩阵单元）。 从矩阵中删除与排除组合中的所有值匹配的矩阵单元。 如果提供了多个排除指令，则分别评估每个指令以删除单元格。<br>在处理要排除的一长串值时，排除轴指令可以使用 notValues 代替值。 这些将排除与传递给 notValues 的值之一不匹配的单元格。</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">matrix &#123;</span><br><span class="line">    axes &#123;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;PLATFORM&#x27;</span><br><span class="line">            values &#x27;linux&#x27;, &#x27;mac&#x27;, &#x27;windows&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;BROWSER&#x27;</span><br><span class="line">            values &#x27;chrome&#x27;, &#x27;edge&#x27;, &#x27;firefox&#x27;, &#x27;safari&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;ARCHITECTURE&#x27;</span><br><span class="line">            values &#x27;32-bit&#x27;, &#x27;64-bit&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; //矩阵组合一共有 3x4x2 = 24 组 </span><br><span class="line">    excludes &#123;</span><br><span class="line">        exclude &#123;</span><br><span class="line">            axis &#123;</span><br><span class="line">                name &#x27;PLATFORM&#x27;</span><br><span class="line">                values &#x27;mac&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">            axis &#123;</span><br><span class="line">                name &#x27;ARCHITECTURE&#x27;</span><br><span class="line">                values &#x27;32-bit&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // ...排除 了 1x1x4 = 4 组  mac-32-bit 这个,BROWSER不关心，都会排除掉, mac_&#123;chrome,edge,firefox,safari&#125;_32-bit 这4个都会排除掉的</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">matrix &#123;</span><br><span class="line">    axes &#123;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;PLATFORM&#x27;</span><br><span class="line">            values &#x27;linux&#x27;, &#x27;mac&#x27;, &#x27;windows&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;BROWSER&#x27;</span><br><span class="line">            values &#x27;chrome&#x27;, &#x27;edge&#x27;, &#x27;firefox&#x27;, &#x27;safari&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;ARCHITECTURE&#x27;</span><br><span class="line">            values &#x27;32-bit&#x27;, &#x27;64-bit&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; //矩阵组合一共有 3x4x2 = 24 组 </span><br><span class="line">    excludes &#123;</span><br><span class="line">        exclude &#123;</span><br><span class="line">            // 4 cells</span><br><span class="line">            axis &#123;</span><br><span class="line">                name &#x27;PLATFORM&#x27;</span><br><span class="line">                values &#x27;mac&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">            axis &#123;</span><br><span class="line">                name &#x27;ARCHITECTURE&#x27;</span><br><span class="line">                values &#x27;32-bit&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; // 这个是 能匹配上  mac_&#123;chrome,edge,firefox,safari&#125;_32-bit 这4个</span><br><span class="line">        exclude &#123;</span><br><span class="line">            // 2 cells</span><br><span class="line">            axis &#123;</span><br><span class="line">                name &#x27;PLATFORM&#x27;</span><br><span class="line">                values &#x27;linux&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">            axis &#123;</span><br><span class="line">                name &#x27;BROWSER&#x27;</span><br><span class="line">                values &#x27;safari&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; // 这个是 能匹配上  linux_safari_&#123;32-bit, 64-bit&#125; 这2个</span><br><span class="line">        exclude &#123;</span><br><span class="line">            // 3 more cells and &#x27;32-bit, mac&#x27; (already excluded)</span><br><span class="line">            axis &#123;</span><br><span class="line">                name &#x27;PLATFORM&#x27;</span><br><span class="line">                notValues &#x27;windows&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">            axis &#123;</span><br><span class="line">                name &#x27;BROWSER&#x27;</span><br><span class="line">                values &#x27;edge&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; // windows_edge_&#123;32-bit, 64-bit&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>Matrix cell-level directives (optional)</li>
</ol>
<p>Matrix 允许用户通过在矩阵本身下添加阶段级指令来有效地配置每个单元的整体环境。 这些指令的行为与它们在舞台上的行为相同，但它们也可以接受矩阵为每个单元格提供的值。</p>
<p>轴和排除指令定义构成矩阵的静态单元格集。 这组组合是在管道运行开始之前生成的。 另一方面，“per-cell”指令在运行时进行评估。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    parameters &#123;</span><br><span class="line">        choice(name: &#x27;PLATFORM_FILTER&#x27;, choices: [&#x27;all&#x27;, &#x27;linux&#x27;, &#x27;windows&#x27;, &#x27;mac&#x27;], description: &#x27;Run on specific platform&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line">    agent none</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;BuildAndTest&#x27;) &#123;</span><br><span class="line">            matrix &#123;</span><br><span class="line">                agent &#123;</span><br><span class="line">                    label &quot;$&#123;PLATFORM&#125;-agent&quot;</span><br><span class="line">                &#125;</span><br><span class="line">                when &#123; anyOf &#123;</span><br><span class="line">                    expression &#123; params.PLATFORM_FILTER == &#x27;all&#x27; &#125;</span><br><span class="line">                    expression &#123; params.PLATFORM_FILTER == env.PLATFORM &#125;</span><br><span class="line">                &#125; &#125;</span><br><span class="line">                axes &#123;</span><br><span class="line">                    axis &#123;</span><br><span class="line">                        name &#x27;PLATFORM&#x27;</span><br><span class="line">                        values &#x27;linux&#x27;, &#x27;windows&#x27;, &#x27;mac&#x27;</span><br><span class="line">                    &#125;</span><br><span class="line">                    axis &#123;</span><br><span class="line">                        name &#x27;BROWSER&#x27;</span><br><span class="line">                        values &#x27;firefox&#x27;, &#x27;chrome&#x27;, &#x27;safari&#x27;, &#x27;edge&#x27;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                excludes &#123;</span><br><span class="line">                    exclude &#123;</span><br><span class="line">                        axis &#123;</span><br><span class="line">                            name &#x27;PLATFORM&#x27;</span><br><span class="line">                            values &#x27;linux&#x27;</span><br><span class="line">                        &#125;</span><br><span class="line">                        axis &#123;</span><br><span class="line">                            name &#x27;BROWSER&#x27;</span><br><span class="line">                            values &#x27;safari&#x27;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    exclude &#123;</span><br><span class="line">                        axis &#123;</span><br><span class="line">                            name &#x27;PLATFORM&#x27;</span><br><span class="line">                            notValues &#x27;windows&#x27;</span><br><span class="line">                        &#125;</span><br><span class="line">                        axis &#123;</span><br><span class="line">                            name &#x27;BROWSER&#x27;</span><br><span class="line">                            values &#x27;edge&#x27;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                stages &#123;</span><br><span class="line">                    stage(&#x27;Build&#x27;) &#123;</span><br><span class="line">                        steps &#123;</span><br><span class="line">                            echo &quot;Do Build for $&#123;PLATFORM&#125; - $&#123;BROWSER&#125;&quot;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    stage(&#x27;Test&#x27;) &#123;</span><br><span class="line">                        steps &#123;</span><br><span class="line">                            echo &quot;Do Test for $&#123;PLATFORM&#125; - $&#123;BROWSER&#125;&quot;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="script"><a href="#script" class="headerlink" title="script"></a>script</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;Example&#x27;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &#x27;Hello World&#x27;</span><br><span class="line"></span><br><span class="line">                script &#123;</span><br><span class="line">                    def browsers = [&#x27;chrome&#x27;, &#x27;firefox&#x27;]</span><br><span class="line">                    for (int i = 0; i &lt; browsers.size(); ++i) &#123;</span><br><span class="line">                        echo &quot;Testing the $&#123;browsers[i]&#125; browser&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://magesfc.github.io">mage</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://magesfc.github.io/mage/abb5b3c7b70b496b314410760585d1678b857995/">https://magesfc.github.io/mage/abb5b3c7b70b496b314410760585d1678b857995/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://magesfc.github.io" target="_blank">马哥私房菜</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/jenkins/">jenkins</a></div><div class="post_share"><div class="social-share" data-image="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="/null" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="/null" alt="支付寶"/></a><div class="post-qr-code-desc">支付寶</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/mage/35daa433f1d2df61d4d92c19d510e19a6bafcf4f/"><img class="prev-cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Spring学习笔记总结</div></div></a></div><div class="next-post pull-right"><a href="/mage/454c769256a3f93a38c0d61a42811b8915d65c0d/"><img class="next-cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Kubernetes学习笔记总结之k8s集群安装部署</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/mage/253e7a0d87524ac8029f65b14264563e1a3b8207/" title="Jenkins学习之使用curl命令触发任务"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">Jenkins学习之使用curl命令触发任务</div></div></a></div><div><a href="/mage/02368d77bf5b9d8e5b43072b3e068f809d04c4ae/" title="jenkins学习之Jenkins外部任务项目"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">jenkins学习之Jenkins外部任务项目</div></div></a></div><div><a href="/mage/298144bf31bdad623369d39b38ebddb64dde1abd/" title="jenkins学习之Jenkins开发调试于jenkins插件开发调试"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">jenkins学习之Jenkins开发调试于jenkins插件开发调试</div></div></a></div><div><a href="/mage/5112822067c3457acc097c5d54b9585772b0a71d/" title="jenkins学习之Jenkins流水线parallel并发执行"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">jenkins学习之Jenkins流水线parallel并发执行</div></div></a></div><div><a href="/mage/0eb743cba8f68c55a93fb8c3f5ee18603bfb829e/" title="jenkins学习之Jenkins流水线when条件判断执行"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">jenkins学习之Jenkins流水线when条件判断执行</div></div></a></div><div><a href="/mage/86414c0faeee7450c569648f1849eb4867f8bccb/" title="jenkins学习之Jenkins流水线中load其他groovy文件"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">jenkins学习之Jenkins流水线中load其他groovy文件</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">mage</div><div class="author-info__description"> 这里是 马哥 的个人博客 </div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">154</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">171</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">34</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/mamh2021"><i class="fab fa-github"></i><span>GitHub</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/mamh2021" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Declarative-Pipeline"><span class="toc-number">1.</span> <span class="toc-text">Declarative Pipeline</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#agent"><span class="toc-number">1.1.</span> <span class="toc-text">agent</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#agent-%E5%8F%82%E6%95%B0"><span class="toc-number">1.2.</span> <span class="toc-text">agent 参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#agent-Common-Options"><span class="toc-number">1.3.</span> <span class="toc-text">agent Common Options</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#agent-Example"><span class="toc-number">1.4.</span> <span class="toc-text">agent Example</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#post"><span class="toc-number">1.5.</span> <span class="toc-text">post</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#stages"><span class="toc-number">1.6.</span> <span class="toc-text">stages</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#stage"><span class="toc-number">1.7.</span> <span class="toc-text">stage</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#steps"><span class="toc-number">1.8.</span> <span class="toc-text">steps</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sequential-Stages-%E8%BF%9E%E7%BB%AD%E9%98%B6%E6%AE%B5"><span class="toc-number">1.9.</span> <span class="toc-text">Sequential Stages 连续阶段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Parallel-%E5%B9%B6%E8%A1%8C%E9%98%B6%E6%AE%B5"><span class="toc-number">1.10.</span> <span class="toc-text">Parallel 并行阶段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Matrix-%E7%9F%A9%E9%98%B5"><span class="toc-number">1.11.</span> <span class="toc-text">Matrix 矩阵</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#script"><span class="toc-number">1.12.</span> <span class="toc-text">script</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/mage/eb822dde30a05b68de146f64ccf79add56764b2e/" title="jenkins学习之plugin安装"><img src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="jenkins学习之plugin安装"/></a><div class="content"><a class="title" href="/mage/eb822dde30a05b68de146f64ccf79add56764b2e/" title="jenkins学习之plugin安装">jenkins学习之plugin安装</a><time datetime="2022-11-01T03:21:55.000Z" title="发表于 2022-11-01 11:21:55">2022-11-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/a5f602c98d515279f19b5deea0155101f733d9f7/" title="jenkins学习之master服务器安装"><img src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="jenkins学习之master服务器安装"/></a><div class="content"><a class="title" href="/mage/a5f602c98d515279f19b5deea0155101f733d9f7/" title="jenkins学习之master服务器安装">jenkins学习之master服务器安装</a><time datetime="2022-11-01T03:08:20.000Z" title="发表于 2022-11-01 11:08:20">2022-11-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/7b14abc60e1d18cc8811745a97f263978e87e4ae/" title="Hexo个人博客搭建教程"><img src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hexo个人博客搭建教程"/></a><div class="content"><a class="title" href="/mage/7b14abc60e1d18cc8811745a97f263978e87e4ae/" title="Hexo个人博客搭建教程">Hexo个人博客搭建教程</a><time datetime="2022-10-28T13:37:31.000Z" title="发表于 2022-10-28 21:37:31">2022-10-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/9797fe175c0183a6563e7397692d780ecf683a6f/" title="Ansible自动化运维工具之ansible-resources"><img src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Ansible自动化运维工具之ansible-resources"/></a><div class="content"><a class="title" href="/mage/9797fe175c0183a6563e7397692d780ecf683a6f/" title="Ansible自动化运维工具之ansible-resources">Ansible自动化运维工具之ansible-resources</a><time datetime="2022-10-16T09:27:39.000Z" title="发表于 2022-10-16 17:27:39">2022-10-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/a0bfcc2b49b5167196ecf1ed7f20f9eb180d9a43/" title="Ansible自动化运维工具之synchronize模块学习"><img src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Ansible自动化运维工具之synchronize模块学习"/></a><div class="content"><a class="title" href="/mage/a0bfcc2b49b5167196ecf1ed7f20f9eb180d9a43/" title="Ansible自动化运维工具之synchronize模块学习">Ansible自动化运维工具之synchronize模块学习</a><time datetime="2022-10-13T03:27:35.000Z" title="发表于 2022-10-13 11:27:35">2022-10-13</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2022 By mage</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>