<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>jenkinså­¦ä¹ ä¹‹Jenkinsæµæ°´çº¿è¯­æ³• | é©¬å“¥ç§æˆ¿èœ</title><meta name="author" content="mage"><meta name="copyright" content="mage"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="https:&#x2F;&#x2F;www.jenkins.io&#x2F;doc&#x2F;book&#x2F;pipeline&#x2F;syntax&#x2F; Declarative Pipelineæ‰€æœ‰æœ‰æ•ˆçš„å£°æ˜æ€§ç®¡é“éƒ½å¿…é¡»åŒ…å«åœ¨ç®¡é“å—ä¸­ï¼Œä¾‹å¦‚ï¼š 123pipeline &amp;#123;    &#x2F;* insert Declarative Pipeline here *&#x2F;&amp;#125;   agentä»£ç† agent éƒ¨åˆ†æŒ‡å®šæ•´ä¸ªpipelineæˆ–ç‰¹å®šé˜¶æ®µ sta">
<meta property="og:type" content="article">
<meta property="og:title" content="jenkinså­¦ä¹ ä¹‹Jenkinsæµæ°´çº¿è¯­æ³•">
<meta property="og:url" content="https://magesfc.github.io/mage/abb5b3c7b70b496b314410760585d1678b857995/">
<meta property="og:site_name" content="é©¬å“¥ç§æˆ¿èœ">
<meta property="og:description" content="https:&#x2F;&#x2F;www.jenkins.io&#x2F;doc&#x2F;book&#x2F;pipeline&#x2F;syntax&#x2F; Declarative Pipelineæ‰€æœ‰æœ‰æ•ˆçš„å£°æ˜æ€§ç®¡é“éƒ½å¿…é¡»åŒ…å«åœ¨ç®¡é“å—ä¸­ï¼Œä¾‹å¦‚ï¼š 123pipeline &amp;#123;    &#x2F;* insert Declarative Pipeline here *&#x2F;&amp;#125;   agentä»£ç† agent éƒ¨åˆ†æŒ‡å®šæ•´ä¸ªpipelineæˆ–ç‰¹å®šé˜¶æ®µ sta">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg">
<meta property="article:published_time" content="2022-02-23T09:47:21.000Z">
<meta property="article:modified_time" content="2022-02-23T09:47:21.000Z">
<meta property="article:author" content="mage">
<meta property="article:tag" content="jenkins">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg"><link rel="shortcut icon" href="http://www.blackshark.com/favicon.ico"><link rel="canonical" href="https://magesfc.github.io/mage/abb5b3c7b70b496b314410760585d1678b857995/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":150,"languages":{"author":"ä½œè€…: mage","link":"é“¾æ¥: ","source":"æ¥æº: é©¬å“¥ç§æˆ¿èœ","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'jenkinså­¦ä¹ ä¹‹Jenkinsæµæ°´çº¿è¯­æ³•',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-02-23 17:47:21'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><style type="text/css">.card-announcement .social-button{margin:.6rem 0 0 0;text-align:center}.card-announcement .social-button a{display:block;background-color:var(--btn-bg);color:var(--btn-color);text-align:center;line-height:2.4;margin:4px 0}.card-announcement .social-button a:hover{background-color:var(--btn-hover-color)}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">154</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">171</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">34</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> ç›®å½•</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> ç²¾é€‰æ–‡æ¡£</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/21cfbf15/"><span> ğŸš€ å¿«é€Ÿå¼€å§‹</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/dc584b87/"><span> ğŸ“‘ ä¸»é¢˜é¡µé¢</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4aa8abbe/"><span> ğŸ›  ä¸»é¢˜é…ç½®-1</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/ceeb73f/"><span> ğŸ›  ä¸»é¢˜é…ç½®-2</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/98d20436/"><span> â“ ä¸»é¢˜é—®ç­”</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4073eda/"><span> âš¡ï¸ è¿›é˜¶æ•™ç¨‹</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/198a4240/"><span> âœ¨ æ›´æ–°æ—¥å¿—</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://butterfly.js.org/link/"><i class="fa-fw fas fa-thumbs-up"></i><span> å…¶ä»–ç¤ºä¾‹</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">é©¬å“¥ç§æˆ¿èœ</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> ç›®å½•</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> ç²¾é€‰æ–‡æ¡£</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/21cfbf15/"><span> ğŸš€ å¿«é€Ÿå¼€å§‹</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/dc584b87/"><span> ğŸ“‘ ä¸»é¢˜é¡µé¢</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4aa8abbe/"><span> ğŸ›  ä¸»é¢˜é…ç½®-1</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/ceeb73f/"><span> ğŸ›  ä¸»é¢˜é…ç½®-2</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/98d20436/"><span> â“ ä¸»é¢˜é—®ç­”</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4073eda/"><span> âš¡ï¸ è¿›é˜¶æ•™ç¨‹</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/198a4240/"><span> âœ¨ æ›´æ–°æ—¥å¿—</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://butterfly.js.org/link/"><i class="fa-fw fas fa-thumbs-up"></i><span> å…¶ä»–ç¤ºä¾‹</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">jenkinså­¦ä¹ ä¹‹Jenkinsæµæ°´çº¿è¯­æ³•</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2022-02-23T09:47:21.000Z" title="å‘è¡¨äº 2022-02-23 17:47:21">2022-02-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-02-23T09:47:21.000Z" title="æ›´æ–°äº 2022-02-23 17:47:21">2022-02-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/jenkins/">jenkins</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="jenkinså­¦ä¹ ä¹‹Jenkinsæµæ°´çº¿è¯­æ³•"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><a target="_blank" rel="noopener" href="https://www.jenkins.io/doc/book/pipeline/syntax/">https://www.jenkins.io/doc/book/pipeline/syntax/</a></p>
<h1 id="Declarative-Pipeline"><a href="#Declarative-Pipeline" class="headerlink" title="Declarative Pipeline"></a>Declarative Pipeline</h1><p>æ‰€æœ‰æœ‰æ•ˆçš„å£°æ˜æ€§ç®¡é“éƒ½å¿…é¡»åŒ…å«åœ¨ç®¡é“å—ä¸­ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    /* insert Declarative Pipeline here */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="agent"><a href="#agent" class="headerlink" title="agent"></a>agent</h2><p>ä»£ç† agent éƒ¨åˆ†æŒ‡å®šæ•´ä¸ªpipelineæˆ–ç‰¹å®šé˜¶æ®µ stage å°†åœ¨ Jenkins ç¯å¢ƒä¸­æ‰§è¡Œçš„ä½ç½®ï¼Œå…·ä½“å–å†³äºä»£ç†éƒ¨åˆ†çš„æ”¾ç½®ä½ç½®ã€‚<br>è¯¥éƒ¨åˆ†å¿…é¡»åœ¨pipelineå—å†…çš„é¡¶å±‚å®šä¹‰ï¼Œä½†é˜¶æ®µçº§åˆ«çš„ stage ä½¿ç”¨ä¹Ÿæ˜¯å¯ä»¥çš„çš„ã€‚ </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Required     Yes æ˜¯å¦å¿…é¡»æœ‰,</span><br><span class="line"></span><br><span class="line">Parameters   æœ‰å‚æ•°ï¼Œè¯¦ç»†è¯´æ˜å¾€ä¸‹çœ‹</span><br><span class="line"></span><br><span class="line">Allowed      å¯ä»¥åœ¨é¡¶å±‚ pipeline ä»£ç å—é‡Œç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨ stage ä»£ç å—é‡Œé¢ç”¨</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Top Level Agents</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">In agents declared at the outermost level of the Pipeline, the options are invoked after entering the agent. As an example, when using timeout it will be only applied to the execution within the agent.</span><br><span class="line">åœ¨ Pipeline æœ€å¤–å±‚å£°æ˜çš„ä»£ç†ä¸­ï¼Œé€‰é¡¹åœ¨è¿›å…¥ä»£ç†åè¢«è°ƒç”¨ã€‚ ä¾‹å¦‚ï¼Œå½“ä½¿ç”¨è¶…æ—¶æ—¶ï¼Œå®ƒå°†ä»…åº”ç”¨äºä»£ç†å†…çš„æ‰§è¡Œã€‚è¿™ä¸ªæ—¶å€™ agent ä»£ç†å·²ç»åˆ†é…å¥½äº†ï¼Œåˆ†é…agentå°±ä¸ä¼šç®—æ—¶é—´äº†</span><br><span class="line"></span><br><span class="line">node(&quot;myAgent&quot;) &#123;</span><br><span class="line">    timeout(unit: &#x27;SECONDS&#x27;, time: 5) &#123;</span><br><span class="line">        stage(&quot;One&quot;)&#123;</span><br><span class="line">            sleep 10</span><br><span class="line">            echo &#x27;hello&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>Stage Agents</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">In agents declared within a stage, the options are invoked before entering the agent and before checking any when conditions. In this case, when using timeout, it is applied before the agent is allocated.</span><br><span class="line">åœ¨é˜¶æ®µå†…å£°æ˜çš„ä»£ç†ä¸­ï¼Œåœ¨è¿›å…¥ä»£ç†ä¹‹å‰å’Œæ£€æŸ¥ä»»ä½• when æ¡ä»¶ä¹‹å‰è°ƒç”¨é€‰é¡¹ã€‚ä¾‹å¦‚ï¼Œ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“ä½¿ç”¨è¶…æ—¶æ—¶ï¼Œå®ƒä¼šåœ¨åˆ†é…ä»£ç†ä¹‹å‰åº”ç”¨ã€‚ </span><br><span class="line">æ­¤è¶…æ—¶å°†åŒ…æ‹¬ä»£ç†é…ç½®æ—¶é—´ã€‚ ç”±äºè¶…æ—¶åŒ…æ‹¬ä»£ç†ä¾›åº”æ—¶é—´ï¼Œå› æ­¤åœ¨ä»£ç†åˆ†é…å»¶è¿Ÿçš„æƒ…å†µä¸‹ï¼Œç®¡é“å¯èƒ½ä¼šå¤±è´¥ã€‚ è¿™ç§æƒ…å†µï¼Œå¦‚æœä½ çš„èŠ‚ç‚¹æ˜¯ ç”¨å®Œé”€æ¯ï¼Œç”¨å®Œä¸‹çº¿çš„è¯ï¼Œè¿™æ¬¡åˆ†é…æ–°çš„èŠ‚ç‚¹ï¼Œæˆ–è€…é‡æ–°è¿ä¸ŠèŠ‚ç‚¹ï¼Œè¿™ä¸€æ®µçš„æ—¶é—´éƒ½ä¼šç®—åœ¨è¶…æ—¶é‡Œé¢</span><br><span class="line"></span><br><span class="line">timeout(unit: &#x27;SECONDS&#x27;, time: 5) &#123;</span><br><span class="line">    stage(&quot;One&quot;)&#123;</span><br><span class="line">        node &#123;</span><br><span class="line">            sleep 10</span><br><span class="line">            echo &#x27;Hello&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="agent-å‚æ•°"><a href="#agent-å‚æ•°" class="headerlink" title="agent å‚æ•°"></a>agent å‚æ•°</h2><ol>
<li><p>any  Execute the Pipeline, or stage, on any available agent.<br>For example:<br> agent any</p>
</li>
<li><p>none When applied at the top-level of the pipeline block no global agent will be allocated for the entire Pipeline run and each stage section will need to contain its own agent section.<br>none å½“åº”ç”¨äºç®¡é“å—çš„é¡¶å±‚æ—¶ï¼Œä¸ä¼šä¸ºæ•´ä¸ªç®¡é“è¿è¡Œåˆ†é…å…¨å±€ä»£ç†ï¼Œæ¯ä¸ªé˜¶æ®µéƒ¨åˆ†éƒ½éœ€è¦åŒ…å«è‡ªå·±çš„ä»£ç†éƒ¨åˆ†ã€‚<br>For example:<br> agent none</p>
</li>
<li><p>label    Execute the Pipeline, or stage, on an agent available in the Jenkins environment with the provided label.<br>For example:<br>agent { label â€˜my-defined-labelâ€™ }</p>
</li>
</ol>
<p>Label conditions can also be used. For example:<br>    agent { label â€˜my-label1 &amp;&amp; my-label2â€™ }<br>or<br>    agent { label â€˜my-label1 || my-label2â€™ }</p>
<ol start="4">
<li><p>node  node å’Œlabel ç±»ä¼¼ï¼Œä½†æ˜¯ node æ”¯æŒ é¢å¤–çš„æ›´å¤šçš„å‚æ•°ï¼Œä¾‹å¦‚customWorkspace<br> agent { node { label â€˜labelNameâ€™ } } behaves the same as agent { label â€˜labelNameâ€™ },<br> but node allows for additional options (such as customWorkspace).</p>
</li>
<li><p>docker Execute the Pipeline, or stage, with the given container which will be dynamically provisioned on a node pre-configured<br>to accept Docker-based Pipelines, or on a node matching the optionally defined label parameter.<br>docker also optionally accepts an args parameter which may contain arguments to pass directly to a docker run invocation, and an alwaysPull option, which will<br>force a docker pull even if the image name is already present.<br>ä½¿ç”¨ç»™å®šçš„å®¹å™¨æ‰§è¡Œç®¡é“æˆ–é˜¶æ®µï¼Œè¯¥å®¹å™¨å°†åœ¨é¢„å…ˆé…ç½®çš„èŠ‚ç‚¹ä¸ŠåŠ¨æ€é…ç½®, æ¥å—åŸºäº Docker çš„ç®¡é“ï¼Œæˆ–åœ¨ä¸å¯é€‰å®šä¹‰çš„æ ‡ç­¾å‚æ•°åŒ¹é…çš„èŠ‚ç‚¹ä¸Šã€‚<br>docker ä¹Ÿå¯ä»¥é€‰æ‹©æ¥å— ä¸€ä¸ª args å‚æ•°ï¼Œå®ƒå¯èƒ½åŒ…å«ç›´æ¥ä¼ é€’ç»™ docker run è°ƒç”¨çš„å‚æ•°ï¼Œä»¥åŠä¸€ä¸ª alwaysPull é€‰é¡¹ï¼Œå®ƒå°†  å³ä½¿imageåç§°å·²ç»å­˜åœ¨ï¼Œä¹Ÿå¼ºåˆ¶æ‰§è¡Œ docker pullã€‚</p>
</li>
</ol>
<p>For example:<br>    agent { docker â€˜maven:3.8.1-adoptopenjdk-11â€™ }<br>or<br>    agent {<br>        docker {<br>            image â€˜maven:3.8.1-adoptopenjdk-11â€™<br>            label â€˜my-defined-labelâ€™<br>            args  â€˜-v &#x2F;tmp:&#x2F;tmpâ€™<br>        }<br>    }</p>
<p>docker è¿˜å¯ä»¥é€‰æ‹©æ¥å— registryUrl å’Œ registryCredentialsId å‚æ•°ï¼Œè¿™å°†æœ‰åŠ©äºæŒ‡å®šè¦ä½¿ç”¨çš„ Docker Registry åŠå…¶å‡­æ®ã€‚ å‚æ•° registryCredentialsId å¯ä»¥å•ç‹¬ç”¨äº docker hub å†…çš„ç§æœ‰å­˜å‚¨åº“ã€‚ ä¾‹å¦‚ï¼š<br>    agent {<br>        docker {<br>            image â€˜myregistry.com&#x2F;nodeâ€™<br>            label â€˜my-defined-labelâ€™<br>            registryUrl â€˜<a target="_blank" rel="noopener" href="https://myregistry.com/&#39;">https://myregistry.com/&#39;</a><br>            registryCredentialsId â€˜myPredefinedCredentialsInJenkinsâ€™<br>        }<br>    }</p>
<ol start="6">
<li><p>dockerfile Execute the Pipeline, or stage, with a container built from a Dockerfile contained in the source repository.<br>In order to use this option, the Jenkinsfile must be loaded from either a Multibranch Pipeline or a Pipeline from SCM.<br>Conventionally this is the Dockerfile in the root of the source repository: agent { dockerfile true }.<br>If building a Dockerfile in another directory, use the dir option: agent { dockerfile { dir â€˜someSubDirâ€™ } }.<br>If your Dockerfile has another name, you can specify the file name with the filename option.<br>You can pass additional arguments to the docker build â€¦â€‹ command with the additionalBuildArgs option,<br>like agent { dockerfile { additionalBuildArgs â€˜â€“build-arg foo&#x3D;barâ€™ } }.<br>For example, a repository with the file build&#x2F;Dockerfile.build, expecting a build argument version:<br>ä½¿ç”¨ä»æºå­˜å‚¨åº“ä¸­åŒ…å«çš„ Dockerfile æ„å»ºçš„å®¹å™¨æ‰§è¡Œç®¡é“æˆ–é˜¶æ®µã€‚ ä¸ºäº†ä½¿ç”¨æ­¤é€‰é¡¹ï¼Œå¿…é¡»ä»å¤šåˆ†æ”¯ç®¡é“æˆ–æ¥è‡ª SCM çš„ç®¡é“åŠ è½½ Jenkinsfileã€‚ é€šå¸¸è¿™æ˜¯æºå­˜å‚¨åº“æ ¹ç›®å½•ä¸­çš„ Dockerfileï¼šagent { dockerfile true }ã€‚ å¦‚æœåœ¨å¦ä¸€ä¸ªç›®å½•ä¸­æ„å»º Dockerfileï¼Œè¯·ä½¿ç”¨ dir é€‰é¡¹ï¼šagent { dockerfile { dir â€˜someSubDirâ€™ } }ã€‚ å¦‚æœæ‚¨çš„ Dockerfile æœ‰å…¶ä»–åç§°ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ filename é€‰é¡¹æŒ‡å®šæ–‡ä»¶åã€‚ æ‚¨å¯ä»¥ä½¿ç”¨ additionalBuildArgs é€‰é¡¹å°†å…¶ä»–å‚æ•°ä¼ é€’ç»™ docker build â€¦ å‘½ä»¤ï¼Œä¾‹å¦‚ agent { dockerfile { additionalBuildArgs â€˜â€“build-arg foo&#x3D;barâ€™ } }ã€‚ ä¾‹å¦‚ï¼Œå…·æœ‰æ–‡ä»¶ build&#x2F;Dockerfile.build çš„å­˜å‚¨åº“ï¼Œéœ€è¦æ„å»ºå‚æ•°ç‰ˆæœ¬ï¼š<br>agent {<br> &#x2F;&#x2F; Equivalent to â€œdocker build -f Dockerfile.build â€“build-arg version&#x3D;1.0.2 .&#x2F;build&#x2F;<br> dockerfile {<br>     filename â€˜Dockerfile.buildâ€™<br>     dir â€˜buildâ€™<br>     label â€˜my-defined-labelâ€™<br>     additionalBuildArgs  â€˜â€“build-arg version&#x3D;1.0.2â€™<br>     args â€˜-v &#x2F;tmp:&#x2F;tmpâ€™<br> }<br> }</p>
<p>dockerfile also optionally accepts a registryUrl and registryCredentialsId parameters which will help to specify the Docker Registry to use and its credentials. For example:<br>dockerfile è¿˜å¯ä»¥é€‰æ‹©æ¥å— registryUrl å’Œ registryCredentialsId å‚æ•°ï¼Œè¿™å°†æœ‰åŠ©äºæŒ‡å®šè¦ä½¿ç”¨çš„ Docker Registry åŠå…¶å‡­æ®ã€‚ ä¾‹å¦‚ï¼š<br>agent {<br> dockerfile {<br>     filename â€˜Dockerfile.buildâ€™<br>     dir â€˜buildâ€™<br>     label â€˜my-defined-labelâ€™<br>     registryUrl â€˜<a target="_blank" rel="noopener" href="https://myregistry.com/&#39;">https://myregistry.com/&#39;</a><br>     registryCredentialsId â€˜myPredefinedCredentialsInJenkinsâ€™<br> }<br> }</p>
</li>
<li><p>kubernetes Execute the Pipeline, or stage, inside a pod deployed on a Kubernetes cluster.<br>In order to use this option, the Jenkinsfile must be loaded from either a Multibranch Pipeline or a Pipeline from SCM.<br>The Pod template is defined inside the kubernetes { } block. For example, if you want a pod with a Kaniko container inside it,<br>you would define it as follows:<br>åœ¨ Kubernetes é›†ç¾¤ä¸Šéƒ¨ç½²çš„ pod å†…æ‰§è¡Œç®¡é“æˆ–é˜¶æ®µã€‚ ä¸ºäº†ä½¿ç”¨æ­¤é€‰é¡¹ï¼Œå¿…é¡»ä»å¤šåˆ†æ”¯ç®¡é“æˆ–æ¥è‡ª SCM çš„ç®¡é“åŠ è½½ Jenkinsfileã€‚<br>Pod æ¨¡æ¿åœ¨ kubernetes { } å—å†…å®šä¹‰ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³è¦ä¸€ä¸ªé‡Œé¢æœ‰ Kaniko å®¹å™¨çš„ podï¼Œä½ å¯ä»¥è¿™æ ·å®šä¹‰å®ƒï¼š<br>agent {<br> kubernetes {<br>     label podlabel<br>     yaml â€œâ€â€<br> kind: Pod<br> metadata:<br>   name: jenkins-agent<br> spec:<br>   containers:</p>
<ul>
<li>name: kaniko<br>image: gcr.io&#x2F;kaniko-project&#x2F;executor:debug<br>imagePullPolicy: Always<br>command:<ul>
<li>&#x2F;busybox&#x2F;cat<br>tty: true<br>volumeMounts:<ul>
<li>name: aws-secret<br>mountPath: &#x2F;root&#x2F;.aws&#x2F;</li>
<li>name: docker-registry-config<br>mountPath: &#x2F;kaniko&#x2F;.docker<br> restartPolicy: Never<br> volumes:</li>
</ul>
</li>
<li>name: aws-secret<br>secret:<br>  secretName: aws-secret</li>
<li>name: docker-registry-config<br>configMap:<br>  name: docker-registry-config<br> â€œâ€â€<br>  }</li>
</ul>
</li>
</ul>
<p>You will need to create a secret aws-secret for Kaniko to be able to authenticate with ECR. This secret should contain the contents of ~&#x2F;.aws&#x2F;credentials. The other volume is a ConfigMap which should contain the endpoint of your ECR registry. For example:<br>æ‚¨éœ€è¦ä¸º Kaniko åˆ›å»ºä¸€ä¸ªç§˜å¯† aws-secret æ‰èƒ½ä½¿ç”¨ ECR è¿›è¡Œèº«ä»½éªŒè¯ã€‚ æ­¤æœºå¯†åº”åŒ…å« ~&#x2F;.aws&#x2F;credentials çš„å†…å®¹ã€‚ å¦ä¸€ä¸ªå·æ˜¯ä¸€ä¸ª ConfigMapï¼Œå®ƒåº”è¯¥åŒ…å«æ‚¨çš„ ECR æ³¨å†Œè¡¨çš„ç«¯ç‚¹ã€‚ ä¾‹å¦‚ï¼š<br>{<br>       â€œcredHelpersâ€: {<br>         â€œ<your-aws-account-id>.dkr.ecr.eu-central-1.amazonaws.comâ€: â€œecr-loginâ€<br>       }<br> }</p>
<p> Refer to the following example for reference: <a target="_blank" rel="noopener" href="https://github.com/jenkinsci/kubernetes-plugin/blob/master/examples/kaniko.groovy">https://github.com/jenkinsci/kubernetes-plugin/blob/master/examples/kaniko.groovy</a></p>
</li>
</ol>
<h2 id="agent-Common-Options"><a href="#agent-Common-Options" class="headerlink" title="agent Common Options"></a>agent Common Options</h2><ol>
<li><p>label  A string. The label or label condition on which to run the Pipeline or individual stage.</p>
<p>åœ¨ä½¿ç”¨ nodeã€dockerã€dockerfileã€çš„æ—¶å€™æœ‰ä½¿ç”¨ è¿™ä¸ªlabelé€‰é¡¹,å¹¶ä¸”æ˜¯ ä½¿ç”¨nodeæ—¶å€™è¿™ä¸ªlabelæ˜¯å¿…é¡»çš„</p>
</li>
<li><p>customWorkspace A string. Run the Pipeline or individual stage this agent is applied to within this custom workspace, rather than the default. It can be either a relative path, in which case the custom workspace will be under the workspace root on the node, or an absolute path. For example:<br>ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ åœ¨æ­¤è‡ªå®šä¹‰å·¥ä½œåŒºä¸­è¿è¡Œæ­¤ä»£ç†åº”ç”¨åˆ°çš„ç®¡é“æˆ–å•ä¸ªé˜¶æ®µï¼Œè€Œä¸æ˜¯é»˜è®¤é˜¶æ®µã€‚ å®ƒå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè‡ªå®šä¹‰å·¥ä½œåŒºå°†ä½äºèŠ‚ç‚¹ä¸Šçš„å·¥ä½œåŒºæ ¹ç›®å½•ä¸‹ï¼Œä¹Ÿå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ã€‚ ä¾‹å¦‚ï¼š<br>agent {<br> node {<br>     label â€˜my-defined-labelâ€™<br>     customWorkspace â€˜&#x2F;some&#x2F;other&#x2F;pathâ€™<br> }<br> }<br> åœ¨ä½¿ç”¨ nodeã€dockerã€dockerfileã€çš„æ—¶å€™æœ‰ä½¿ç”¨ è¿™ä¸ªcustomWorkspaceé€‰é¡¹,</p>
</li>
<li><p>reuseNode    A boolean, false by default. If true, run the container on the node specified at the top-level of the Pipeline, in the same workspace, rather than on a new node entirely.<br>å¸ƒå°”å€¼ï¼Œé»˜è®¤ä¸º falseã€‚ å¦‚æœä¸º trueï¼Œåˆ™åœ¨åŒä¸€å·¥ä½œåŒºä¸­çš„ Pipeline é¡¶å±‚æŒ‡å®šçš„èŠ‚ç‚¹ä¸Šè¿è¡Œå®¹å™¨ï¼Œè€Œä¸æ˜¯å®Œå…¨åœ¨æ–°èŠ‚ç‚¹ä¸Šè¿è¡Œã€‚<br>æ­¤é€‰é¡¹å¯¹ docker å’Œ dockerfile æœ‰æ•ˆï¼Œå¹¶ä¸”ä»…åœ¨ç”¨äºå•ä¸ªé˜¶æ®µçš„ä»£ç†æ—¶æœ‰æ•ˆã€‚ </p>
</li>
<li><p>args    A string. Runtime arguments to pass to docker run.<br>æ­¤é€‰é¡¹å¯¹ docker å’Œ dockerfile æœ‰æ•ˆ.</p>
</li>
</ol>
<h2 id="agent-Example"><a href="#agent-Example" class="headerlink" title="agent Example"></a>agent Example</h2><p>Example 1. Docker Agent, Declarative Pipeline</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent &#123; docker &#x27;maven:3.8.1-adoptopenjdk-11&#x27; &#125;</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;Example Build&#x27;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                sh &#x27;mvn -B clean verify&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ç»™å®šåç§°å’Œæ ‡ç­¾çš„æ–°åˆ›å»ºå®¹å™¨ä¸­æ‰§è¡Œæ­¤ç®¡é“ä¸­å®šä¹‰çš„æ‰€æœ‰æ­¥éª¤ , docker é•œåƒä½¿ç”¨ â€˜maven:3.8.1-adoptopenjdk-11â€™</p>
<p>Example 2. Stage-level Agent Section</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent none   //åœ¨ Pipeline çš„é¡¶å±‚å®šä¹‰ agent none å¯ç¡®ä¿ ä¸å¿…è¦åœ°åˆ†é… Executorã€‚ ä½¿ç”¨ agent none è¿˜ä¼šå¼ºåˆ¶æ¯ä¸ªé˜¶æ®µ stage éƒ¨åˆ†å¿…é¡»è¦é…ç½®ä»£ç†éƒ¨åˆ†ã€‚ </span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;Example Build&#x27;) &#123;</span><br><span class="line">            agent &#123; docker &#x27;maven:3.8.1-adoptopenjdk-11&#x27; &#125;  //ä½¿ç”¨æ­¤é•œåƒåœ¨æ–°åˆ›å»ºçš„å®¹å™¨ä¸­æ‰§è¡Œæ­¤é˜¶æ®µçš„æ­¥éª¤ã€‚ è¿™ä¸ªå®¹å™¨ä½¿ç”¨çš„ &#x27;maven:3.8.1-adoptopenjdk-11&#x27; è¿™ä¸ªé•œåƒ</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &#x27;Hello, Maven&#x27;</span><br><span class="line">                sh &#x27;mvn --version&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stage(&#x27;Example Test&#x27;) &#123;</span><br><span class="line">            agent &#123; docker &#x27;openjdk:8-jre&#x27; &#125;  //ä½¿ç”¨ä¸ä¸Šä¸€é˜¶æ®µä¸åŒçš„æ˜ åƒåœ¨æ–°åˆ›å»ºçš„å®¹å™¨ä¸­æ‰§è¡Œæ­¤é˜¶æ®µä¸­çš„æ­¥éª¤ã€‚ è¿™ä¸ªå®¹å™¨ä½¿ç”¨çš„ &#x27;openjdk:8-jre&#x27; è¿™ä¸ªé•œåƒ</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &#x27;Hello, JDK&#x27;</span><br><span class="line">                sh &#x27;java -version&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="post"><a href="#post" class="headerlink" title="post"></a>post</h2><p>post éƒ¨åˆ†å®šä¹‰äº†ä¸€ä¸ªæˆ–å¤šä¸ªåœ¨ç®¡é“æˆ–é˜¶æ®µè¿è¡Œå®Œæˆæ—¶è¿è¡Œçš„é™„åŠ æ­¥éª¤ï¼ˆå–å†³äºç®¡é“ä¸­ post éƒ¨åˆ†çš„ä½ç½®ï¼‰ã€‚<br>post å¯ä»¥æ”¯æŒä»¥ä¸‹ä»»ä½•åç½®æ¡ä»¶å—ï¼šalwaysã€changedã€fixedã€regressionã€abortedã€failureã€successã€unstableã€unsuccessful å’Œ cleanupã€‚<br>è¿™äº›æ¡ä»¶å—å…è®¸æ ¹æ®ç®¡é“æˆ–é˜¶æ®µçš„å®ŒæˆçŠ¶æ€åœ¨æ¯ä¸ªæ¡ä»¶å†…æ‰§è¡Œæ­¥éª¤ã€‚ æ¡ä»¶å—æŒ‰å¦‚ä¸‹æ‰€ç¤ºçš„é¡ºåºæ‰§è¡Œã€‚ </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Required     noæ˜¯å¦å¿…é¡»æœ‰ï¼Œä¸æ˜¯</span><br><span class="line"></span><br><span class="line">Parameters   æ²¡æœ‰å‚æ•°</span><br><span class="line"></span><br><span class="line">Allowed      å¯ä»¥åœ¨é¡¶å±‚ pipeline ä»£ç å—é‡Œç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨ stage ä»£ç å—é‡Œé¢ç”¨</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol>
<li>always<br> Run the steps in the post section regardless of the completion status of the Pipelineâ€™s or stageâ€™s run.</li>
<li>changed<br> Only run the steps in post if the current Pipelineâ€™s or stageâ€™s run has a different completion status from its previous run.</li>
<li>fixed<br> Only run the steps in post if the current Pipelineâ€™s or stageâ€™s run is successful and the previous run failed or was unstable.</li>
<li>regression<br> Only run the steps in post if the current Pipelineâ€™s or stageâ€™s runâ€™s status is failure, unstable, or aborted and the previous run was successful.</li>
<li>aborted<br> Only run the steps in post if the current Pipelineâ€™s or stageâ€™s run has an â€œabortedâ€ status, usually due to the Pipeline being manually aborted. This is typically denoted by gray in the web UI.</li>
<li>failure<br> Only run the steps in post if the current Pipelineâ€™s or stageâ€™s run has a â€œfailedâ€ status, typically denoted by red in the web UI.</li>
<li>success<br> Only run the steps in post if the current Pipelineâ€™s or stageâ€™s run has a â€œsuccessâ€ status, typically denoted by blue or green in the web UI.</li>
<li>unstable<br> Only run the steps in post if the current Pipelineâ€™s or stageâ€™s run has an â€œunstableâ€ status, usually caused by test failures, code violations, etc. This is typically denoted by yellow in the web UI.</li>
<li>unsuccessful<br> Only run the steps in post if the current Pipelineâ€™s or stageâ€™s run has not a â€œsuccessâ€ status. This is typically denoted in the web UI depending on the status previously mentioned.</li>
<li>cleanup<br>Run the steps in this post condition after every other post condition has been evaluated, regardless of the Pipeline or stageâ€™s status.</li>
</ol>
<h2 id="stages"><a href="#stages" class="headerlink" title="stages"></a>stages</h2><p>Containing a sequence of one or more stage directives, the stages section is where the bulk of the â€œworkâ€ described by a Pipeline will be located.<br>At a minimum, it is recommended that stages contain at least one stage directive for each discrete part of the continuous delivery process, such as Build, Test, and Deploy.<br>é˜¶æ®µéƒ¨åˆ†åŒ…å«ä¸€ç³»åˆ—ä¸€ä¸ªæˆ–å¤šä¸ªé˜¶æ®µæŒ‡ä»¤ï¼Œæ˜¯æµæ°´çº¿æè¿°çš„å¤§éƒ¨åˆ†â€œå·¥ä½œâ€æ‰€åœ¨çš„ä½ç½®ã€‚ å¯¹äºæŒç»­äº¤ä»˜è¿‡ç¨‹çš„æ¯ä¸ªç¦»æ•£éƒ¨åˆ†ï¼Œå»ºè®®é˜¶æ®µè‡³å°‘åŒ…å«ä¸€ä¸ªé˜¶æ®µæŒ‡ä»¤ï¼Œä¾‹å¦‚æ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²ã€‚<br>è¿™ä¸ªå’Œ angentï¼Œpost, environment ç­‰éƒ½æ˜¯å¹¶åˆ—çš„ï¼Œåœ¨ pipeline ä»£ç å—å†…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Required     Yes, æ˜¯å¦å¿…é¡»æœ‰ï¼Œæ˜¯</span><br><span class="line"></span><br><span class="line">Parameters   æ²¡æœ‰å‚æ•°</span><br><span class="line"></span><br><span class="line">Allowed      Only once, inside the pipeline block.åªèƒ½åœ¨é¡¶å±‚ pipeline ä»£ç å—é‡Œç”¨</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line">    stages &#123; </span><br><span class="line">        stage(&#x27;Example&#x27;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &#x27;Hello World&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    post &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="stage"><a href="#stage" class="headerlink" title="stage"></a>stage</h2><p>The stage directive goes in the stages section and should contain a steps section, an optional agent section, or other stage-specific directives.<br>Practically speaking, all of the real work done by a Pipeline will be wrapped in one or more stage directives.<br>stage æŒ‡ä»¤ä½äº stage éƒ¨åˆ†ï¼Œåº”è¯¥åŒ…å«ä¸€ä¸ª steps éƒ¨åˆ†ã€ä¸€ä¸ªå¯é€‰çš„ agent éƒ¨åˆ†æˆ–å…¶ä»–ç‰¹å®šäº stage çš„æŒ‡ä»¤ã€‚ å®é™…ä¸Šï¼Œæµæ°´çº¿å®Œæˆçš„æ‰€æœ‰å®é™…å·¥ä½œéƒ½å°†åŒ…å«åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªé˜¶æ®µæŒ‡ä»¤ä¸­ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Required    At least one è‡³å°‘æœ‰ä¸€ä¸ª</span><br><span class="line"></span><br><span class="line">Parameters  ä¸€ä¸ªå¼ºåˆ¶å‚æ•°ï¼Œstageåç§°çš„å­—ç¬¦ä¸²ã€‚ </span><br><span class="line"></span><br><span class="line">Allowed     Inside the stages section. åœ¨ stages ä»£ç å—ä¸­</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;Example&#x27;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &#x27;Hello World&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;Example Build&#x27;) &#123;  //åƒè¿™ä¸ª stage åœ¨  stages ä¸‹é¢ï¼Œå¯ä»¥å‡ºç°å¤šä¸ªçš„</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &#x27;Hello World&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stage(&#x27;Example Deploy&#x27;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &#x27;Deploying&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="steps"><a href="#steps" class="headerlink" title="steps"></a>steps</h2><p>The steps section defines a series of one or more steps to be executed in a given stage directive.<br>steps éƒ¨åˆ†å®šä¹‰äº†åœ¨ç»™å®šé˜¶æ®µæŒ‡ä»¤ä¸­è¦æ‰§è¡Œçš„ ä¸€ä¸ª æˆ– å¤šä¸ª æ­¥éª¤ã€‚ </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Required     Yes, æ˜¯å¦å¿…é¡»æœ‰ï¼Œæ˜¯</span><br><span class="line"></span><br><span class="line">Parameters   None æ²¡æœ‰å‚æ•°</span><br><span class="line"></span><br><span class="line">Allowed      Inside each stage block. åªèƒ½ç”¨åœ¨ stage ä»£ç å—ä¸­</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;Example&#x27;) &#123;</span><br><span class="line">            steps &#123; </span><br><span class="line">                echo &#x27;Hello World&#x27;   // åƒè¿™æ ·çš„  å¯ä»¥åœ¨ steps ä¸­å‡ºç°å¤šä¸ªçš„</span><br><span class="line">                sh &#x27;xxxxx&#x27;</span><br><span class="line">                junit &#x27;xxxx&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Sequential-Stages-è¿ç»­é˜¶æ®µ"><a href="#Sequential-Stages-è¿ç»­é˜¶æ®µ" class="headerlink" title="Sequential Stages è¿ç»­é˜¶æ®µ"></a>Sequential Stages è¿ç»­é˜¶æ®µ</h2><p>Stages in Declarative Pipeline may have a stages section containing a list of nested stages to be run in sequential order.<br>Note that a stage must have one and only one of steps, stages, parallel, or matrix. It is not possible to nest a parallel or<br>matrix block within a stage directive if that stage directive is nested within a parallel or matrix block itself. However,<br>a stage directive within a parallel or matrix block can use all other functionality of a stage, including agent, tools, when, etc.<br>å£°æ˜å¼ç®¡é“ä¸­çš„ æœ‰ä¸€ä¸ª stages éƒ¨åˆ†ï¼Œå…¶ä¸­åŒ…å«è¦ æŒ‰é¡ºåºè¿è¡Œçš„åµŒå¥— stagesåˆ—è¡¨ã€‚ è¯·æ³¨æ„ï¼Œä¸€ä¸ªstage å¿…é¡»å…·æœ‰ä¸”åªæœ‰ä¸€ä¸ªstepsã€stagesã€parallel æˆ– matrixã€‚ è¿™é‡Œè¯´ç™½äº†å°±æ˜¯ åµŒå¥— stages æ€ä¹ˆä¹¦å†™</p>
<p>å¦‚æœé˜¶æ®µæŒ‡ä»¤åµŒå¥—åœ¨å¹¶è¡Œæˆ–çŸ©é˜µå—æœ¬èº«å†…ï¼Œåˆ™ä¸å¯èƒ½åœ¨é˜¶æ®µæŒ‡ä»¤å†…åµŒå¥—å¹¶è¡Œæˆ–çŸ©é˜µå—ã€‚ ä½†æ˜¯ï¼Œå¹¶è¡Œæˆ–çŸ©é˜µå—ä¸­çš„é˜¶æ®µæŒ‡ä»¤å¯ä»¥ä½¿ç”¨é˜¶æ®µçš„æ‰€æœ‰å…¶ä»–åŠŸèƒ½ï¼ŒåŒ…æ‹¬ä»£ç†ã€å·¥å…·ã€ä½•æ—¶ç­‰ã€‚ </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent none</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;Non-Sequential Stage&#x27;) &#123;</span><br><span class="line">            agent &#123;</span><br><span class="line">                label &#x27;for-non-sequential&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &quot;On Non-Sequential Stage&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        stage(&#x27;Sequential&#x27;) &#123; // åµŒå¥—äº†</span><br><span class="line">            agent &#123;</span><br><span class="line">                label &#x27;for-sequential&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">            environment &#123;</span><br><span class="line">                FOR_SEQUENTIAL = &quot;some-value&quot;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            stages &#123;</span><br><span class="line">                stage(&#x27;In Sequential 1&#x27;) &#123;</span><br><span class="line">                    steps &#123;</span><br><span class="line">                        echo &quot;In Sequential 1&quot;</span><br><span class="line">                        echo &quot;In Sequential 1&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                stage(&#x27;In Sequential 2&#x27;) &#123;</span><br><span class="line">                    steps &#123;</span><br><span class="line">                        echo &quot;In Sequential 2&quot;</span><br><span class="line">                        echo &quot;In Sequential 2&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                stage(&#x27;Parallel In Sequential&#x27;) &#123;</span><br><span class="line">                    parallel &#123;</span><br><span class="line">                        stage(&#x27;In Parallel 1&#x27;) &#123;</span><br><span class="line">                            steps &#123;</span><br><span class="line">                                echo &quot;In Parallel 1&quot;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        stage(&#x27;In Parallel 2&#x27;) &#123;</span><br><span class="line">                            steps &#123;</span><br><span class="line">                                echo &quot;In Parallel 2&quot;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;// åµŒå¥—åœ¨å†…å®¹çš„ä¸€ä¸ª stages ç„¶åé‡Œé¢åˆæ˜¯ä¸€ä¸ªä¸€ä¸ªçš„  stageã€ç„¶åstage é‡Œé¢åˆæ˜¯ä¸€ä¸ª steps</span><br><span class="line">        &#125; //end stage(&#x27;Sequential&#x27;) &#123; // åµŒå¥—äº†</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    &#125;// end stages</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Parallel-å¹¶è¡Œé˜¶æ®µ"><a href="#Parallel-å¹¶è¡Œé˜¶æ®µ" class="headerlink" title="Parallel å¹¶è¡Œé˜¶æ®µ"></a>Parallel å¹¶è¡Œé˜¶æ®µ</h2><p>Stages in Declarative Pipeline may have a parallel section containing a list of nested stages to be run in parallel.<br>Note that a stage must have one and only one of steps, stages, parallel, or matrix. It is not possible to nest a<br>parallel or matrix block within a stage directive if that stage directive is nested within a parallel or matrix block itself.<br>However, a stage directive within a parallel or matrix block can use all other functionality of a stage, including agent, tools, when, etc.<br>In addition, you can force your parallel stages to all be aborted when any one of them fails, by adding failFast true to the<br>stage containing the parallel. Another option for adding failfast is adding an option to the pipeline definition: parallelsAlwaysFailFast()<br>å£°æ˜å¼ç®¡é“ä¸­çš„é˜¶æ®µå¯èƒ½æœ‰ä¸€ä¸ªå¹¶è¡Œéƒ¨åˆ†ï¼Œå…¶ä¸­åŒ…å«è¦å¹¶è¡Œè¿è¡Œçš„åµŒå¥—é˜¶æ®µåˆ—è¡¨ã€‚ è¯·æ³¨æ„ï¼Œä¸€ä¸ªstageå¿…é¡»å…·æœ‰ä¸”åªæœ‰ä¸€ä¸ªstepsã€stagesã€parallelæˆ–matrixã€‚<br>å¦‚æœé˜¶æ®µæŒ‡ä»¤åµŒå¥—åœ¨å¹¶è¡Œæˆ–çŸ©é˜µå—æœ¬èº«å†…ï¼Œåˆ™ä¸å¯èƒ½åœ¨é˜¶æ®µæŒ‡ä»¤å†…åµŒå¥—å¹¶è¡Œæˆ–çŸ©é˜µå—ã€‚ ä½†æ˜¯ï¼Œå¹¶è¡Œæˆ–çŸ©é˜µå—ä¸­çš„é˜¶æ®µæŒ‡ä»¤å¯ä»¥ä½¿ç”¨é˜¶æ®µçš„æ‰€æœ‰å…¶ä»–åŠŸèƒ½ï¼ŒåŒ…æ‹¬ä»£ç†ã€å·¥å…·ã€ä½•æ—¶ç­‰ã€‚<br>æ­¤å¤–ï¼Œæ‚¨å¯ä»¥é€šè¿‡å°† failFast true æ·»åŠ åˆ°åŒ…å«å¹¶è¡Œçš„é˜¶æ®µæ¥å¼ºåˆ¶æ‚¨çš„å¹¶è¡Œé˜¶æ®µåœ¨å…¶ä¸­ä»»ä½•ä¸€ä¸ªå¤±è´¥æ—¶ä¸­æ­¢ã€‚<br>æ·»åŠ  failfast çš„å¦ä¸€ä¸ªé€‰é¡¹æ˜¯åœ¨ç®¡é“å®šä¹‰ä¸­æ·»åŠ ä¸€ä¸ªé€‰é¡¹ï¼šparallelsAlwaysFailFast() </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;Non-Parallel Stage&#x27;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &#x27;This stage will be executed first.&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;//end stage(&#x27;Non-Parallel Stage&#x27;) </span><br><span class="line">        </span><br><span class="line">        stage(&#x27;Parallel Stage&#x27;) &#123;</span><br><span class="line">            when &#123;</span><br><span class="line">                branch &#x27;master&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            failFast true</span><br><span class="line">            </span><br><span class="line">            parallel &#123; // è¿™é‡Œæ˜¯å¹¶è¡Œï¼Œ è¿™ä¸ª Sequential Stages è¿ç»­é˜¶æ®µ ä¸­é‚£ä¸ªä¾‹å­é‡Œé¢çš„ å’Œ stages å¹¶åˆ—çš„</span><br><span class="line">                stage(&#x27;Branch A&#x27;) &#123;</span><br><span class="line">                    agent &#123;</span><br><span class="line">                        label &quot;for-branch-a&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                    steps &#123;</span><br><span class="line">                        echo &quot;On Branch A&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                stage(&#x27;Branch B&#x27;) &#123;</span><br><span class="line">                    agent &#123;</span><br><span class="line">                        label &quot;for-branch-b&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                    steps &#123;</span><br><span class="line">                        echo &quot;On Branch B&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                stage(&#x27;Branch C&#x27;) &#123;</span><br><span class="line">                    agent &#123;</span><br><span class="line">                        label &quot;for-branch-c&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                    stages &#123;</span><br><span class="line">                        stage(&#x27;Nested 1&#x27;) &#123;</span><br><span class="line">                            steps &#123;</span><br><span class="line">                                echo &quot;In stage Nested 1 within Branch C&quot;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        stage(&#x27;Nested 2&#x27;) &#123;</span><br><span class="line">                            steps &#123;</span><br><span class="line">                                echo &quot;In stage Nested 2 within Branch C&quot;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;//end stage(&#x27;Branch C&#x27;)</span><br><span class="line">                </span><br><span class="line">            &#125;//end parallel</span><br><span class="line">        &#125;//end stage(&#x27;Parallel Stage&#x27;)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    &#125;//end stages æœ€å¤–å±‚çš„é‚£ä¸ª stages</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line">    options &#123;</span><br><span class="line">        parallelsAlwaysFailFast()</span><br><span class="line">    &#125;</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;Non-Parallel Stage&#x27;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &#x27;This stage will be executed first.&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        stage(&#x27;Parallel Stage&#x27;) &#123;</span><br><span class="line">            when &#123;</span><br><span class="line">                branch &#x27;master&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">            parallel &#123;</span><br><span class="line">                stage(&#x27;Branch A&#x27;) &#123;</span><br><span class="line">                    agent &#123;</span><br><span class="line">                        label &quot;for-branch-a&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                    steps &#123;</span><br><span class="line">                        echo &quot;On Branch A&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                stage(&#x27;Branch B&#x27;) &#123;</span><br><span class="line">                    agent &#123;</span><br><span class="line">                        label &quot;for-branch-b&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                    steps &#123;</span><br><span class="line">                        echo &quot;On Branch B&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                stage(&#x27;Branch C&#x27;) &#123;</span><br><span class="line">                    agent &#123;</span><br><span class="line">                        label &quot;for-branch-c&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                    stages &#123;</span><br><span class="line">                        stage(&#x27;Nested 1&#x27;) &#123;</span><br><span class="line">                            steps &#123;</span><br><span class="line">                                echo &quot;In stage Nested 1 within Branch C&quot;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        stage(&#x27;Nested 2&#x27;) &#123;</span><br><span class="line">                            steps &#123;</span><br><span class="line">                                echo &quot;In stage Nested 2 within Branch C&quot;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;//end stage(&#x27;Branch C&#x27;)</span><br><span class="line">            &#125;//end parallel</span><br><span class="line">        &#125;//end stage(&#x27;Parallel Stage&#x27;)</span><br><span class="line">        </span><br><span class="line">    &#125;//end stages æœ€å¤–å±‚çš„é‚£ä¸ª stages</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="Matrix-çŸ©é˜µ"><a href="#Matrix-çŸ©é˜µ" class="headerlink" title="Matrix çŸ©é˜µ"></a>Matrix çŸ©é˜µ</h2><p>Stages in Declarative Pipeline may have a matrix section defining a multi-dimensional matrix of name-value combinations to be run in parallel.<br>Weâ€™ll refer these combinations as â€œcellsâ€ in a matrix.<br>Each cell in a matrix can include one or more stages to be run sequentially using the configuration for that cell.<br>Note that a stage must have one and only one of steps, stages, parallel, or matrix.<br>It is not possible to nest a parallel or matrix block within a stage directive if that stage directive is nested within a parallel or matrix block itself. </p>
<p>However, a stage directive within a parallel or matrix block can use all other functionality of a stage, including agent, tools, when, etc.<br>In addition, you can force your matrix cells to all be aborted when any one of them fails, by adding failFast true to the stage containing the matrix.<br>Another option for adding failfast is adding an option to the pipeline definition: parallelsAlwaysFailFast()<br>The matrix section must include an axes section and a stages section.<br>The axes section defines the values for each axis in the matrix.<br>The stages section defines a list of stages to run sequentially in each cell.<br>A matrix may have an excludes section to remove invalid cells from the matrix.<br>Many of the directives available on stage, including agent, tools, when, etc., can also be added to matrix to control the behavior of each cell.</p>
<p>å£°æ˜å¼ç®¡é“ä¸­çš„é˜¶æ®µå¯ä»¥æœ‰ä¸€ä¸ª çŸ©é˜µmatrix éƒ¨åˆ†ï¼Œå®šä¹‰äº†è¦å¹¶è¡Œè¿è¡Œçš„ åç§°-å€¼ ç»„åˆçš„å¤šç»´çŸ©é˜µã€‚æˆ‘ä»¬å°†è¿™äº›ç»„åˆç§°ä¸ºçŸ©é˜µä¸­çš„ å•å…ƒcell ã€‚<br>çŸ©é˜µä¸­çš„æ¯ä¸ª å•å…ƒ å¯ä»¥åŒ…æ‹¬ ä¸€ä¸ªæˆ–å¤šä¸ª é˜¶æ®µstagesï¼Œä»¥ä½¿ç”¨è¯¥å•å…ƒçš„é…ç½®é¡ºåºè¿è¡Œã€‚è¯·æ³¨æ„ï¼Œä¸€ä¸ª é˜¶æ®µstage å¿…é¡»å…·æœ‰ä¸”åªæœ‰ä¸€ä¸ª æ­¥éª¤stepsã€é˜¶æ®µstagesã€å¹¶è¡Œparallel æˆ– çŸ©é˜µmatrixã€‚<br>å¦‚æœé˜¶æ®µæŒ‡ä»¤åµŒå¥—åœ¨å¹¶è¡Œæˆ–çŸ©é˜µå—æœ¬èº«å†…ï¼Œåˆ™ä¸èƒ½åœ¨é˜¶æ®µæŒ‡ä»¤å†…åµŒå¥—å¹¶è¡Œæˆ–çŸ©é˜µå—ã€‚</p>
<p>ä½†æ˜¯ï¼Œmatrix æˆ– parallel å—ä¸­çš„ é˜¶æ®µæŒ‡ä»¤å¯ä»¥ä½¿ç”¨é˜¶æ®µçš„æ‰€æœ‰å…¶ä»–åŠŸèƒ½ï¼ŒåŒ…æ‹¬agentã€toolsã€whenç­‰ã€‚<br>æ­¤å¤–ï¼Œæ‚¨å¯ä»¥é€šè¿‡å°† failFast true æ·»åŠ åˆ°åŒ…å«çŸ©é˜µçš„é˜¶æ®µæ¥å¼ºåˆ¶çŸ©é˜µå•å…ƒåœ¨å…¶ä¸­ä»»ä½•ä¸€ä¸ªå¤±è´¥æ—¶ä¸­æ­¢ã€‚<br>æ·»åŠ  failfast çš„å¦ä¸€ä¸ªé€‰é¡¹æ˜¯åœ¨ç®¡é“å®šä¹‰ä¸­æ·»åŠ ä¸€ä¸ªoptionï¼šparallelsAlwaysFailFast()<br>çŸ©é˜µéƒ¨åˆ†å¿…é¡»åŒ…æ‹¬ axes éƒ¨åˆ†å’Œ stages éƒ¨åˆ†ã€‚axes éƒ¨åˆ†å®šä¹‰çŸ©é˜µä¸­æ¯ä¸ªè½´çš„å€¼ã€‚stages éƒ¨åˆ†å®šä¹‰äº†åœ¨æ¯ä¸ªå•å…ƒä¸­æŒ‰é¡ºåºè¿è¡Œçš„é˜¶æ®µåˆ—è¡¨ã€‚<br>çŸ©é˜µå¯ä»¥æœ‰ä¸€ä¸ª excludes éƒ¨åˆ†ä»¥ä»çŸ©é˜µä¸­åˆ é™¤æ— æ•ˆå•å…ƒã€‚stageä¸Šå¯ç”¨çš„è®¸å¤šæŒ‡ä»¤ï¼ŒåŒ…æ‹¬agentã€toolsã€whenç­‰ï¼Œä¹Ÿå¯ä»¥æ·»åŠ åˆ°çŸ©é˜µä¸­ä»¥æ§åˆ¶æ¯ä¸ªå•å…ƒæ ¼çš„è¡Œä¸º.</p>
<ol>
<li>axes çŸ©é˜µåæ ‡<br>è½´éƒ¨åˆ†æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªè½´æŒ‡ä»¤ã€‚ æ¯ä¸ªè½´éƒ½åŒ…å«ä¸€ä¸ªåç§°å’Œä¸€ä¸ªå€¼åˆ—è¡¨ã€‚ æ¯ä¸ªè½´çš„æ‰€æœ‰å€¼éƒ½ä¸å…¶ä»–å€¼ç»„åˆä»¥ç”Ÿæˆå•å…ƒæ ¼ã€‚</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">matrix &#123;</span><br><span class="line">    axes &#123;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;PLATFORM&#x27;</span><br><span class="line">            values &#x27;linux&#x27;, &#x27;mac&#x27;, &#x27;windows&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // ... 1x3 çŸ©é˜µç»„åˆ</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">matrix &#123;</span><br><span class="line">    axes &#123;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;PLATFORM&#x27;</span><br><span class="line">            values &#x27;linux&#x27;, &#x27;mac&#x27;, &#x27;windows&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;BROWSER&#x27;</span><br><span class="line">            values &#x27;chrome&#x27;, &#x27;edge&#x27;, &#x27;firefox&#x27;, &#x27;safari&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // ... 3x4 çŸ©é˜µç»„åˆ</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">matrix &#123;</span><br><span class="line">    axes &#123;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;PLATFORM&#x27;</span><br><span class="line">            values &#x27;linux&#x27;, &#x27;mac&#x27;, &#x27;windows&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;BROWSER&#x27;</span><br><span class="line">            values &#x27;chrome&#x27;, &#x27;edge&#x27;, &#x27;firefox&#x27;, &#x27;safari&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;ARCHITECTURE&#x27;</span><br><span class="line">            values &#x27;32-bit&#x27;, &#x27;64-bit&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // ... 3x4 çŸ©é˜µç»„åˆ</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li><p>stages çŸ©é˜µä¸­ä½¿ç”¨çš„stages<br>stages éƒ¨åˆ†æŒ‡å®šåœ¨æ¯ä¸ªå•å…ƒä¸­é¡ºåºæ‰§è¡Œçš„ä¸€ä¸ªæˆ–å¤šä¸ªé˜¶æ®µã€‚ axeså®šä¹‰åæ ‡ç»„åˆï¼Œstageså®šä¹‰æ‰§è¡Œé˜¶æ®µ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">matrix &#123;</span><br><span class="line">    axes &#123;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;PLATFORM&#x27;</span><br><span class="line">            values &#x27;linux&#x27;, &#x27;mac&#x27;, &#x27;windows&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;build&#x27;) &#123;</span><br><span class="line">            // ...</span><br><span class="line">        &#125;</span><br><span class="line">        stage(&#x27;test&#x27;) &#123;</span><br><span class="line">            // ...</span><br><span class="line">        &#125;</span><br><span class="line">        stage(&#x27;deploy&#x27;) &#123;</span><br><span class="line">            // ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">matrix &#123;</span><br><span class="line">    axes &#123;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;PLATFORM&#x27;</span><br><span class="line">            values &#x27;linux&#x27;, &#x27;mac&#x27;, &#x27;windows&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;BROWSER&#x27;</span><br><span class="line">            values &#x27;chrome&#x27;, &#x27;edge&#x27;, &#x27;firefox&#x27;, &#x27;safari&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;build-and-test&#x27;) &#123;</span><br><span class="line">            // ...</span><br><span class="line">        &#125;</span><br><span class="line">        stage(&#x27;deploy-and-test&#x27;) &#123;</span><br><span class="line">            // ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>excludes (optional) æ’é™¤æŸäº›åæ ‡ç»„åˆï¼Œåæ ‡ç»„åˆå¾ˆå¤šï¼Œå¯ä»¥æ’é™¤ä¸åˆç†çš„<br>The optional excludes section lets authors specify one or more exclude filter expressions that select cells to be excluded from the<br>expanded set of matrix cells (aka, sparsening). Filters are constructed using a basic directive structure of one or more of exclude<br>axis directives each with a name and values list.<br>The axis directives inside an exclude generate a set of combinations (similar to generating the matrix cells). The matrix cells that match<br>all the values from an exclude combination are removed from the matrix. If more than one exclude directive is supplied,<br>each is evaluated separately to remove cells.<br>When dealing with a long list of values to exclude, exclude axis directives can use notValues instead of values.<br>These will exclude cells that do not match one of the values passed to notValues.<br>å¯é€‰çš„ excludes éƒ¨åˆ†å…è®¸ä½œè€…æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªæ’é™¤è¿‡æ»¤è¡¨è¾¾å¼ï¼Œè¿™äº›è¡¨è¾¾å¼é€‰æ‹©è¦ä» çŸ©é˜µç»„åˆï¼ˆåˆåç¨€ç–ï¼‰ä¸­æ’é™¤ å•å…ƒæ ¼ã€‚<br>è¿‡æ»¤å™¨æ˜¯ä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ª æ’é™¤è½´æŒ‡ä»¤ ç»“æ„æ„å»ºçš„ï¼Œæ¯ä¸ªæ’é™¤è½´æŒ‡ä»¤éƒ½æœ‰ä¸€ä¸ªåç§°å’Œå€¼åˆ—è¡¨ã€‚<br>exclude ä¸­çš„è½´æŒ‡ä»¤ç”Ÿæˆä¸€ç»„ç»„åˆï¼ˆç±»ä¼¼äºç”ŸæˆçŸ©é˜µå•å…ƒï¼‰ã€‚ ä»çŸ©é˜µä¸­åˆ é™¤ä¸æ’é™¤ç»„åˆä¸­çš„æ‰€æœ‰å€¼åŒ¹é…çš„çŸ©é˜µå•å…ƒã€‚ å¦‚æœæä¾›äº†å¤šä¸ªæ’é™¤æŒ‡ä»¤ï¼Œåˆ™åˆ†åˆ«è¯„ä¼°æ¯ä¸ªæŒ‡ä»¤ä»¥åˆ é™¤å•å…ƒæ ¼ã€‚<br>åœ¨å¤„ç†è¦æ’é™¤çš„ä¸€é•¿ä¸²å€¼æ—¶ï¼Œæ’é™¤è½´æŒ‡ä»¤å¯ä»¥ä½¿ç”¨ notValues ä»£æ›¿å€¼ã€‚ è¿™äº›å°†æ’é™¤ä¸ä¼ é€’ç»™ notValues çš„å€¼ä¹‹ä¸€ä¸åŒ¹é…çš„å•å…ƒæ ¼ã€‚</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">matrix &#123;</span><br><span class="line">    axes &#123;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;PLATFORM&#x27;</span><br><span class="line">            values &#x27;linux&#x27;, &#x27;mac&#x27;, &#x27;windows&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;BROWSER&#x27;</span><br><span class="line">            values &#x27;chrome&#x27;, &#x27;edge&#x27;, &#x27;firefox&#x27;, &#x27;safari&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;ARCHITECTURE&#x27;</span><br><span class="line">            values &#x27;32-bit&#x27;, &#x27;64-bit&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; //çŸ©é˜µç»„åˆä¸€å…±æœ‰ 3x4x2 = 24 ç»„ </span><br><span class="line">    excludes &#123;</span><br><span class="line">        exclude &#123;</span><br><span class="line">            axis &#123;</span><br><span class="line">                name &#x27;PLATFORM&#x27;</span><br><span class="line">                values &#x27;mac&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">            axis &#123;</span><br><span class="line">                name &#x27;ARCHITECTURE&#x27;</span><br><span class="line">                values &#x27;32-bit&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // ...æ’é™¤ äº† 1x1x4 = 4 ç»„  mac-32-bit è¿™ä¸ª,BROWSERä¸å…³å¿ƒï¼Œéƒ½ä¼šæ’é™¤æ‰, mac_&#123;chrome,edge,firefox,safari&#125;_32-bit è¿™4ä¸ªéƒ½ä¼šæ’é™¤æ‰çš„</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">matrix &#123;</span><br><span class="line">    axes &#123;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;PLATFORM&#x27;</span><br><span class="line">            values &#x27;linux&#x27;, &#x27;mac&#x27;, &#x27;windows&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;BROWSER&#x27;</span><br><span class="line">            values &#x27;chrome&#x27;, &#x27;edge&#x27;, &#x27;firefox&#x27;, &#x27;safari&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        axis &#123;</span><br><span class="line">            name &#x27;ARCHITECTURE&#x27;</span><br><span class="line">            values &#x27;32-bit&#x27;, &#x27;64-bit&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; //çŸ©é˜µç»„åˆä¸€å…±æœ‰ 3x4x2 = 24 ç»„ </span><br><span class="line">    excludes &#123;</span><br><span class="line">        exclude &#123;</span><br><span class="line">            // 4 cells</span><br><span class="line">            axis &#123;</span><br><span class="line">                name &#x27;PLATFORM&#x27;</span><br><span class="line">                values &#x27;mac&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">            axis &#123;</span><br><span class="line">                name &#x27;ARCHITECTURE&#x27;</span><br><span class="line">                values &#x27;32-bit&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; // è¿™ä¸ªæ˜¯ èƒ½åŒ¹é…ä¸Š  mac_&#123;chrome,edge,firefox,safari&#125;_32-bit è¿™4ä¸ª</span><br><span class="line">        exclude &#123;</span><br><span class="line">            // 2 cells</span><br><span class="line">            axis &#123;</span><br><span class="line">                name &#x27;PLATFORM&#x27;</span><br><span class="line">                values &#x27;linux&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">            axis &#123;</span><br><span class="line">                name &#x27;BROWSER&#x27;</span><br><span class="line">                values &#x27;safari&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; // è¿™ä¸ªæ˜¯ èƒ½åŒ¹é…ä¸Š  linux_safari_&#123;32-bit, 64-bit&#125; è¿™2ä¸ª</span><br><span class="line">        exclude &#123;</span><br><span class="line">            // 3 more cells and &#x27;32-bit, mac&#x27; (already excluded)</span><br><span class="line">            axis &#123;</span><br><span class="line">                name &#x27;PLATFORM&#x27;</span><br><span class="line">                notValues &#x27;windows&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">            axis &#123;</span><br><span class="line">                name &#x27;BROWSER&#x27;</span><br><span class="line">                values &#x27;edge&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; // windows_edge_&#123;32-bit, 64-bit&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>Matrix cell-level directives (optional)</li>
</ol>
<p>Matrix å…è®¸ç”¨æˆ·é€šè¿‡åœ¨çŸ©é˜µæœ¬èº«ä¸‹æ·»åŠ é˜¶æ®µçº§æŒ‡ä»¤æ¥æœ‰æ•ˆåœ°é…ç½®æ¯ä¸ªå•å…ƒçš„æ•´ä½“ç¯å¢ƒã€‚ è¿™äº›æŒ‡ä»¤çš„è¡Œä¸ºä¸å®ƒä»¬åœ¨èˆå°ä¸Šçš„è¡Œä¸ºç›¸åŒï¼Œä½†å®ƒä»¬ä¹Ÿå¯ä»¥æ¥å—çŸ©é˜µä¸ºæ¯ä¸ªå•å…ƒæ ¼æä¾›çš„å€¼ã€‚</p>
<p>è½´å’Œæ’é™¤æŒ‡ä»¤å®šä¹‰æ„æˆçŸ©é˜µçš„é™æ€å•å…ƒæ ¼é›†ã€‚ è¿™ç»„ç»„åˆæ˜¯åœ¨ç®¡é“è¿è¡Œå¼€å§‹ä¹‹å‰ç”Ÿæˆçš„ã€‚ å¦ä¸€æ–¹é¢ï¼Œâ€œper-cellâ€æŒ‡ä»¤åœ¨è¿è¡Œæ—¶è¿›è¡Œè¯„ä¼°ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    parameters &#123;</span><br><span class="line">        choice(name: &#x27;PLATFORM_FILTER&#x27;, choices: [&#x27;all&#x27;, &#x27;linux&#x27;, &#x27;windows&#x27;, &#x27;mac&#x27;], description: &#x27;Run on specific platform&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line">    agent none</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;BuildAndTest&#x27;) &#123;</span><br><span class="line">            matrix &#123;</span><br><span class="line">                agent &#123;</span><br><span class="line">                    label &quot;$&#123;PLATFORM&#125;-agent&quot;</span><br><span class="line">                &#125;</span><br><span class="line">                when &#123; anyOf &#123;</span><br><span class="line">                    expression &#123; params.PLATFORM_FILTER == &#x27;all&#x27; &#125;</span><br><span class="line">                    expression &#123; params.PLATFORM_FILTER == env.PLATFORM &#125;</span><br><span class="line">                &#125; &#125;</span><br><span class="line">                axes &#123;</span><br><span class="line">                    axis &#123;</span><br><span class="line">                        name &#x27;PLATFORM&#x27;</span><br><span class="line">                        values &#x27;linux&#x27;, &#x27;windows&#x27;, &#x27;mac&#x27;</span><br><span class="line">                    &#125;</span><br><span class="line">                    axis &#123;</span><br><span class="line">                        name &#x27;BROWSER&#x27;</span><br><span class="line">                        values &#x27;firefox&#x27;, &#x27;chrome&#x27;, &#x27;safari&#x27;, &#x27;edge&#x27;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                excludes &#123;</span><br><span class="line">                    exclude &#123;</span><br><span class="line">                        axis &#123;</span><br><span class="line">                            name &#x27;PLATFORM&#x27;</span><br><span class="line">                            values &#x27;linux&#x27;</span><br><span class="line">                        &#125;</span><br><span class="line">                        axis &#123;</span><br><span class="line">                            name &#x27;BROWSER&#x27;</span><br><span class="line">                            values &#x27;safari&#x27;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    exclude &#123;</span><br><span class="line">                        axis &#123;</span><br><span class="line">                            name &#x27;PLATFORM&#x27;</span><br><span class="line">                            notValues &#x27;windows&#x27;</span><br><span class="line">                        &#125;</span><br><span class="line">                        axis &#123;</span><br><span class="line">                            name &#x27;BROWSER&#x27;</span><br><span class="line">                            values &#x27;edge&#x27;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                stages &#123;</span><br><span class="line">                    stage(&#x27;Build&#x27;) &#123;</span><br><span class="line">                        steps &#123;</span><br><span class="line">                            echo &quot;Do Build for $&#123;PLATFORM&#125; - $&#123;BROWSER&#125;&quot;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    stage(&#x27;Test&#x27;) &#123;</span><br><span class="line">                        steps &#123;</span><br><span class="line">                            echo &quot;Do Test for $&#123;PLATFORM&#125; - $&#123;BROWSER&#125;&quot;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="script"><a href="#script" class="headerlink" title="script"></a>script</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(&#x27;Example&#x27;) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo &#x27;Hello World&#x27;</span><br><span class="line"></span><br><span class="line">                script &#123;</span><br><span class="line">                    def browsers = [&#x27;chrome&#x27;, &#x27;firefox&#x27;]</span><br><span class="line">                    for (int i = 0; i &lt; browsers.size(); ++i) &#123;</span><br><span class="line">                        echo &quot;Testing the $&#123;browsers[i]&#125; browser&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://magesfc.github.io">mage</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://magesfc.github.io/mage/abb5b3c7b70b496b314410760585d1678b857995/">https://magesfc.github.io/mage/abb5b3c7b70b496b314410760585d1678b857995/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://magesfc.github.io" target="_blank">é©¬å“¥ç§æˆ¿èœ</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/jenkins/">jenkins</a></div><div class="post_share"><div class="social-share" data-image="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> æ‰“èµ</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="/null" alt="å¾®ä¿¡"/></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="/null" alt="æ”¯ä»˜å¯¶"/></a><div class="post-qr-code-desc">æ”¯ä»˜å¯¶</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/mage/35daa433f1d2df61d4d92c19d510e19a6bafcf4f/"><img class="prev-cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">Springå­¦ä¹ ç¬”è®°æ€»ç»“</div></div></a></div><div class="next-post pull-right"><a href="/mage/454c769256a3f93a38c0d61a42811b8915d65c0d/"><img class="next-cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">Kuberneteså­¦ä¹ ç¬”è®°æ€»ç»“ä¹‹k8sé›†ç¾¤å®‰è£…éƒ¨ç½²</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/mage/253e7a0d87524ac8029f65b14264563e1a3b8207/" title="Jenkinså­¦ä¹ ä¹‹ä½¿ç”¨curlå‘½ä»¤è§¦å‘ä»»åŠ¡"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">Jenkinså­¦ä¹ ä¹‹ä½¿ç”¨curlå‘½ä»¤è§¦å‘ä»»åŠ¡</div></div></a></div><div><a href="/mage/02368d77bf5b9d8e5b43072b3e068f809d04c4ae/" title="jenkinså­¦ä¹ ä¹‹Jenkinså¤–éƒ¨ä»»åŠ¡é¡¹ç›®"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">jenkinså­¦ä¹ ä¹‹Jenkinså¤–éƒ¨ä»»åŠ¡é¡¹ç›®</div></div></a></div><div><a href="/mage/298144bf31bdad623369d39b38ebddb64dde1abd/" title="jenkinså­¦ä¹ ä¹‹Jenkinså¼€å‘è°ƒè¯•äºjenkinsæ’ä»¶å¼€å‘è°ƒè¯•"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">jenkinså­¦ä¹ ä¹‹Jenkinså¼€å‘è°ƒè¯•äºjenkinsæ’ä»¶å¼€å‘è°ƒè¯•</div></div></a></div><div><a href="/mage/5112822067c3457acc097c5d54b9585772b0a71d/" title="jenkinså­¦ä¹ ä¹‹Jenkinsæµæ°´çº¿parallelå¹¶å‘æ‰§è¡Œ"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">jenkinså­¦ä¹ ä¹‹Jenkinsæµæ°´çº¿parallelå¹¶å‘æ‰§è¡Œ</div></div></a></div><div><a href="/mage/0eb743cba8f68c55a93fb8c3f5ee18603bfb829e/" title="jenkinså­¦ä¹ ä¹‹Jenkinsæµæ°´çº¿whenæ¡ä»¶åˆ¤æ–­æ‰§è¡Œ"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">jenkinså­¦ä¹ ä¹‹Jenkinsæµæ°´çº¿whenæ¡ä»¶åˆ¤æ–­æ‰§è¡Œ</div></div></a></div><div><a href="/mage/86414c0faeee7450c569648f1849eb4867f8bccb/" title="jenkinså­¦ä¹ ä¹‹Jenkinsæµæ°´çº¿ä¸­loadå…¶ä»–groovyæ–‡ä»¶"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">jenkinså­¦ä¹ ä¹‹Jenkinsæµæ°´çº¿ä¸­loadå…¶ä»–groovyæ–‡ä»¶</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">mage</div><div class="author-info__description"> è¿™é‡Œæ˜¯ é©¬å“¥ çš„ä¸ªäººåšå®¢ </div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">154</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">171</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">34</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/mamh2021"><i class="fab fa-github"></i><span>GitHub</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/mamh2021" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Declarative-Pipeline"><span class="toc-number">1.</span> <span class="toc-text">Declarative Pipeline</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#agent"><span class="toc-number">1.1.</span> <span class="toc-text">agent</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#agent-%E5%8F%82%E6%95%B0"><span class="toc-number">1.2.</span> <span class="toc-text">agent å‚æ•°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#agent-Common-Options"><span class="toc-number">1.3.</span> <span class="toc-text">agent Common Options</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#agent-Example"><span class="toc-number">1.4.</span> <span class="toc-text">agent Example</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#post"><span class="toc-number">1.5.</span> <span class="toc-text">post</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#stages"><span class="toc-number">1.6.</span> <span class="toc-text">stages</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#stage"><span class="toc-number">1.7.</span> <span class="toc-text">stage</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#steps"><span class="toc-number">1.8.</span> <span class="toc-text">steps</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sequential-Stages-%E8%BF%9E%E7%BB%AD%E9%98%B6%E6%AE%B5"><span class="toc-number">1.9.</span> <span class="toc-text">Sequential Stages è¿ç»­é˜¶æ®µ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Parallel-%E5%B9%B6%E8%A1%8C%E9%98%B6%E6%AE%B5"><span class="toc-number">1.10.</span> <span class="toc-text">Parallel å¹¶è¡Œé˜¶æ®µ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Matrix-%E7%9F%A9%E9%98%B5"><span class="toc-number">1.11.</span> <span class="toc-text">Matrix çŸ©é˜µ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#script"><span class="toc-number">1.12.</span> <span class="toc-text">script</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/mage/eb822dde30a05b68de146f64ccf79add56764b2e/" title="jenkinså­¦ä¹ ä¹‹pluginå®‰è£…"><img src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="jenkinså­¦ä¹ ä¹‹pluginå®‰è£…"/></a><div class="content"><a class="title" href="/mage/eb822dde30a05b68de146f64ccf79add56764b2e/" title="jenkinså­¦ä¹ ä¹‹pluginå®‰è£…">jenkinså­¦ä¹ ä¹‹pluginå®‰è£…</a><time datetime="2022-11-01T03:21:55.000Z" title="å‘è¡¨äº 2022-11-01 11:21:55">2022-11-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/a5f602c98d515279f19b5deea0155101f733d9f7/" title="jenkinså­¦ä¹ ä¹‹masteræœåŠ¡å™¨å®‰è£…"><img src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="jenkinså­¦ä¹ ä¹‹masteræœåŠ¡å™¨å®‰è£…"/></a><div class="content"><a class="title" href="/mage/a5f602c98d515279f19b5deea0155101f733d9f7/" title="jenkinså­¦ä¹ ä¹‹masteræœåŠ¡å™¨å®‰è£…">jenkinså­¦ä¹ ä¹‹masteræœåŠ¡å™¨å®‰è£…</a><time datetime="2022-11-01T03:08:20.000Z" title="å‘è¡¨äº 2022-11-01 11:08:20">2022-11-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/7b14abc60e1d18cc8811745a97f263978e87e4ae/" title="Hexoä¸ªäººåšå®¢æ­å»ºæ•™ç¨‹"><img src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hexoä¸ªäººåšå®¢æ­å»ºæ•™ç¨‹"/></a><div class="content"><a class="title" href="/mage/7b14abc60e1d18cc8811745a97f263978e87e4ae/" title="Hexoä¸ªäººåšå®¢æ­å»ºæ•™ç¨‹">Hexoä¸ªäººåšå®¢æ­å»ºæ•™ç¨‹</a><time datetime="2022-10-28T13:37:31.000Z" title="å‘è¡¨äº 2022-10-28 21:37:31">2022-10-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/9797fe175c0183a6563e7397692d780ecf683a6f/" title="Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹ansible-resources"><img src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹ansible-resources"/></a><div class="content"><a class="title" href="/mage/9797fe175c0183a6563e7397692d780ecf683a6f/" title="Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹ansible-resources">Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹ansible-resources</a><time datetime="2022-10-16T09:27:39.000Z" title="å‘è¡¨äº 2022-10-16 17:27:39">2022-10-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/a0bfcc2b49b5167196ecf1ed7f20f9eb180d9a43/" title="Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹synchronizeæ¨¡å—å­¦ä¹ "><img src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹synchronizeæ¨¡å—å­¦ä¹ "/></a><div class="content"><a class="title" href="/mage/a0bfcc2b49b5167196ecf1ed7f20f9eb180d9a43/" title="Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹synchronizeæ¨¡å—å­¦ä¹ ">Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹synchronizeæ¨¡å—å­¦ä¹ </a><time datetime="2022-10-13T03:27:35.000Z" title="å‘è¡¨äº 2022-10-13 11:27:35">2022-10-13</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2022 By mage</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>