<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Golang学习之struct转json | 马哥私房菜</title><meta name="author" content="mage"><meta name="copyright" content="mage"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="golang 结构体 struct 转 json 字符串https:&#x2F;&#x2F;www.sohamkamani.com&#x2F;golang&#x2F;omitempty&#x2F; 基本用法12345678910111213type Dog struct &amp;#123;	Breed string	WeightKg int&amp;#125;func main() &amp;#123;	d :&#x3D; Dog&amp;#123;		Breed:    &quot;">
<meta property="og:type" content="article">
<meta property="og:title" content="Golang学习之struct转json">
<meta property="og:url" content="https://magesfc.github.io/mage/6118b9bf91824574204e116d5b138ffbaab72268/">
<meta property="og:site_name" content="马哥私房菜">
<meta property="og:description" content="golang 结构体 struct 转 json 字符串https:&#x2F;&#x2F;www.sohamkamani.com&#x2F;golang&#x2F;omitempty&#x2F; 基本用法12345678910111213type Dog struct &amp;#123;	Breed string	WeightKg int&amp;#125;func main() &amp;#123;	d :&#x3D; Dog&amp;#123;		Breed:    &quot;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://t.mwm.moe/fj/">
<meta property="article:published_time" content="2022-11-14T06:06:32.000Z">
<meta property="article:modified_time" content="2022-11-14T06:06:32.000Z">
<meta property="article:author" content="mage">
<meta property="article:tag" content="golang">
<meta property="article:tag" content="struct">
<meta property="article:tag" content="json">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://t.mwm.moe/fj/"><link rel="shortcut icon" href="https://www.zeekrlife.com/favicon.png"><link rel="canonical" href="https://magesfc.github.io/mage/6118b9bf91824574204e116d5b138ffbaab72268/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":150,"languages":{"author":"作者: mage","link":"链接: ","source":"来源: 马哥私房菜","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Golang学习之struct转json',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-14 14:06:32'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><style type="text/css">.card-announcement .social-button{margin:.6rem 0 0 0;text-align:center}.card-announcement .social-button a{display:block;background-color:var(--btn-bg);color:var(--btn-color);text-align:center;line-height:2.4;margin:4px 0}.card-announcement .social-button a:hover{background-color:var(--btn-hover-color)}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">217</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">233</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">40</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> 精选文档</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/21cfbf15/"><span> 🚀 快速开始</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/dc584b87/"><span> 📑 主题页面</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4aa8abbe/"><span> 🛠 主题配置-1</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/ceeb73f/"><span> 🛠 主题配置-2</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/98d20436/"><span> ❓ 主题问答</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4073eda/"><span> ⚡️ 进阶教程</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/198a4240/"><span> ✨ 更新日志</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://butterfly.js.org/link/"><i class="fa-fw fas fa-thumbs-up"></i><span> 其他示例</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://t.mwm.moe/fj/')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">马哥私房菜</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> 精选文档</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/21cfbf15/"><span> 🚀 快速开始</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/dc584b87/"><span> 📑 主题页面</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4aa8abbe/"><span> 🛠 主题配置-1</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/ceeb73f/"><span> 🛠 主题配置-2</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/98d20436/"><span> ❓ 主题问答</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4073eda/"><span> ⚡️ 进阶教程</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/198a4240/"><span> ✨ 更新日志</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://butterfly.js.org/link/"><i class="fa-fw fas fa-thumbs-up"></i><span> 其他示例</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Golang学习之struct转json</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-11-14T06:06:32.000Z" title="发表于 2022-11-14 14:06:32">2022-11-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-11-14T06:06:32.000Z" title="更新于 2022-11-14 14:06:32">2022-11-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/golang/">golang</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Golang学习之struct转json"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="golang-结构体-struct-转-json-字符串"><a href="#golang-结构体-struct-转-json-字符串" class="headerlink" title="golang 结构体 struct 转 json 字符串"></a>golang 结构体 struct 转 json 字符串</h1><p><a target="_blank" rel="noopener" href="https://www.sohamkamani.com/golang/omitempty/">https://www.sohamkamani.com/golang/omitempty/</a></p>
<h1 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">type Dog struct &#123;</span><br><span class="line">	Breed string</span><br><span class="line">	WeightKg int</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	d := Dog&#123;</span><br><span class="line">		Breed:    &quot;dalmation&quot;,</span><br><span class="line">		WeightKg: 45,</span><br><span class="line">	&#125;</span><br><span class="line">	b, _ := json.Marshal(d)</span><br><span class="line">	fmt.Println(string(b))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;Breed&quot;:&quot;dalmation&quot;,&quot;WeightKg&quot;:45&#125;</span><br></pre></td></tr></table></figure>

<p>如果 去掉 结构体 中的 WeightKg 属性 又会如何呢？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">func main() &#123;</span><br><span class="line">	d := Dog&#123;</span><br><span class="line">		Breed:    &quot;pug&quot;,</span><br><span class="line">	&#125;</span><br><span class="line">	b, _ := json.Marshal(d)</span><br><span class="line">	fmt.Println(string(b))</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;Breed&quot;:&quot;pug&quot;,&quot;WeightKg&quot;:0&#125;,</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>WeightKg 是 0 了， 我们可能更希望 是 “WeightKg”:null, 或者 不要带上 这个属性了。</p>
<p>因为我们没给结构体中这个属性赋值，希望的结构就不要带上这个。</p>
<h1 id="omitempty-标签"><a href="#omitempty-标签" class="headerlink" title="omitempty 标签"></a>omitempty 标签</h1><p>这中情况 可以使用 omitempty  标签</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">type Dog struct &#123;</span><br><span class="line">	Breed    string</span><br><span class="line">	WeightKg int `json:&quot;,omitempty&quot;`</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	d := Dog&#123;</span><br><span class="line">		Breed: &quot;dalmation&quot;,</span><br><span class="line">	&#125;</span><br><span class="line">	b, _ := json.Marshal(d)</span><br><span class="line">	fmt.Println(string(b))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个时候 就会 输出 如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;Breed&quot;:&quot;dalmation&quot;&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Values-that-Cannot-Be-Omitted"><a href="#Values-that-Cannot-Be-Omitted" class="headerlink" title="Values that Cannot Be Omitted"></a>Values that Cannot Be Omitted</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">type dimension struct &#123;</span><br><span class="line">	Height int</span><br><span class="line">	Width int</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">type Dog struct &#123;</span><br><span class="line">	Breed    string</span><br><span class="line">	WeightKg int</span><br><span class="line">	Size dimension `json:&quot;,omitempty&quot;`</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	d := Dog&#123;</span><br><span class="line">		Breed: &quot;pug&quot;,</span><br><span class="line">	&#125;</span><br><span class="line">	b, _ := json.Marshal(d)</span><br><span class="line">	fmt.Println(string(b))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果 嵌套 一个 结构体，这时候 又出问题了，这样输出如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;Breed&quot;:&quot;pug&quot;,&quot;WeightKg&quot;:0,&quot;Size&quot;:&#123;&quot;Height&quot;:0,&quot;Width&quot;:0&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这个情况 我们没有给 Size 这个属性 赋值，但是 json 打印处理的 还是带上这个属性了，</p>
<p>解决方法是 使用 指针</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">type Dog struct &#123;</span><br><span class="line">	Breed    string</span><br><span class="line">	WeightKg int</span><br><span class="line">	// Now `Size` is a pointer to a `dimension` instance</span><br><span class="line">	Size *dimension `json:&quot;,omitempty&quot;`</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用指针之后 输出如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;Breed&quot;:&quot;pug&quot;,&quot;WeightKg&quot;:0&#125;</span><br></pre></td></tr></table></figure>



<h1 id="The-Difference-Between-0-“”-and-Nil"><a href="#The-Difference-Between-0-“”-and-Nil" class="headerlink" title="The Difference Between 0, “” and Nil"></a>The Difference Between 0, “” and Nil</h1><p>What would be the output of this code?</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">type Dog struct &#123;</span><br><span class="line">	Age *int `json:&quot;,omitempty&quot;`</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	age := 0</span><br><span class="line">	d := Dog&#123;</span><br><span class="line">		Age: &amp;age,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	b, _ := json.Marshal(d)</span><br><span class="line">	fmt.Println(string(b))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;&quot;Age&quot;:0&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">type Restaurant struct &#123;</span><br><span class="line">	NumberOfCustomers int `json:&quot;,omitempty&quot;`</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	d := Restaurant&#123;</span><br><span class="line">		NumberOfCustomers: 0,</span><br><span class="line">	&#125;</span><br><span class="line">	b, _ := json.Marshal(d)</span><br><span class="line">	fmt.Println(string(b))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">type Restaurant struct &#123;</span><br><span class="line">	NumberOfCustomers *int `json:&quot;,omitempty&quot;`</span><br><span class="line">&#125;</span><br><span class="line">func main() &#123;</span><br><span class="line">	d1 := Restaurant&#123;&#125;</span><br><span class="line">	b, _ := json.Marshal(d1)</span><br><span class="line">	fmt.Println(string(b))</span><br><span class="line">	//Prints: &#123;&#125;</span><br><span class="line">	</span><br><span class="line">	n := 0</span><br><span class="line">	d2 := Restaurant&#123;</span><br><span class="line">		NumberOfCustomers: &amp;n,</span><br><span class="line">	&#125;</span><br><span class="line">	b, _ = json.Marshal(d2)</span><br><span class="line">	fmt.Println(string(b))</span><br><span class="line">	//Prints: &#123;&quot;NumberOfCustomers&quot;:0&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;NumberOfCustomers&quot;:0&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="When-to-use-“omitempty”"><a href="#When-to-use-“omitempty”" class="headerlink" title="When to use “omitempty”"></a>When to use “omitempty”</h1><p>Although we’ve gone through the usage of omitempty, the most important thing to remember is that it should be used sparingly. If the application consuming the JSON objects generated by the Go application doesn’t differentiate between undefined keys and zero value keys, then there’s really no reason to use the omitempty tag in the first place.</p>
<p>If you do decide to use it, then make sure that Go’s definition of “empty” matches your application’s.</p>
<p>To learn how to work with JSON in Go in greater detail, you can read my other post on parsing JSON in Go.</p>
<p><a target="_blank" rel="noopener" href="https://www.sohamkamani.com/golang/json/">https://www.sohamkamani.com/golang/json/</a></p>
<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;bytes&quot;</span><br><span class="line">	&quot;encoding/json&quot;</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">	&quot;io&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func NewRequest(body interface&#123;&#125;) &#123;</span><br><span class="line">	var buf io.ReadWriter</span><br><span class="line">	if body != nil &#123;</span><br><span class="line">		buf = &amp;bytes.Buffer&#123;&#125;</span><br><span class="line">		enc := json.NewEncoder(buf)</span><br><span class="line">		enc.SetEscapeHTML(false)</span><br><span class="line">		err := enc.Encode(body)</span><br><span class="line">		if err != nil &#123;</span><br><span class="line">			fmt.Println(err)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type EditFortestRequest struct &#123;</span><br><span class="line">	Name        string `json:&quot;name,omitempty&quot;` </span><br><span class="line">	Path        string `json:&quot;path,omitempty&quot;` </span><br><span class="line">	Description string `json:&quot;description,omitempty&quot;`</span><br><span class="line">	Enable      bool   `json:&quot;enable,omitempty&quot;`</span><br><span class="line">	Age         int    `json:&quot;age,omitempty&quot;`</span><br><span class="line">&#125;</span><br><span class="line">type NewFortestRequest struct &#123;</span><br><span class="line">	Name        *string `json:&quot;name,omitempty&quot;`</span><br><span class="line">	Path        *string `json:&quot;path,omitempty&quot;` </span><br><span class="line">	Description *string `json:&quot;description,omitempty&quot;`</span><br><span class="line">	Enable      *bool   `json:&quot;enable,omitempty&quot;`</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func test1() &#123;</span><br><span class="line">	body := &amp;EditFortestRequest&#123;</span><br><span class="line">		Name: &quot;name &quot;,</span><br><span class="line">		Path: &quot;path &quot;,</span><br><span class="line">		Age: 0,</span><br><span class="line">	&#125;</span><br><span class="line">	NewRequest(body)</span><br><span class="line">&#125;</span><br><span class="line">func test2() &#123;</span><br><span class="line">	name := &quot;name pointer&quot;</span><br><span class="line">	path := &quot;path pointer&quot;</span><br><span class="line">	body := &amp;NewFortestRequest&#123;</span><br><span class="line">		Name: &amp;name,</span><br><span class="line">		Path: &amp;path,</span><br><span class="line">	&#125;</span><br><span class="line">	NewRequest(body)</span><br><span class="line">&#125;</span><br><span class="line">func main() &#123;</span><br><span class="line">	test1()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">body = &#123;interface &#123;&#125; | *main.EditRequest&#125;</span><br><span class="line">    Name = &#123;string&#125; &quot;name &quot;</span><br><span class="line">    Path = &#123;string&#125; &quot;path &quot;</span><br><span class="line">    Description = &#123;string&#125; &quot;&quot;</span><br><span class="line">    Enable = &#123;bool&#125; false</span><br><span class="line">    Age = &#123;int&#125; 0  // 不用指针这里 是 默认的 0值，没有传入呢 还是 使用者本身传的就是个0值呢，这样 转成json的时候是 没这个 age 属性的。</span><br><span class="line"></span><br><span class="line">&#123;&quot;name&quot;:&quot;name&quot;,&quot;path&quot;:&quot;path&quot;&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">body = &#123;interface &#123;&#125; | *main.NewFortestRequest&#125;</span><br><span class="line">    Name = &#123;*string | 0xc000116250&#125; &quot;name pointer&quot;</span><br><span class="line">    Path = &#123;*string | 0xc000116260&#125; &quot;path pointer&quot;</span><br><span class="line">    Description = &#123;*string&#125; nil</span><br><span class="line">    Enable = &#123;*bool&#125; nil</span><br><span class="line"></span><br><span class="line">&#123;&quot;name&quot;:&quot;name&quot;,&quot;path&quot;:&quot;path&quot;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">body = &#123;interface &#123;&#125; | *main.NewFortestRequest&#125;</span><br><span class="line">    Name = &#123;*string | 0xc000010270&#125; &quot;name pointer&quot;</span><br><span class="line">    Path = &#123;*string | 0xc000010280&#125; &quot;path pointer&quot;</span><br><span class="line">    Description = &#123;*string&#125; nil</span><br><span class="line">    Enable = &#123;*bool&#125; nil</span><br><span class="line">    Age = &#123;*int | 0xc00001e160&#125; 0  # 这个不是nil 表明使用者正式传入了这个 整数0值了。这样转换出来的 json 里面就有这个 属性</span><br><span class="line"></span><br><span class="line">&#123;&quot;name&quot;:&quot;name pointer&quot;,&quot;path&quot;:&quot;path pointer&quot;,&quot;age&quot;:0&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://magesfc.github.io">mage</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://magesfc.github.io/mage/6118b9bf91824574204e116d5b138ffbaab72268/">https://magesfc.github.io/mage/6118b9bf91824574204e116d5b138ffbaab72268/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://magesfc.github.io" target="_blank">马哥私房菜</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/golang/">golang</a><a class="post-meta__tags" href="/tags/struct/">struct</a><a class="post-meta__tags" href="/tags/json/">json</a></div><div class="post_share"><div class="social-share" data-image="https://t.mwm.moe/fj/" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="/null" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="/null" alt="支付寶"/></a><div class="post-qr-code-desc">支付寶</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/mage/c480dbde40d58e354795a1a408fdb8bad06fe7cc/"><img class="prev-cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Ansible自动化运维工具之role介绍</div></div></a></div><div class="next-post pull-right"><a href="/mage/f7b2ae126d593c93046cbf03febb201f10fef861/"><img class="next-cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Golang学习之类型转换</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/mage/f7b2ae126d593c93046cbf03febb201f10fef861/" title="Golang学习之类型转换"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-08</div><div class="title">Golang学习之类型转换</div></div></a></div><div><a href="/mage/18ccd178a6f3d405a26d5528e6f41f3b38eb6aa9/" title="Golang学习笔记总结"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">Golang学习笔记总结</div></div></a></div><div><a href="/mage/59738b29b03ec88e9f98548ab2d29fd5592d7c6d/" title="Golang学习之dlv断点调试"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-08</div><div class="title">Golang学习之dlv断点调试</div></div></a></div><div><a href="/mage/3b62171753fddbbf78c36e3f6d7c9ba008365560/" title="Golang学习之mtail"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-08</div><div class="title">Golang学习之mtail</div></div></a></div><div><a href="/mage/c2d4f359f2ad8b1560a3323b9940d7aee2b7aabc/" title="Golang的58个坑"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-02</div><div class="title">Golang的58个坑</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">mage</div><div class="author-info__description"> 这里是 马哥 的个人博客 </div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">217</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">233</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">40</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/mamh2021"><i class="fab fa-github"></i><span>GitHub</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/mamh2021" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#golang-%E7%BB%93%E6%9E%84%E4%BD%93-struct-%E8%BD%AC-json-%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">1.</span> <span class="toc-text">golang 结构体 struct 转 json 字符串</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="toc-number">2.</span> <span class="toc-text">基本用法</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#omitempty-%E6%A0%87%E7%AD%BE"><span class="toc-number">3.</span> <span class="toc-text">omitempty 标签</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Values-that-Cannot-Be-Omitted"><span class="toc-number">4.</span> <span class="toc-text">Values that Cannot Be Omitted</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#The-Difference-Between-0-%E2%80%9C%E2%80%9D-and-Nil"><span class="toc-number">5.</span> <span class="toc-text">The Difference Between 0, “” and Nil</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#When-to-use-%E2%80%9Comitempty%E2%80%9D"><span class="toc-number">6.</span> <span class="toc-text">When to use “omitempty”</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-number">7.</span> <span class="toc-text">其他</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/mage/ee6e53b9fbe2f10991d150675f0b88ed427b1150/" title="Android下的配置管理之道之repo-diffmanifests源码分析"><img src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android下的配置管理之道之repo-diffmanifests源码分析"/></a><div class="content"><a class="title" href="/mage/ee6e53b9fbe2f10991d150675f0b88ed427b1150/" title="Android下的配置管理之道之repo-diffmanifests源码分析">Android下的配置管理之道之repo-diffmanifests源码分析</a><time datetime="2024-05-18T03:58:53.000Z" title="更新于 2024-05-18 11:58:53">2024-05-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/a52bd2f9ab320c603de205368472b5caa19b7207/" title="Android下的配置管理之道之repo-sync源码分析"><img src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android下的配置管理之道之repo-sync源码分析"/></a><div class="content"><a class="title" href="/mage/a52bd2f9ab320c603de205368472b5caa19b7207/" title="Android下的配置管理之道之repo-sync源码分析">Android下的配置管理之道之repo-sync源码分析</a><time datetime="2024-05-18T02:15:08.000Z" title="更新于 2024-05-18 10:15:08">2024-05-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/0bd8125569ad5e0222f4ca4e90e626be2ee24c26/" title="Jenkins学习之DataBoundConstructor和DataBoundSetter"><img src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Jenkins学习之DataBoundConstructor和DataBoundSetter"/></a><div class="content"><a class="title" href="/mage/0bd8125569ad5e0222f4ca4e90e626be2ee24c26/" title="Jenkins学习之DataBoundConstructor和DataBoundSetter">Jenkins学习之DataBoundConstructor和DataBoundSetter</a><time datetime="2024-03-31T06:28:23.000Z" title="更新于 2024-03-31 14:28:23">2024-03-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/4b00a873b39948044a79c7e53eedd63d7af0bfa6/" title="Docker学习之安装docker-swarm集群"><img src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Docker学习之安装docker-swarm集群"/></a><div class="content"><a class="title" href="/mage/4b00a873b39948044a79c7e53eedd63d7af0bfa6/" title="Docker学习之安装docker-swarm集群">Docker学习之安装docker-swarm集群</a><time datetime="2024-03-31T06:28:19.000Z" title="更新于 2024-03-31 14:28:19">2024-03-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/44f033ce59a71a67f64e3c2e330151f82f8754f4/" title="Jenkins学习之master服务器安装使用docker安装"><img src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Jenkins学习之master服务器安装使用docker安装"/></a><div class="content"><a class="title" href="/mage/44f033ce59a71a67f64e3c2e330151f82f8754f4/" title="Jenkins学习之master服务器安装使用docker安装">Jenkins学习之master服务器安装使用docker安装</a><time datetime="2024-03-24T03:25:01.000Z" title="更新于 2024-03-24 11:25:01">2024-03-24</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://t.mwm.moe/fj/')"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By mage</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>