<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Ubuntu学习笔记之ubuntu加入Windows的AD域使用SSSD和Realm的方式 | 马哥私房菜</title><meta name="author" content="mage"><meta name="copyright" content="mage"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ubuntu加入Windows的AD域(使用SSSD和Realm的方式) Step 1: Initial Configurations to Join Ubuntu to Samba4 AD1.首先要修改好自己电脑的hostname，可以使用hostnamectl命令或者直接编辑&#x2F;etc&#x2F;hostname 文件 12345678910111213141516# hostname">
<meta property="og:type" content="article">
<meta property="og:title" content="Ubuntu学习笔记之ubuntu加入Windows的AD域使用SSSD和Realm的方式">
<meta property="og:url" content="https://magesfc.github.io/mage/faa877ef8e26557441db9099437ab98d161e5dbf/">
<meta property="og:site_name" content="马哥私房菜">
<meta property="og:description" content="ubuntu加入Windows的AD域(使用SSSD和Realm的方式) Step 1: Initial Configurations to Join Ubuntu to Samba4 AD1.首先要修改好自己电脑的hostname，可以使用hostnamectl命令或者直接编辑&#x2F;etc&#x2F;hostname 文件 12345678910111213141516# hostname">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg">
<meta property="article:published_time" content="2022-02-23T09:47:22.000Z">
<meta property="article:modified_time" content="2022-02-23T09:47:22.000Z">
<meta property="article:author" content="mage">
<meta property="article:tag" content="ubuntu">
<meta property="article:tag" content="windows">
<meta property="article:tag" content="ad">
<meta property="article:tag" content="sssd">
<meta property="article:tag" content="realm">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg"><link rel="shortcut icon" href="http://www.blackshark.com/favicon.ico"><link rel="canonical" href="https://magesfc.github.io/mage/faa877ef8e26557441db9099437ab98d161e5dbf/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":150,"languages":{"author":"作者: mage","link":"链接: ","source":"来源: 马哥私房菜","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Ubuntu学习笔记之ubuntu加入Windows的AD域使用SSSD和Realm的方式',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-02-23 17:47:22'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><style type="text/css">.card-announcement .social-button{margin:.6rem 0 0 0;text-align:center}.card-announcement .social-button a{display:block;background-color:var(--btn-bg);color:var(--btn-color);text-align:center;line-height:2.4;margin:4px 0}.card-announcement .social-button a:hover{background-color:var(--btn-hover-color)}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">161</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">180</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">34</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> 精选文档</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/21cfbf15/"><span> 🚀 快速开始</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/dc584b87/"><span> 📑 主题页面</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4aa8abbe/"><span> 🛠 主题配置-1</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/ceeb73f/"><span> 🛠 主题配置-2</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/98d20436/"><span> ❓ 主题问答</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4073eda/"><span> ⚡️ 进阶教程</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/198a4240/"><span> ✨ 更新日志</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://butterfly.js.org/link/"><i class="fa-fw fas fa-thumbs-up"></i><span> 其他示例</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">马哥私房菜</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> 精选文档</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/21cfbf15/"><span> 🚀 快速开始</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/dc584b87/"><span> 📑 主题页面</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4aa8abbe/"><span> 🛠 主题配置-1</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/ceeb73f/"><span> 🛠 主题配置-2</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/98d20436/"><span> ❓ 主题问答</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4073eda/"><span> ⚡️ 进阶教程</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/198a4240/"><span> ✨ 更新日志</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://butterfly.js.org/link/"><i class="fa-fw fas fa-thumbs-up"></i><span> 其他示例</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Ubuntu学习笔记之ubuntu加入Windows的AD域使用SSSD和Realm的方式</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-02-23T09:47:22.000Z" title="发表于 2022-02-23 17:47:22">2022-02-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-02-23T09:47:22.000Z" title="更新于 2022-02-23 17:47:22">2022-02-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ubuntu/">ubuntu</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Ubuntu学习笔记之ubuntu加入Windows的AD域使用SSSD和Realm的方式"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>ubuntu加入Windows的AD域(使用SSSD和Realm的方式)</p>
<h1 id="Step-1-Initial-Configurations-to-Join-Ubuntu-to-Samba4-AD"><a href="#Step-1-Initial-Configurations-to-Join-Ubuntu-to-Samba4-AD" class="headerlink" title="Step 1: Initial Configurations to Join Ubuntu to Samba4 AD"></a>Step 1: Initial Configurations to Join Ubuntu to Samba4 AD</h1><p>1.首先要修改好自己电脑的hostname，可以使用hostnamectl命令或者直接编辑&#x2F;etc&#x2F;hostname 文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># hostnamectl set-hostname your_machine_short_name</span><br><span class="line"></span><br><span class="line">$ cat /etc/hostname  </span><br><span class="line">mamh-PC</span><br><span class="line"></span><br><span class="line">$ hostnamectl                           </span><br><span class="line">   Static hostname: mamh-PC</span><br><span class="line">         Icon name: computer-desktop</span><br><span class="line">           Chassis: desktop</span><br><span class="line">        Machine ID: 4165ee77f3a840b880478065c5624a98</span><br><span class="line">           Boot ID: 0b179497ee0a4ffdb5d5a1a288693fa9</span><br><span class="line">  Operating System: Ubuntu 16.04.6 LTS</span><br><span class="line">            Kernel: Linux 4.18.0-15-generic</span><br><span class="line">      Architecture: x86-64</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>2.然后一个重要的步骤是设置好ip。尤其是DNS 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<p>3.最后是重启网络，或者重启电脑。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart networking.service</span><br><span class="line"></span><br><span class="line">ping -c2 your_domain_name</span><br></pre></td></tr></table></figure>
<p>4.最后一个步骤是安装时间同步服务器ntpdate</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install ntpdate</span><br><span class="line">$ sudo ntpdate -q your_domain_name</span><br><span class="line">$ sudo ntpdate your_domain_name</span><br></pre></td></tr></table></figure>


<p>Step 2: 安装需要的软件</p>
<p>5.这一步安装Realmd and SSSD 相关的软件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install adcli realmd krb5-user samba-common-bin samba-libs samba-dsdb-modules sssd sssd-tools libnss-sss libpam-sss packagekit policykit-1 </span><br><span class="line"></span><br><span class="line">$ sudo apt-get install samba # 如果需要samba共享目录给Windows。需要安装这个</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">root@bf-pc04:~# echo &#x27;apt-get install adcli realmd krb5-user samba-common-bin samba-libs samba-dsdb-modules sssd sssd-tools libnss-sss libpam-sss packagekit policykit-1 &#x27;&gt;install.sh</span><br><span class="line">root@bf-pc04:~# chmod 755 install.sh </span><br><span class="line">root@bf-pc04:~# ls</span><br><span class="line">install.sh</span><br><span class="line">root@bf-pc04:~# cat install.sh </span><br><span class="line">apt-get install adcli realmd krb5-user \</span><br><span class="line">samba-common-bin samba-libs samba-dsdb-modules \</span><br><span class="line">sssd sssd-tools libnss-sss libpam-sss packagekit policykit-1 </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br></pre></td><td class="code"><pre><span class="line">#开始安装需要的软件</span><br><span class="line">root@bf-pc04:~# ./install.sh </span><br><span class="line">正在读取软件包列表... 完成</span><br><span class="line">正在分析软件包的依赖关系树       </span><br><span class="line">正在读取状态信息... 完成       </span><br><span class="line">将会安装下列额外的软件包：</span><br><span class="line">  cracklib-runtime gdebi-core krb5-config ldap-utils libarchive13</span><br><span class="line">  libavahi-client3 libavahi-common-data libavahi-common3 libbasicobjects0</span><br><span class="line">  libc-ares2 libcollection2 libcrack2 libcups2 libdhash1 libelfg0 libglib2.0-0</span><br><span class="line">  libglib2.0-bin libgmp10 libgssapi-krb5-2 libgssrpc4 libgstreamer1.0-0</span><br><span class="line">  libini-config3 libipa-hbac0 libkadm5clnt-mit9 libkadm5srv-mit9 libkdb5-7</span><br><span class="line">  libkrb5-3 libkrb5support0 libldap-2.4-2 libldb1 liblzo2-2 libnettle4</span><br><span class="line">  libnl-3-200 libnl-genl-3-200 libnl-route-3-200 libnspr4 libnss3</span><br><span class="line">  libnss3-nssdb libpackagekit-glib2-16 libpam-pwquality libpath-utils1</span><br><span class="line">  libpwquality-common libpwquality1 libref-array1 libsasl2-modules-gssapi-mit</span><br><span class="line">  libsss-idmap0 libsss-sudo libsystemd-journal0 libtalloc2 libtdb1 libtevent0</span><br><span class="line">  libwbclient0 packagekit-backend-aptcc packagekit-tools python-crypto</span><br><span class="line">  python-ldb python-samba python-sss python-talloc python-tdb python3-chardet</span><br><span class="line">  python3-debian python3-packagekit python3-pkg-resources python3-six</span><br><span class="line">  samba-common sssd-ad sssd-ad-common sssd-common sssd-ipa sssd-krb5</span><br><span class="line">  sssd-krb5-common sssd-ldap sssd-proxy wamerican</span><br><span class="line">建议安装的软件包：</span><br><span class="line">  lrzip cups-common krb5-doc gstreamer1.0-tools gstreamer1.0-plugins-base</span><br><span class="line">  packagekit-backend-smart python-crypto-dbg python-crypto-doc</span><br><span class="line">  python3-setuptools heimdal-clients libsasl2-modules-ldap</span><br><span class="line">下列【新】软件包将被安装：</span><br><span class="line">  adcli cracklib-runtime gdebi-core krb5-config krb5-user ldap-utils</span><br><span class="line">  libarchive13 libavahi-client3 libavahi-common-data libavahi-common3</span><br><span class="line">  libbasicobjects0 libc-ares2 libcollection2 libcrack2 libcups2 libdhash1</span><br><span class="line">  libelfg0 libglib2.0-bin libgmp10 libgssrpc4 libgstreamer1.0-0 libini-config3</span><br><span class="line">  libipa-hbac0 libkadm5clnt-mit9 libkadm5srv-mit9 libkdb5-7 libldb1 liblzo2-2</span><br><span class="line">  libnettle4 libnl-route-3-200 libnspr4 libnss-sss libnss3 libnss3-nssdb</span><br><span class="line">  libpackagekit-glib2-16 libpam-pwquality libpam-sss libpath-utils1</span><br><span class="line">  libpwquality-common libpwquality1 libref-array1 libsasl2-modules-gssapi-mit</span><br><span class="line">  libsss-idmap0 libsss-sudo libsystemd-journal0 libtalloc2 libtdb1 libtevent0</span><br><span class="line">  libwbclient0 packagekit packagekit-backend-aptcc packagekit-tools</span><br><span class="line">  python-crypto python-ldb python-samba python-sss python-talloc python-tdb</span><br><span class="line">  python3-chardet python3-debian python3-packagekit python3-pkg-resources</span><br><span class="line">  python3-six realmd samba-common samba-common-bin samba-dsdb-modules</span><br><span class="line">  samba-libs sssd sssd-ad sssd-ad-common sssd-common sssd-ipa sssd-krb5</span><br><span class="line">  sssd-krb5-common sssd-ldap sssd-proxy sssd-tools wamerican</span><br><span class="line">下列软件包将被升级：</span><br><span class="line">  libglib2.0-0 libgssapi-krb5-2 libkrb5-3 libkrb5support0 libldap-2.4-2</span><br><span class="line">  libnl-3-200 libnl-genl-3-200 policykit-1</span><br><span class="line">升级了 8 个软件包，新安装了 79 个软件包，要卸载 0 个软件包，有 174 个软件包未被升级。</span><br><span class="line">需要下载 15.3 MB 的软件包。</span><br><span class="line">解压缩后会消耗掉 63.2 MB 的额外空间。</span><br><span class="line">您希望继续执行吗？ [Y/n] y</span><br><span class="line">获取：1 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libglib2.0-0 amd64 2.40.2-0ubuntu1.1 [1,059 kB]</span><br><span class="line">获取：2 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libgssapi-krb5-2 amd64 1.12+dfsg-2ubuntu5.4 [114 kB]</span><br><span class="line">获取：3 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libkrb5-3 amd64 1.12+dfsg-2ubuntu5.4 [262 kB]</span><br><span class="line">获取：4 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libkrb5support0 amd64 1.12+dfsg-2ubuntu5.4 [31.1 kB]</span><br><span class="line">获取：5 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libldap-2.4-2 amd64 2.4.31-1+nmu2ubuntu8.5 [153 kB]</span><br><span class="line">获取：6 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main liblzo2-2 amd64 2.06-1.2ubuntu1.1 [46.1 kB]</span><br><span class="line">获取：7 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libnettle4 amd64 2.7.1-1ubuntu0.2 [102 kB]</span><br><span class="line">获取：8 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libarchive13 amd64 3.1.2-7ubuntu2.8 [262 kB]</span><br><span class="line">获取：9 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libavahi-common-data amd64 0.6.31-4ubuntu1.3 [21.1 kB]</span><br><span class="line">获取：10 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libavahi-common3 amd64 0.6.31-4ubuntu1.3 [21.7 kB]</span><br><span class="line">获取：11 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libavahi-client3 amd64 0.6.31-4ubuntu1.3 [25.2 kB]</span><br><span class="line">获取：12 http://cn.archive.ubuntu.com/ubuntu/ trusty/main libcrack2 amd64 2.9.1-1build1 [27.2 kB]</span><br><span class="line">获取：13 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libcups2 amd64 1.7.2-0ubuntu1.11 [178 kB]</span><br><span class="line">获取：14 http://cn.archive.ubuntu.com/ubuntu/ trusty/main libelfg0 amd64 0.8.13-5 [37.6 kB]</span><br><span class="line">获取：15 http://cn.archive.ubuntu.com/ubuntu/ trusty/main libgmp10 amd64 2:5.1.3+dfsg-1ubuntu1 [218 kB]</span><br><span class="line">获取：16 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libgssrpc4 amd64 1.12+dfsg-2ubuntu5.4 [53.1 kB]</span><br><span class="line">获取：17 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libgstreamer1.0-0 amd64 1.2.4-0ubuntu1.1 [598 kB]</span><br><span class="line">获取：18 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libkadm5clnt-mit9 amd64 1.12+dfsg-2ubuntu5.4 [36.2 kB]</span><br><span class="line">获取：19 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libkdb5-7 amd64 1.12+dfsg-2ubuntu5.4 [36.2 kB]</span><br><span class="line">获取：20 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libkadm5srv-mit9 amd64 1.12+dfsg-2ubuntu5.4 [50.3 kB]</span><br><span class="line">获取：21 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libtalloc2 amd64 2.1.5-0ubuntu0.14.04.1 [28.6 kB]</span><br><span class="line">获取：22 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libtdb1 amd64 1.3.8-0ubuntu0.14.04.1 [38.3 kB]</span><br><span class="line">获取：23 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libtevent0 amd64 0.9.28-0ubuntu0.14.04.1 [26.2 kB]</span><br><span class="line">获取：24 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libldb1 amd64 1:1.1.24-0ubuntu0.14.04.2 [107 kB]</span><br><span class="line">获取：25 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libnl-genl-3-200 amd64 3.2.21-1ubuntu4.1 [10.2 kB]</span><br><span class="line">获取：26 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libnl-3-200 amd64 3.2.21-1ubuntu4.1 [45.3 kB]</span><br><span class="line">获取：27 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libnl-route-3-200 amd64 3.2.21-1ubuntu4.1 [96.2 kB]</span><br><span class="line">获取：28 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libnspr4 amd64 2:4.13.1-0ubuntu0.14.04.1 [110 kB]</span><br><span class="line">获取：29 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libnss3-nssdb all 2:3.28.4-0ubuntu0.14.04.5 [10.6 kB]</span><br><span class="line">获取：30 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libnss3 amd64 2:3.28.4-0ubuntu0.14.04.5 [1,124 kB]</span><br><span class="line">获取：31 http://cn.archive.ubuntu.com/ubuntu/ trusty/main libpackagekit-glib2-16 amd64 0.8.12-1ubuntu5 [102 kB]</span><br><span class="line">获取：32 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libpwquality-common all 1.2.3-1ubuntu1.1 [5,400 B]</span><br><span class="line">获取：33 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libpwquality1 amd64 1.2.3-1ubuntu1.1 [11.7 kB]</span><br><span class="line">获取：34 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libpam-pwquality amd64 1.2.3-1ubuntu1.1 [9,952 B]</span><br><span class="line">获取：35 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libwbclient0 amd64 2:4.3.11+dfsg-0ubuntu0.14.04.20 [30.3 kB]</span><br><span class="line">获取：36 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main python-ldb amd64 1:1.1.24-0ubuntu0.14.04.2 [29.0 kB]</span><br><span class="line">获取：37 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main python-talloc amd64 2.1.5-0ubuntu0.14.04.1 [7,628 B]</span><br><span class="line">获取：38 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main samba-common all 2:4.3.11+dfsg-0ubuntu0.14.04.20 [84.1 kB]</span><br><span class="line">获取：39 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main samba-libs amd64 2:4.3.11+dfsg-0ubuntu0.14.04.20 [5,129 kB]</span><br><span class="line">获取：40 http://cn.archive.ubuntu.com/ubuntu/ trusty/main libbasicobjects0 amd64 0.3.0.1-4 [5,628 B]</span><br><span class="line">获取：41 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libc-ares2 amd64 1.10.0-2ubuntu0.2 [34.1 kB]</span><br><span class="line">获取：42 http://cn.archive.ubuntu.com/ubuntu/ trusty/main libcollection2 amd64 0.3.0.1-4 [20.2 kB]</span><br><span class="line">获取：43 http://cn.archive.ubuntu.com/ubuntu/ trusty/main libdhash1 amd64 0.3.0.1-4 [8,442 B]</span><br><span class="line">获取：44 http://cn.archive.ubuntu.com/ubuntu/ trusty/main libpath-utils1 amd64 0.3.0.1-4 [8,410 B]</span><br><span class="line">获取：45 http://cn.archive.ubuntu.com/ubuntu/ trusty/main libref-array1 amd64 0.3.0.1-4 [7,072 B]</span><br><span class="line">获取：46 http://cn.archive.ubuntu.com/ubuntu/ trusty/main libini-config3 amd64 0.3.0.1-4 [27.9 kB]</span><br><span class="line">获取：47 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libnss-sss amd64 1.11.8-0ubuntu0.7 [18.3 kB]</span><br><span class="line">获取：48 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libsystemd-journal0 amd64 204-5ubuntu20.31 [50.5 kB]</span><br><span class="line">获取：49 http://cn.archive.ubuntu.com/ubuntu/ trusty/main libsasl2-modules-gssapi-mit amd64 2.1.25.dfsg1-17build1 [47.4 kB]</span><br><span class="line">获取：50 http://cn.archive.ubuntu.com/ubuntu/ trusty/universe adcli amd64 0.7.5-1 [59.4 kB]</span><br><span class="line">获取：51 http://cn.archive.ubuntu.com/ubuntu/ trusty/main cracklib-runtime amd64 2.9.1-1build1 [138 kB]</span><br><span class="line">获取：52 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main python3-pkg-resources all 3.3-1ubuntu2 [31.7 kB]</span><br><span class="line">获取：53 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main python3-chardet all 2.2.1-2~ubuntu1 [96.5 kB]</span><br><span class="line">获取：54 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main python3-six all 1.5.2-1ubuntu1.1 [8,438 B]</span><br><span class="line">获取：55 http://cn.archive.ubuntu.com/ubuntu/ trusty/main python3-debian all 0.1.21+nmu2ubuntu2 [34.9 kB]</span><br><span class="line">获取：56 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main gdebi-core all 0.9.5.3ubuntu3 [9,518 B]</span><br><span class="line">获取：57 http://cn.archive.ubuntu.com/ubuntu/ trusty/main krb5-config all 2.3 [23.4 kB]</span><br><span class="line">获取：58 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/universe krb5-user amd64 1.12+dfsg-2ubuntu5.4 [96.6 kB]</span><br><span class="line">获取：59 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main ldap-utils amd64 2.4.31-1+nmu2ubuntu8.5 [122 kB]</span><br><span class="line">获取：60 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libglib2.0-bin amd64 2.40.2-0ubuntu1.1 [34.9 kB]</span><br><span class="line">获取：61 http://cn.archive.ubuntu.com/ubuntu/ trusty/main python3-packagekit all 0.8.12-1ubuntu5 [17.9 kB]</span><br><span class="line">获取：62 http://cn.archive.ubuntu.com/ubuntu/ trusty/main packagekit-backend-aptcc amd64 0.8.12-1ubuntu5 [97.2 kB]</span><br><span class="line">获取：63 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main policykit-1 amd64 0.105-4ubuntu3.14.04.6 [51.9 kB]</span><br><span class="line">获取：64 http://cn.archive.ubuntu.com/ubuntu/ trusty/main packagekit amd64 0.8.12-1ubuntu5 [269 kB]</span><br><span class="line">获取：65 http://cn.archive.ubuntu.com/ubuntu/ trusty/main packagekit-tools amd64 0.8.12-1ubuntu5 [46.2 kB]</span><br><span class="line">获取：66 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main python-crypto amd64 2.6.1-4ubuntu0.3 [239 kB]</span><br><span class="line">获取：67 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main python-tdb amd64 1.3.8-0ubuntu0.14.04.1 [10.8 kB]</span><br><span class="line">获取：68 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main python-samba amd64 2:4.3.11+dfsg-0ubuntu0.14.04.20 [1,070 kB]</span><br><span class="line">获取：69 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/universe realmd amd64 0.15.0-1ubuntu0.1 [173 kB]</span><br><span class="line">获取：70 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main samba-common-bin amd64 2:4.3.11+dfsg-0ubuntu0.14.04.20 [508 kB]</span><br><span class="line">获取：71 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main samba-dsdb-modules amd64 2:4.3.11+dfsg-0ubuntu0.14.04.20 [219 kB]</span><br><span class="line">获取：72 http://cn.archive.ubuntu.com/ubuntu/ trusty/main wamerican all 7.1-1 [269 kB]</span><br><span class="line">获取：73 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libipa-hbac0 amd64 1.11.8-0ubuntu0.7 [8,836 B]</span><br><span class="line">获取：74 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libpam-sss amd64 1.11.8-0ubuntu0.7 [20.2 kB]</span><br><span class="line">获取：75 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libsss-idmap0 amd64 1.11.8-0ubuntu0.7 [13.4 kB]</span><br><span class="line">获取：76 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main libsss-sudo amd64 1.11.8-0ubuntu0.7 [13.1 kB]</span><br><span class="line">获取：77 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main python-sss amd64 1.11.8-0ubuntu0.7 [47.2 kB]</span><br><span class="line">获取：78 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main sssd-common amd64 1.11.8-0ubuntu0.7 [525 kB]</span><br><span class="line">获取：79 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main sssd-ad-common amd64 1.11.8-0ubuntu0.7 [34.2 kB]</span><br><span class="line">获取：80 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main sssd-krb5-common amd64 1.11.8-0ubuntu0.7 [72.1 kB]</span><br><span class="line">获取：81 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main sssd-ad amd64 1.11.8-0ubuntu0.7 [56.2 kB]</span><br><span class="line">获取：82 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main sssd-ipa amd64 1.11.8-0ubuntu0.7 [101 kB]</span><br><span class="line">获取：83 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main sssd-krb5 amd64 1.11.8-0ubuntu0.7 [19.3 kB]</span><br><span class="line">获取：84 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main sssd-ldap amd64 1.11.8-0ubuntu0.7 [48.9 kB]</span><br><span class="line">获取：85 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main sssd-proxy amd64 1.11.8-0ubuntu0.7 [30.0 kB]</span><br><span class="line">获取：86 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main sssd amd64 1.11.8-0ubuntu0.7 [4,138 B]</span><br><span class="line">获取：87 http://cn.archive.ubuntu.com/ubuntu/ trusty-updates/main sssd-tools amd64 1.11.8-0ubuntu0.7 [101 kB]</span><br><span class="line">下载 15.3 MB，耗时 38秒 (397 kB/s)                                             </span><br><span class="line">正在从软件包中解出模板：100%</span><br><span class="line">正在预设定软件包 ...</span><br><span class="line">(正在读取数据库 ... 系统当前共安装有 58989 个文件和目录。)</span><br><span class="line">正准备解包 .../libglib2.0-0_2.40.2-0ubuntu1.1_amd64.deb  ...</span><br><span class="line">正在将 libglib2.0-0:amd64 (2.40.2-0ubuntu1.1) 解包到 (2.40.2-0ubuntu1) 上 ...</span><br><span class="line">正准备解包 .../libgssapi-krb5-2_1.12+dfsg-2ubuntu5.4_amd64.deb  ...</span><br><span class="line">正在将 libgssapi-krb5-2:amd64 (1.12+dfsg-2ubuntu5.4) 解包到 (1.12+dfsg-2ubuntu5.2) 上 ...</span><br><span class="line">正准备解包 .../libkrb5-3_1.12+dfsg-2ubuntu5.4_amd64.deb  ...</span><br><span class="line">正在将 libkrb5-3:amd64 (1.12+dfsg-2ubuntu5.4) 解包到 (1.12+dfsg-2ubuntu5.2) 上 ...</span><br><span class="line">正准备解包 .../libkrb5support0_1.12+dfsg-2ubuntu5.4_amd64.deb  ...</span><br><span class="line">正在将 libkrb5support0:amd64 (1.12+dfsg-2ubuntu5.4) 解包到 (1.12+dfsg-2ubuntu5.2) 上 ...</span><br><span class="line">正准备解包 .../libldap-2.4-2_2.4.31-1+nmu2ubuntu8.5_amd64.deb  ...</span><br><span class="line">正在将 libldap-2.4-2:amd64 (2.4.31-1+nmu2ubuntu8.5) 解包到 (2.4.31-1+nmu2ubuntu8.3) 上 ...</span><br><span class="line">正在选中未选择的软件包 liblzo2-2:amd64。</span><br><span class="line">正准备解包 .../liblzo2-2_2.06-1.2ubuntu1.1_amd64.deb  ...</span><br><span class="line">正在解包 liblzo2-2:amd64 (2.06-1.2ubuntu1.1) ...</span><br><span class="line">正在选中未选择的软件包 libnettle4:amd64。</span><br><span class="line">正准备解包 .../libnettle4_2.7.1-1ubuntu0.2_amd64.deb  ...</span><br><span class="line">正在解包 libnettle4:amd64 (2.7.1-1ubuntu0.2) ...</span><br><span class="line">正在选中未选择的软件包 libarchive13:amd64。</span><br><span class="line">正准备解包 .../libarchive13_3.1.2-7ubuntu2.8_amd64.deb  ...</span><br><span class="line">正在解包 libarchive13:amd64 (3.1.2-7ubuntu2.8) ...</span><br><span class="line">正在选中未选择的软件包 libavahi-common-data:amd64。</span><br><span class="line">正准备解包 .../libavahi-common-data_0.6.31-4ubuntu1.3_amd64.deb  ...</span><br><span class="line">正在解包 libavahi-common-data:amd64 (0.6.31-4ubuntu1.3) ...</span><br><span class="line">正在选中未选择的软件包 libavahi-common3:amd64。</span><br><span class="line">正准备解包 .../libavahi-common3_0.6.31-4ubuntu1.3_amd64.deb  ...</span><br><span class="line">正在解包 libavahi-common3:amd64 (0.6.31-4ubuntu1.3) ...</span><br><span class="line">正在选中未选择的软件包 libavahi-client3:amd64。</span><br><span class="line">正准备解包 .../libavahi-client3_0.6.31-4ubuntu1.3_amd64.deb  ...</span><br><span class="line">正在解包 libavahi-client3:amd64 (0.6.31-4ubuntu1.3) ...</span><br><span class="line">正在选中未选择的软件包 libcrack2:amd64。</span><br><span class="line">正准备解包 .../libcrack2_2.9.1-1build1_amd64.deb  ...</span><br><span class="line">正在解包 libcrack2:amd64 (2.9.1-1build1) ...</span><br><span class="line">正在选中未选择的软件包 libcups2:amd64。</span><br><span class="line">正准备解包 .../libcups2_1.7.2-0ubuntu1.11_amd64.deb  ...</span><br><span class="line">正在解包 libcups2:amd64 (1.7.2-0ubuntu1.11) ...</span><br><span class="line">正在选中未选择的软件包 libelfg0:amd64。</span><br><span class="line">正准备解包 .../libelfg0_0.8.13-5_amd64.deb  ...</span><br><span class="line">正在解包 libelfg0:amd64 (0.8.13-5) ...</span><br><span class="line">正在选中未选择的软件包 libgmp10:amd64。</span><br><span class="line">正准备解包 .../libgmp10_2%3a5.1.3+dfsg-1ubuntu1_amd64.deb  ...</span><br><span class="line">正在解包 libgmp10:amd64 (2:5.1.3+dfsg-1ubuntu1) ...</span><br><span class="line">正在选中未选择的软件包 libgssrpc4:amd64。</span><br><span class="line">正准备解包 .../libgssrpc4_1.12+dfsg-2ubuntu5.4_amd64.deb  ...</span><br><span class="line">正在解包 libgssrpc4:amd64 (1.12+dfsg-2ubuntu5.4) ...</span><br><span class="line">正在选中未选择的软件包 libgstreamer1.0-0:amd64。</span><br><span class="line">正准备解包 .../libgstreamer1.0-0_1.2.4-0ubuntu1.1_amd64.deb  ...</span><br><span class="line">正在解包 libgstreamer1.0-0:amd64 (1.2.4-0ubuntu1.1) ...</span><br><span class="line">正在选中未选择的软件包 libkadm5clnt-mit9:amd64。</span><br><span class="line">正准备解包 .../libkadm5clnt-mit9_1.12+dfsg-2ubuntu5.4_amd64.deb  ...</span><br><span class="line">正在解包 libkadm5clnt-mit9:amd64 (1.12+dfsg-2ubuntu5.4) ...</span><br><span class="line">正在选中未选择的软件包 libkdb5-7:amd64。</span><br><span class="line">正准备解包 .../libkdb5-7_1.12+dfsg-2ubuntu5.4_amd64.deb  ...</span><br><span class="line">正在解包 libkdb5-7:amd64 (1.12+dfsg-2ubuntu5.4) ...</span><br><span class="line">正在选中未选择的软件包 libkadm5srv-mit9:amd64。</span><br><span class="line">正准备解包 .../libkadm5srv-mit9_1.12+dfsg-2ubuntu5.4_amd64.deb  ...</span><br><span class="line">正在解包 libkadm5srv-mit9:amd64 (1.12+dfsg-2ubuntu5.4) ...</span><br><span class="line">正在选中未选择的软件包 libtalloc2:amd64。</span><br><span class="line">正准备解包 .../libtalloc2_2.1.5-0ubuntu0.14.04.1_amd64.deb  ...</span><br><span class="line">正在解包 libtalloc2:amd64 (2.1.5-0ubuntu0.14.04.1) ...</span><br><span class="line">正在选中未选择的软件包 libtdb1:amd64。</span><br><span class="line">正准备解包 .../libtdb1_1.3.8-0ubuntu0.14.04.1_amd64.deb  ...</span><br><span class="line">正在解包 libtdb1:amd64 (1.3.8-0ubuntu0.14.04.1) ...</span><br><span class="line">正在选中未选择的软件包 libtevent0:amd64。</span><br><span class="line">正准备解包 .../libtevent0_0.9.28-0ubuntu0.14.04.1_amd64.deb  ...</span><br><span class="line">正在解包 libtevent0:amd64 (0.9.28-0ubuntu0.14.04.1) ...</span><br><span class="line">正在选中未选择的软件包 libldb1:amd64。</span><br><span class="line">正准备解包 .../libldb1_1%3a1.1.24-0ubuntu0.14.04.2_amd64.deb  ...</span><br><span class="line">正在解包 libldb1:amd64 (1:1.1.24-0ubuntu0.14.04.2) ...</span><br><span class="line">正准备解包 .../libnl-genl-3-200_3.2.21-1ubuntu4.1_amd64.deb  ...</span><br><span class="line">正在将 libnl-genl-3-200:amd64 (3.2.21-1ubuntu4.1) 解包到 (3.2.21-1ubuntu3) 上 ...</span><br><span class="line">正准备解包 .../libnl-3-200_3.2.21-1ubuntu4.1_amd64.deb  ...</span><br><span class="line">正在将 libnl-3-200:amd64 (3.2.21-1ubuntu4.1) 解包到 (3.2.21-1ubuntu3) 上 ...</span><br><span class="line">正在选中未选择的软件包 libnl-route-3-200:amd64。</span><br><span class="line">正准备解包 .../libnl-route-3-200_3.2.21-1ubuntu4.1_amd64.deb  ...</span><br><span class="line">正在解包 libnl-route-3-200:amd64 (3.2.21-1ubuntu4.1) ...</span><br><span class="line">正在选中未选择的软件包 libnspr4:amd64。</span><br><span class="line">正准备解包 .../libnspr4_2%3a4.13.1-0ubuntu0.14.04.1_amd64.deb  ...</span><br><span class="line">正在解包 libnspr4:amd64 (2:4.13.1-0ubuntu0.14.04.1) ...</span><br><span class="line">正在选中未选择的软件包 libnss3-nssdb。</span><br><span class="line">正准备解包 .../libnss3-nssdb_2%3a3.28.4-0ubuntu0.14.04.5_all.deb  ...</span><br><span class="line">正在解包 libnss3-nssdb (2:3.28.4-0ubuntu0.14.04.5) ...</span><br><span class="line">正在选中未选择的软件包 libnss3:amd64。</span><br><span class="line">正准备解包 .../libnss3_2%3a3.28.4-0ubuntu0.14.04.5_amd64.deb  ...</span><br><span class="line">正在解包 libnss3:amd64 (2:3.28.4-0ubuntu0.14.04.5) ...</span><br><span class="line">正在选中未选择的软件包 libpackagekit-glib2-16:amd64。</span><br><span class="line">正准备解包 .../libpackagekit-glib2-16_0.8.12-1ubuntu5_amd64.deb  ...</span><br><span class="line">正在解包 libpackagekit-glib2-16:amd64 (0.8.12-1ubuntu5) ...</span><br><span class="line">正在选中未选择的软件包 libpwquality-common。</span><br><span class="line">正准备解包 .../libpwquality-common_1.2.3-1ubuntu1.1_all.deb  ...</span><br><span class="line">正在解包 libpwquality-common (1.2.3-1ubuntu1.1) ...</span><br><span class="line">正在选中未选择的软件包 libpwquality1:amd64。</span><br><span class="line">正准备解包 .../libpwquality1_1.2.3-1ubuntu1.1_amd64.deb  ...</span><br><span class="line">正在解包 libpwquality1:amd64 (1.2.3-1ubuntu1.1) ...</span><br><span class="line">正在选中未选择的软件包 libpam-pwquality:amd64。</span><br><span class="line">正准备解包 .../libpam-pwquality_1.2.3-1ubuntu1.1_amd64.deb  ...</span><br><span class="line">正在解包 libpam-pwquality:amd64 (1.2.3-1ubuntu1.1) ...</span><br><span class="line">正在选中未选择的软件包 libwbclient0:amd64。</span><br><span class="line">正准备解包 .../libwbclient0_2%3a4.3.11+dfsg-0ubuntu0.14.04.20_amd64.deb  ...</span><br><span class="line">正在解包 libwbclient0:amd64 (2:4.3.11+dfsg-0ubuntu0.14.04.20) ...</span><br><span class="line">正在选中未选择的软件包 python-ldb。</span><br><span class="line">正准备解包 .../python-ldb_1%3a1.1.24-0ubuntu0.14.04.2_amd64.deb  ...</span><br><span class="line">正在解包 python-ldb (1:1.1.24-0ubuntu0.14.04.2) ...</span><br><span class="line">正在选中未选择的软件包 python-talloc。</span><br><span class="line">正准备解包 .../python-talloc_2.1.5-0ubuntu0.14.04.1_amd64.deb  ...</span><br><span class="line">正在解包 python-talloc (2.1.5-0ubuntu0.14.04.1) ...</span><br><span class="line">正在选中未选择的软件包 samba-common。</span><br><span class="line">正准备解包 .../samba-common_2%3a4.3.11+dfsg-0ubuntu0.14.04.20_all.deb  ...</span><br><span class="line">正在解包 samba-common (2:4.3.11+dfsg-0ubuntu0.14.04.20) ...</span><br><span class="line">正在选中未选择的软件包 samba-libs:amd64。</span><br><span class="line">正准备解包 .../samba-libs_2%3a4.3.11+dfsg-0ubuntu0.14.04.20_amd64.deb  ...</span><br><span class="line">正在解包 samba-libs:amd64 (2:4.3.11+dfsg-0ubuntu0.14.04.20) ...</span><br><span class="line">正在选中未选择的软件包 libbasicobjects0:amd64。</span><br><span class="line">正准备解包 .../libbasicobjects0_0.3.0.1-4_amd64.deb  ...</span><br><span class="line">正在解包 libbasicobjects0:amd64 (0.3.0.1-4) ...</span><br><span class="line">正在选中未选择的软件包 libc-ares2:amd64。</span><br><span class="line">正准备解包 .../libc-ares2_1.10.0-2ubuntu0.2_amd64.deb  ...</span><br><span class="line">正在解包 libc-ares2:amd64 (1.10.0-2ubuntu0.2) ...</span><br><span class="line">正在选中未选择的软件包 libcollection2:amd64。</span><br><span class="line">正准备解包 .../libcollection2_0.3.0.1-4_amd64.deb  ...</span><br><span class="line">正在解包 libcollection2:amd64 (0.3.0.1-4) ...</span><br><span class="line">正在选中未选择的软件包 libdhash1:amd64。</span><br><span class="line">正准备解包 .../libdhash1_0.3.0.1-4_amd64.deb  ...</span><br><span class="line">正在解包 libdhash1:amd64 (0.3.0.1-4) ...</span><br><span class="line">正在选中未选择的软件包 libpath-utils1:amd64。</span><br><span class="line">正准备解包 .../libpath-utils1_0.3.0.1-4_amd64.deb  ...</span><br><span class="line">正在解包 libpath-utils1:amd64 (0.3.0.1-4) ...</span><br><span class="line">正在选中未选择的软件包 libref-array1:amd64。</span><br><span class="line">正准备解包 .../libref-array1_0.3.0.1-4_amd64.deb  ...</span><br><span class="line">正在解包 libref-array1:amd64 (0.3.0.1-4) ...</span><br><span class="line">正在选中未选择的软件包 libini-config3:amd64。</span><br><span class="line">正准备解包 .../libini-config3_0.3.0.1-4_amd64.deb  ...</span><br><span class="line">正在解包 libini-config3:amd64 (0.3.0.1-4) ...</span><br><span class="line">正在选中未选择的软件包 libnss-sss:amd64。</span><br><span class="line">正准备解包 .../libnss-sss_1.11.8-0ubuntu0.7_amd64.deb  ...</span><br><span class="line">正在解包 libnss-sss:amd64 (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在选中未选择的软件包 libsystemd-journal0:amd64。</span><br><span class="line">正准备解包 .../libsystemd-journal0_204-5ubuntu20.31_amd64.deb  ...</span><br><span class="line">正在解包 libsystemd-journal0:amd64 (204-5ubuntu20.31) ...</span><br><span class="line">正在选中未选择的软件包 libsasl2-modules-gssapi-mit:amd64。</span><br><span class="line">正准备解包 .../libsasl2-modules-gssapi-mit_2.1.25.dfsg1-17build1_amd64.deb  ...</span><br><span class="line">正在解包 libsasl2-modules-gssapi-mit:amd64 (2.1.25.dfsg1-17build1) ...</span><br><span class="line">正在选中未选择的软件包 adcli。</span><br><span class="line">正准备解包 .../adcli_0.7.5-1_amd64.deb  ...</span><br><span class="line">正在解包 adcli (0.7.5-1) ...</span><br><span class="line">正在选中未选择的软件包 cracklib-runtime。</span><br><span class="line">正准备解包 .../cracklib-runtime_2.9.1-1build1_amd64.deb  ...</span><br><span class="line">正在解包 cracklib-runtime (2.9.1-1build1) ...</span><br><span class="line">正在选中未选择的软件包 python3-pkg-resources。</span><br><span class="line">正准备解包 .../python3-pkg-resources_3.3-1ubuntu2_all.deb  ...</span><br><span class="line">正在解包 python3-pkg-resources (3.3-1ubuntu2) ...</span><br><span class="line">正在选中未选择的软件包 python3-chardet。</span><br><span class="line">正准备解包 .../python3-chardet_2.2.1-2~ubuntu1_all.deb  ...</span><br><span class="line">正在解包 python3-chardet (2.2.1-2~ubuntu1) ...</span><br><span class="line">正在选中未选择的软件包 python3-six。</span><br><span class="line">正准备解包 .../python3-six_1.5.2-1ubuntu1.1_all.deb  ...</span><br><span class="line">正在解包 python3-six (1.5.2-1ubuntu1.1) ...</span><br><span class="line">正在选中未选择的软件包 python3-debian。</span><br><span class="line">正准备解包 .../python3-debian_0.1.21+nmu2ubuntu2_all.deb  ...</span><br><span class="line">正在解包 python3-debian (0.1.21+nmu2ubuntu2) ...</span><br><span class="line">正在选中未选择的软件包 gdebi-core。</span><br><span class="line">正准备解包 .../gdebi-core_0.9.5.3ubuntu3_all.deb  ...</span><br><span class="line">正在解包 gdebi-core (0.9.5.3ubuntu3) ...</span><br><span class="line">正在选中未选择的软件包 krb5-config。</span><br><span class="line">正准备解包 .../krb5-config_2.3_all.deb  ...</span><br><span class="line">正在解包 krb5-config (2.3) ...</span><br><span class="line">正在选中未选择的软件包 krb5-user。</span><br><span class="line">正准备解包 .../krb5-user_1.12+dfsg-2ubuntu5.4_amd64.deb  ...</span><br><span class="line">正在解包 krb5-user (1.12+dfsg-2ubuntu5.4) ...</span><br><span class="line">正在选中未选择的软件包 ldap-utils。</span><br><span class="line">正准备解包 .../ldap-utils_2.4.31-1+nmu2ubuntu8.5_amd64.deb  ...</span><br><span class="line">正在解包 ldap-utils (2.4.31-1+nmu2ubuntu8.5) ...</span><br><span class="line">正在选中未选择的软件包 libglib2.0-bin。</span><br><span class="line">正准备解包 .../libglib2.0-bin_2.40.2-0ubuntu1.1_amd64.deb  ...</span><br><span class="line">正在解包 libglib2.0-bin (2.40.2-0ubuntu1.1) ...</span><br><span class="line">正在选中未选择的软件包 python3-packagekit。</span><br><span class="line">正准备解包 .../python3-packagekit_0.8.12-1ubuntu5_all.deb  ...</span><br><span class="line">正在解包 python3-packagekit (0.8.12-1ubuntu5) ...</span><br><span class="line">正在选中未选择的软件包 packagekit-backend-aptcc。</span><br><span class="line">正准备解包 .../packagekit-backend-aptcc_0.8.12-1ubuntu5_amd64.deb  ...</span><br><span class="line">正在解包 packagekit-backend-aptcc (0.8.12-1ubuntu5) ...</span><br><span class="line">正准备解包 .../policykit-1_0.105-4ubuntu3.14.04.6_amd64.deb  ...</span><br><span class="line">正在将 policykit-1 (0.105-4ubuntu3.14.04.6) 解包到 (0.105-4ubuntu3.14.04.1) 上 ...</span><br><span class="line">正在选中未选择的软件包 packagekit。</span><br><span class="line">正准备解包 .../packagekit_0.8.12-1ubuntu5_amd64.deb  ...</span><br><span class="line">正在解包 packagekit (0.8.12-1ubuntu5) ...</span><br><span class="line">正在选中未选择的软件包 packagekit-tools。</span><br><span class="line">正准备解包 .../packagekit-tools_0.8.12-1ubuntu5_amd64.deb  ...</span><br><span class="line">正在解包 packagekit-tools (0.8.12-1ubuntu5) ...</span><br><span class="line">正在选中未选择的软件包 python-crypto。</span><br><span class="line">正准备解包 .../python-crypto_2.6.1-4ubuntu0.3_amd64.deb  ...</span><br><span class="line">正在解包 python-crypto (2.6.1-4ubuntu0.3) ...</span><br><span class="line">正在选中未选择的软件包 python-tdb。</span><br><span class="line">正准备解包 .../python-tdb_1.3.8-0ubuntu0.14.04.1_amd64.deb  ...</span><br><span class="line">正在解包 python-tdb (1.3.8-0ubuntu0.14.04.1) ...</span><br><span class="line">正在选中未选择的软件包 python-samba。</span><br><span class="line">正准备解包 .../python-samba_2%3a4.3.11+dfsg-0ubuntu0.14.04.20_amd64.deb  ...</span><br><span class="line">正在解包 python-samba (2:4.3.11+dfsg-0ubuntu0.14.04.20) ...</span><br><span class="line">正在选中未选择的软件包 realmd。</span><br><span class="line">正准备解包 .../realmd_0.15.0-1ubuntu0.1_amd64.deb  ...</span><br><span class="line">正在解包 realmd (0.15.0-1ubuntu0.1) ...</span><br><span class="line">正在选中未选择的软件包 samba-common-bin。</span><br><span class="line">正准备解包 .../samba-common-bin_2%3a4.3.11+dfsg-0ubuntu0.14.04.20_amd64.deb  ...</span><br><span class="line">正在解包 samba-common-bin (2:4.3.11+dfsg-0ubuntu0.14.04.20) ...</span><br><span class="line">正在选中未选择的软件包 samba-dsdb-modules。</span><br><span class="line">正准备解包 .../samba-dsdb-modules_2%3a4.3.11+dfsg-0ubuntu0.14.04.20_amd64.deb  ...</span><br><span class="line">正在解包 samba-dsdb-modules (2:4.3.11+dfsg-0ubuntu0.14.04.20) ...</span><br><span class="line">正在选中未选择的软件包 wamerican。</span><br><span class="line">正准备解包 .../wamerican_7.1-1_all.deb  ...</span><br><span class="line">正在解包 wamerican (7.1-1) ...</span><br><span class="line">正在选中未选择的软件包 libipa-hbac0。</span><br><span class="line">正准备解包 .../libipa-hbac0_1.11.8-0ubuntu0.7_amd64.deb  ...</span><br><span class="line">正在解包 libipa-hbac0 (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在选中未选择的软件包 libpam-sss:amd64。</span><br><span class="line">正准备解包 .../libpam-sss_1.11.8-0ubuntu0.7_amd64.deb  ...</span><br><span class="line">正在解包 libpam-sss:amd64 (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在选中未选择的软件包 libsss-idmap0。</span><br><span class="line">正准备解包 .../libsss-idmap0_1.11.8-0ubuntu0.7_amd64.deb  ...</span><br><span class="line">正在解包 libsss-idmap0 (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在选中未选择的软件包 libsss-sudo。</span><br><span class="line">正准备解包 .../libsss-sudo_1.11.8-0ubuntu0.7_amd64.deb  ...</span><br><span class="line">正在解包 libsss-sudo (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在选中未选择的软件包 python-sss。</span><br><span class="line">正准备解包 .../python-sss_1.11.8-0ubuntu0.7_amd64.deb  ...</span><br><span class="line">正在解包 python-sss (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在选中未选择的软件包 sssd-common。</span><br><span class="line">正准备解包 .../sssd-common_1.11.8-0ubuntu0.7_amd64.deb  ...</span><br><span class="line">正在解包 sssd-common (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在选中未选择的软件包 sssd-ad-common。</span><br><span class="line">正准备解包 .../sssd-ad-common_1.11.8-0ubuntu0.7_amd64.deb  ...</span><br><span class="line">正在解包 sssd-ad-common (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在选中未选择的软件包 sssd-krb5-common。</span><br><span class="line">正准备解包 .../sssd-krb5-common_1.11.8-0ubuntu0.7_amd64.deb  ...</span><br><span class="line">正在解包 sssd-krb5-common (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在选中未选择的软件包 sssd-ad。</span><br><span class="line">正准备解包 .../sssd-ad_1.11.8-0ubuntu0.7_amd64.deb  ...</span><br><span class="line">正在解包 sssd-ad (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在选中未选择的软件包 sssd-ipa。</span><br><span class="line">正准备解包 .../sssd-ipa_1.11.8-0ubuntu0.7_amd64.deb  ...</span><br><span class="line">正在解包 sssd-ipa (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在选中未选择的软件包 sssd-krb5。</span><br><span class="line">正准备解包 .../sssd-krb5_1.11.8-0ubuntu0.7_amd64.deb  ...</span><br><span class="line">正在解包 sssd-krb5 (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在选中未选择的软件包 sssd-ldap。</span><br><span class="line">正准备解包 .../sssd-ldap_1.11.8-0ubuntu0.7_amd64.deb  ...</span><br><span class="line">正在解包 sssd-ldap (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在选中未选择的软件包 sssd-proxy。</span><br><span class="line">正准备解包 .../sssd-proxy_1.11.8-0ubuntu0.7_amd64.deb  ...</span><br><span class="line">正在解包 sssd-proxy (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在选中未选择的软件包 sssd。</span><br><span class="line">正准备解包 .../sssd_1.11.8-0ubuntu0.7_amd64.deb  ...</span><br><span class="line">正在解包 sssd (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在选中未选择的软件包 sssd-tools。</span><br><span class="line">正准备解包 .../sssd-tools_1.11.8-0ubuntu0.7_amd64.deb  ...</span><br><span class="line">正在解包 sssd-tools (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在处理用于 man-db (2.6.7.1-1ubuntu1) 的触发器 ...</span><br><span class="line">正在处理用于 shared-mime-info (1.2-0ubuntu3) 的触发器 ...</span><br><span class="line">正在处理用于 ureadahead (0.100.0-16) 的触发器 ...</span><br><span class="line">ureadahead will be reprofiled on next reboot</span><br><span class="line">正在设置 libglib2.0-0:amd64 (2.40.2-0ubuntu1.1) ...</span><br><span class="line">No schema files found: doing nothing.</span><br><span class="line">正在设置 libkrb5support0:amd64 (1.12+dfsg-2ubuntu5.4) ...</span><br><span class="line">正在设置 libkrb5-3:amd64 (1.12+dfsg-2ubuntu5.4) ...</span><br><span class="line">正在设置 libgssapi-krb5-2:amd64 (1.12+dfsg-2ubuntu5.4) ...</span><br><span class="line">正在设置 libldap-2.4-2:amd64 (2.4.31-1+nmu2ubuntu8.5) ...</span><br><span class="line">正在设置 liblzo2-2:amd64 (2.06-1.2ubuntu1.1) ...</span><br><span class="line">正在设置 libnettle4:amd64 (2.7.1-1ubuntu0.2) ...</span><br><span class="line">正在设置 libarchive13:amd64 (3.1.2-7ubuntu2.8) ...</span><br><span class="line">正在设置 libavahi-common-data:amd64 (0.6.31-4ubuntu1.3) ...</span><br><span class="line">正在设置 libavahi-common3:amd64 (0.6.31-4ubuntu1.3) ...</span><br><span class="line">正在设置 libavahi-client3:amd64 (0.6.31-4ubuntu1.3) ...</span><br><span class="line">正在设置 libcrack2:amd64 (2.9.1-1build1) ...</span><br><span class="line">正在设置 libcups2:amd64 (1.7.2-0ubuntu1.11) ...</span><br><span class="line">正在设置 libelfg0:amd64 (0.8.13-5) ...</span><br><span class="line">正在设置 libgmp10:amd64 (2:5.1.3+dfsg-1ubuntu1) ...</span><br><span class="line">正在设置 libgssrpc4:amd64 (1.12+dfsg-2ubuntu5.4) ...</span><br><span class="line">正在设置 libgstreamer1.0-0:amd64 (1.2.4-0ubuntu1.1) ...</span><br><span class="line">正在设置 libkadm5clnt-mit9:amd64 (1.12+dfsg-2ubuntu5.4) ...</span><br><span class="line">正在设置 libkdb5-7:amd64 (1.12+dfsg-2ubuntu5.4) ...</span><br><span class="line">正在设置 libkadm5srv-mit9:amd64 (1.12+dfsg-2ubuntu5.4) ...</span><br><span class="line">正在设置 libtalloc2:amd64 (2.1.5-0ubuntu0.14.04.1) ...</span><br><span class="line">正在设置 libtdb1:amd64 (1.3.8-0ubuntu0.14.04.1) ...</span><br><span class="line">正在设置 libtevent0:amd64 (0.9.28-0ubuntu0.14.04.1) ...</span><br><span class="line">正在设置 libldb1:amd64 (1:1.1.24-0ubuntu0.14.04.2) ...</span><br><span class="line">正在设置 libnl-3-200:amd64 (3.2.21-1ubuntu4.1) ...</span><br><span class="line">正在设置 libnl-genl-3-200:amd64 (3.2.21-1ubuntu4.1) ...</span><br><span class="line">正在设置 libnl-route-3-200:amd64 (3.2.21-1ubuntu4.1) ...</span><br><span class="line">正在设置 libnspr4:amd64 (2:4.13.1-0ubuntu0.14.04.1) ...</span><br><span class="line">正在设置 libpackagekit-glib2-16:amd64 (0.8.12-1ubuntu5) ...</span><br><span class="line">正在设置 libpwquality-common (1.2.3-1ubuntu1.1) ...</span><br><span class="line">正在设置 libpwquality1:amd64 (1.2.3-1ubuntu1.1) ...</span><br><span class="line">正在设置 libpam-pwquality:amd64 (1.2.3-1ubuntu1.1) ...</span><br><span class="line">正在设置 libwbclient0:amd64 (2:4.3.11+dfsg-0ubuntu0.14.04.20) ...</span><br><span class="line">正在设置 python-ldb (1:1.1.24-0ubuntu0.14.04.2) ...</span><br><span class="line">正在设置 python-talloc (2.1.5-0ubuntu0.14.04.1) ...</span><br><span class="line">正在设置 samba-common (2:4.3.11+dfsg-0ubuntu0.14.04.20) ...</span><br><span class="line"></span><br><span class="line">Creating config file /etc/samba/smb.conf with new version</span><br><span class="line">正在设置 samba-libs:amd64 (2:4.3.11+dfsg-0ubuntu0.14.04.20) ...</span><br><span class="line">正在设置 libbasicobjects0:amd64 (0.3.0.1-4) ...</span><br><span class="line">正在设置 libc-ares2:amd64 (1.10.0-2ubuntu0.2) ...</span><br><span class="line">正在设置 libcollection2:amd64 (0.3.0.1-4) ...</span><br><span class="line">正在设置 libdhash1:amd64 (0.3.0.1-4) ...</span><br><span class="line">正在设置 libpath-utils1:amd64 (0.3.0.1-4) ...</span><br><span class="line">正在设置 libref-array1:amd64 (0.3.0.1-4) ...</span><br><span class="line">正在设置 libini-config3:amd64 (0.3.0.1-4) ...</span><br><span class="line">正在设置 libnss-sss:amd64 (1.11.8-0ubuntu0.7) ...</span><br><span class="line">First installation detected...</span><br><span class="line">Checking NSS setup...</span><br><span class="line">正在设置 libsystemd-journal0:amd64 (204-5ubuntu20.31) ...</span><br><span class="line">正在设置 libsasl2-modules-gssapi-mit:amd64 (2.1.25.dfsg1-17build1) ...</span><br><span class="line">正在设置 adcli (0.7.5-1) ...</span><br><span class="line">正在设置 cracklib-runtime (2.9.1-1build1) ...</span><br><span class="line">正在设置 python3-pkg-resources (3.3-1ubuntu2) ...</span><br><span class="line">正在设置 python3-chardet (2.2.1-2~ubuntu1) ...</span><br><span class="line">正在设置 python3-six (1.5.2-1ubuntu1.1) ...</span><br><span class="line">正在设置 python3-debian (0.1.21+nmu2ubuntu2) ...</span><br><span class="line">正在设置 gdebi-core (0.9.5.3ubuntu3) ...</span><br><span class="line">正在设置 krb5-config (2.3) ...</span><br><span class="line">正在设置 krb5-user (1.12+dfsg-2ubuntu5.4) ...</span><br><span class="line">正在设置 ldap-utils (2.4.31-1+nmu2ubuntu8.5) ...</span><br><span class="line">正在设置 libglib2.0-bin (2.40.2-0ubuntu1.1) ...</span><br><span class="line">正在设置 python3-packagekit (0.8.12-1ubuntu5) ...</span><br><span class="line">正在设置 packagekit-backend-aptcc (0.8.12-1ubuntu5) ...</span><br><span class="line">正在设置 policykit-1 (0.105-4ubuntu3.14.04.6) ...</span><br><span class="line">正在设置 packagekit (0.8.12-1ubuntu5) ...</span><br><span class="line">正在设置 packagekit-tools (0.8.12-1ubuntu5) ...</span><br><span class="line">正在设置 python-crypto (2.6.1-4ubuntu0.3) ...</span><br><span class="line">正在设置 python-tdb (1.3.8-0ubuntu0.14.04.1) ...</span><br><span class="line">正在设置 python-samba (2:4.3.11+dfsg-0ubuntu0.14.04.20) ...</span><br><span class="line">正在设置 realmd (0.15.0-1ubuntu0.1) ...</span><br><span class="line">正在设置 samba-common-bin (2:4.3.11+dfsg-0ubuntu0.14.04.20) ...</span><br><span class="line">正在设置 samba-dsdb-modules (2:4.3.11+dfsg-0ubuntu0.14.04.20) ...</span><br><span class="line">正在设置 wamerican (7.1-1) ...</span><br><span class="line">正在设置 libipa-hbac0 (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在设置 libpam-sss:amd64 (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在设置 libsss-idmap0 (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在设置 libsss-sudo (1.11.8-0ubuntu0.7) ...</span><br><span class="line">First installation detected...</span><br><span class="line">Checking NSS setup...</span><br><span class="line">正在设置 python-sss (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在设置 libnss3-nssdb (2:3.28.4-0ubuntu0.14.04.5) ...</span><br><span class="line">正在设置 libnss3:amd64 (2:3.28.4-0ubuntu0.14.04.5) ...</span><br><span class="line">正在设置 sssd-common (1.11.8-0ubuntu0.7) ...</span><br><span class="line">Warning: found usr.sbin.sssd in /etc/apparmor.d/force-complain, forcing complain mode</span><br><span class="line">sssd stop/pre-start, process 3956</span><br><span class="line">sssd-autofs start/running, process 3990</span><br><span class="line">正在处理用于 ureadahead (0.100.0-16) 的触发器 ...</span><br><span class="line">正在设置 sssd-proxy (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在设置 sssd-tools (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在设置 sssd-ad-common (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在设置 sssd-krb5-common (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在设置 sssd-ad (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在设置 sssd-ipa (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在设置 sssd-krb5 (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在设置 sssd-ldap (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在设置 sssd (1.11.8-0ubuntu0.7) ...</span><br><span class="line">正在处理用于 libc-bin (2.19-0ubuntu6.9) 的触发器 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>6.Enter the name of the default realm with uppercases and press Enter key to continue the installation.<br>在安装过程中会提示，然后输入域地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">┌────────────────────────────────────────────────────────────────────────┤ Configuring Kerberos Authentication ├────────────────────────────────────────────────────────────────────────│ </span><br><span class="line">│ When users attempt to use Kerberos and specify a principal or user name without specifying what administrative Kerberos realm that principal belongs to, the system appends the       │  </span><br><span class="line">│ default realm.  The default realm may also be used as the realm of a Kerberos service running on the local machine.  Often, the default realm is the uppercase version of the local   │  </span><br><span class="line">│ DNS domain.                                                                                                                                                                           │  </span><br><span class="line">│                                                                                                                                                                                       │  </span><br><span class="line">│ Default Kerberos version 5 realm:                                                                                                                                                     │  </span><br><span class="line">│                                                                                                                                                                                       │  </span><br><span class="line">│ _____________________________________________________________________________________________________________________________________________________________________________________ │  </span><br><span class="line">│                                                                                                                                                                                       │  </span><br><span class="line">│                                                                                        &lt;Ok&gt;                                                                                           │  </span><br><span class="line">│                                                                                                                                                                                       │  </span><br><span class="line">└────────────────────────────────────────────────────────────────────────────────────────────                                                                                             </span><br><span class="line">                                                   </span><br><span class="line">                                                                                                                                                                                             </span><br></pre></td></tr></table></figure>

<p>7.创建 SSSD 配置文件.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vi  /etc/sssd/sssd.conf</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">[nss]</span><br><span class="line">filter_groups = root</span><br><span class="line">filter_users = root</span><br><span class="line">reconnection_retries = 3</span><br><span class="line"></span><br><span class="line">[pam]</span><br><span class="line">reconnection_retries = 3</span><br><span class="line"></span><br><span class="line">[sssd]</span><br><span class="line">domains = tecmint.lan</span><br><span class="line">config_file_version = 2</span><br><span class="line">services = nss, pam</span><br><span class="line">default_domain_suffix = TECMINT.LAN</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[domain/tecmint.lan]</span><br><span class="line">ad_domain = tecmint.lan</span><br><span class="line">krb5_realm = TECMINT.LAN</span><br><span class="line">realmd_tags = manages-system joined-with-samba</span><br><span class="line">cache_credentials = True</span><br><span class="line">id_provider = ad</span><br><span class="line">krb5_store_password_if_offline = True</span><br><span class="line">default_shell = /bin/bash</span><br><span class="line">ldap_id_mapping = True</span><br><span class="line">use_fully_qualified_names = True</span><br><span class="line">fallback_homedir = /home/%d/%u</span><br><span class="line">access_provider = ad</span><br><span class="line"></span><br><span class="line">auth_provider = ad</span><br><span class="line">chpass_provider = ad</span><br><span class="line">access_provider = ad</span><br><span class="line">ldap_schema = ad</span><br><span class="line">dyndns_update = true</span><br><span class="line">dyndns_refresh_interval = 43200</span><br><span class="line">dyndns_update_ptr = true</span><br><span class="line">dyndns_ttl = 3600</span><br></pre></td></tr></table></figure>
<p>以下是我们自己的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">root@bf-pc04:~# cat  /etc/sssd/sssd.conf</span><br><span class="line">[nss]</span><br><span class="line">filter_groups = root</span><br><span class="line">filter_users = root</span><br><span class="line">reconnection_retries = 3</span><br><span class="line"></span><br><span class="line">[pam]</span><br><span class="line">reconnection_retries = 3</span><br><span class="line"></span><br><span class="line">[sssd]</span><br><span class="line">domains = company.com</span><br><span class="line">config_file_version = 2</span><br><span class="line">services = nss, pam</span><br><span class="line">default_domain_suffix = company.COM</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[domain/company.com]</span><br><span class="line">ad_domain = company.com</span><br><span class="line">krb5_realm = company.COM</span><br><span class="line">realmd_tags = manages-system joined-with-samba</span><br><span class="line">cache_credentials = True</span><br><span class="line">id_provider = ad</span><br><span class="line">krb5_store_password_if_offline = True</span><br><span class="line">default_shell = /bin/bash</span><br><span class="line">ldap_id_mapping = True</span><br><span class="line">#use_fully_qualified_names = True 这个后来注释掉了 ？？？</span><br><span class="line">full_name_format = %1$s</span><br><span class="line">fallback_homedir = /home/%u</span><br><span class="line">access_provider = ad</span><br><span class="line">auth_provider = ad</span><br><span class="line">chpass_provider = ad</span><br><span class="line">access_provider = ad</span><br><span class="line">ldap_schema = ad</span><br><span class="line">dyndns_update = true</span><br><span class="line">dyndns_refresh_interval = 43200</span><br><span class="line">dyndns_update_ptr = true</span><br><span class="line">dyndns_ttl = 3600</span><br></pre></td></tr></table></figure>

<p>尤其是下面几个地方要修改为自己公司的域控地址、名称</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">domains = tecmint.lan</span><br><span class="line">default_domain_suffix = TECMINT.LAN</span><br><span class="line">[domain/tecmint.lan]</span><br><span class="line">ad_domain = tecmint.lan</span><br><span class="line">krb5_realm = TECMINT.LAN</span><br></pre></td></tr></table></figure>


<p>8.下一步，修改 &#x2F;etc&#x2F;sssd&#x2F;sssd.conf文件的权限为600.不然会启动报错的。</p>
<p>启动报错日志可以在&#x2F;var&#x2F;log&#x2F;sssd&#x2F;sssd.log中查看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo chmod 600 /etc/sssd/sssd.conf</span><br></pre></td></tr></table></figure>

<p>9.接下来，配置&#x2F;etc&#x2F;realmd.conf文件.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vi  /etc/realmd.conf</span><br></pre></td></tr></table></figure>
<p>输入以下内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[active-directory]</span><br><span class="line">os-name = Linux Ubuntu</span><br><span class="line">os-version = 17.04</span><br><span class="line"></span><br><span class="line">[service]</span><br><span class="line">automatic-install = yes</span><br><span class="line"></span><br><span class="line"> [users]</span><br><span class="line">default-home = /home/%d/%u</span><br><span class="line">default-shell = /bin/bash</span><br><span class="line"></span><br><span class="line">[tecmint.lan]</span><br><span class="line">user-principal = yes</span><br><span class="line">fully-qualified-names = no</span><br></pre></td></tr></table></figure>
<p>这里是我们自己的配置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">root@bf-pc04:~# cat /etc/realmd.conf </span><br><span class="line">[active-directory]</span><br><span class="line">os-name = Linux Ubuntu bf-pc04</span><br><span class="line">os-version = 14.04</span><br><span class="line"></span><br><span class="line">[service]</span><br><span class="line">automatic-install = no</span><br><span class="line"></span><br><span class="line">[users]</span><br><span class="line">default-home = /home/%u</span><br><span class="line">default-shell = /bin/bash</span><br><span class="line"></span><br><span class="line">[company.com]</span><br><span class="line">user-principal = yes</span><br><span class="line">fully-qualified-names = no</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>10.最后一部修改&#x2F;etc&#x2F;samba&#x2F;smb.conf 配置文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">workgroup = TECMINT</span><br><span class="line">client signing = yes</span><br><span class="line">client use spnego = yes</span><br><span class="line">kerberos method = secrets and keytab</span><br><span class="line">realm = TECMINT.LAN</span><br><span class="line">security = ads</span><br></pre></td></tr></table></figure>
<p>测试samba配置文件参数是否正确</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo testparm</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br></pre></td><td class="code"><pre><span class="line">root@bf-pc04:~# cat /etc/samba/smb.conf</span><br><span class="line">#</span><br><span class="line"># Sample configuration file for the Samba suite for Debian GNU/Linux.</span><br><span class="line">#</span><br><span class="line">#</span><br><span class="line"># This is the main Samba configuration file. You should read the</span><br><span class="line"># smb.conf(5) manual page in order to understand the options listed</span><br><span class="line"># here. Samba has a huge number of configurable options most of which </span><br><span class="line"># are not shown in this example</span><br><span class="line">#</span><br><span class="line"># Some options that are often worth tuning have been included as</span><br><span class="line"># commented-out examples in this file.</span><br><span class="line">#  - When such options are commented with &quot;;&quot;, the proposed setting</span><br><span class="line">#    differs from the default Samba behaviour</span><br><span class="line">#  - When commented with &quot;#&quot;, the proposed setting is the default</span><br><span class="line">#    behaviour of Samba but the option is considered important</span><br><span class="line">#    enough to be mentioned here</span><br><span class="line">#</span><br><span class="line"># NOTE: Whenever you modify this file you should run the command</span><br><span class="line"># &quot;testparm&quot; to check that you have not made any basic syntactic </span><br><span class="line"># errors. </span><br><span class="line"></span><br><span class="line">#======================= Global Settings =======================</span><br><span class="line"></span><br><span class="line">[global]</span><br><span class="line"></span><br><span class="line">#can access symbol link file in windows with samba</span><br><span class="line">	unix extensions = no</span><br><span class="line">	follow symlinks = yes</span><br><span class="line">	wide links = yes</span><br><span class="line"></span><br><span class="line">## Browsing/Identification ###</span><br><span class="line"></span><br><span class="line"># Change this to the workgroup/NT-domain name your Samba server will part of</span><br><span class="line">   workgroup = company</span><br><span class="line">   client signing = yes</span><br><span class="line">   client use spnego = yes</span><br><span class="line">   kerberos method = secrets and keytab</span><br><span class="line">   realm = company.COM</span><br><span class="line">   security = ads</span><br><span class="line"></span><br><span class="line"># server string is the equivalent of the NT Description field</span><br><span class="line">	server string = %h server (Samba, Ubuntu)</span><br><span class="line"></span><br><span class="line"># Windows Internet Name Serving Support Section:</span><br><span class="line"># WINS Support - Tells the NMBD component of Samba to enable its WINS Server</span><br><span class="line">#   wins support = no</span><br><span class="line"></span><br><span class="line"># WINS Server - Tells the NMBD components of Samba to be a WINS Client</span><br><span class="line"># Note: Samba can be either a WINS Server, or a WINS Client, but NOT both</span><br><span class="line">;   wins server = w.x.y.z</span><br><span class="line"></span><br><span class="line"># This will prevent nmbd to search for NetBIOS names through DNS.</span><br><span class="line">   dns proxy = no</span><br><span class="line"></span><br><span class="line">#### Networking ####</span><br><span class="line"></span><br><span class="line"># The specific set of interfaces / networks to bind to</span><br><span class="line"># This can be either the interface name or an IP address/netmask;</span><br><span class="line"># interface names are normally preferred</span><br><span class="line">;   interfaces = 127.0.0.0/8 eth0</span><br><span class="line"></span><br><span class="line"># Only bind to the named interfaces and/or networks; you must use the</span><br><span class="line"># &#x27;interfaces&#x27; option above to use this.</span><br><span class="line"># It is recommended that you enable this feature if your Samba machine is</span><br><span class="line"># not protected by a firewall or is a firewall itself.  However, this</span><br><span class="line"># option cannot handle dynamic or non-broadcast interfaces correctly.</span><br><span class="line">;   bind interfaces only = yes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### Debugging/Accounting ####</span><br><span class="line"></span><br><span class="line"># This tells Samba to use a separate log file for each machine</span><br><span class="line"># that connects</span><br><span class="line">   log file = /var/log/samba/log.%m</span><br><span class="line"></span><br><span class="line"># Cap the size of the individual log files (in KiB).</span><br><span class="line">   max log size = 1000</span><br><span class="line"></span><br><span class="line"># If you want Samba to only log through syslog then set the following</span><br><span class="line"># parameter to &#x27;yes&#x27;.</span><br><span class="line">#   syslog only = no</span><br><span class="line"></span><br><span class="line"># We want Samba to log a minimum amount of information to syslog. Everything</span><br><span class="line"># should go to /var/log/samba/log.&#123;smbd,nmbd&#125; instead. If you want to log</span><br><span class="line"># through syslog you should set the following parameter to something higher.</span><br><span class="line">   syslog = 0</span><br><span class="line"></span><br><span class="line"># Do something sensible when Samba crashes: mail the admin a backtrace</span><br><span class="line">   panic action = /usr/share/samba/panic-action %d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">####### Authentication #######</span><br><span class="line"></span><br><span class="line"># Server role. Defines in which mode Samba will operate. Possible</span><br><span class="line"># values are &quot;standalone server&quot;, &quot;member server&quot;, &quot;classic primary</span><br><span class="line"># domain controller&quot;, &quot;classic backup domain controller&quot;, &quot;active</span><br><span class="line"># directory domain controller&quot;. </span><br><span class="line">#</span><br><span class="line"># Most people will want &quot;standalone sever&quot; or &quot;member server&quot;.</span><br><span class="line"># Running as &quot;active directory domain controller&quot; will require first</span><br><span class="line"># running &quot;samba-tool domain provision&quot; to wipe databases and create a</span><br><span class="line"># new domain.</span><br><span class="line">   server role = standalone server</span><br><span class="line"></span><br><span class="line"># If you are using encrypted passwords, Samba will need to know what</span><br><span class="line"># password database type you are using.  </span><br><span class="line">   passdb backend = tdbsam</span><br><span class="line"></span><br><span class="line">   obey pam restrictions = yes</span><br><span class="line"></span><br><span class="line"># This boolean parameter controls whether Samba attempts to sync the Unix</span><br><span class="line"># password with the SMB password when the encrypted SMB password in the</span><br><span class="line"># passdb is changed.</span><br><span class="line">   unix password sync = yes</span><br><span class="line"></span><br><span class="line"># For Unix password sync to work on a Debian GNU/Linux system, the following</span><br><span class="line"># parameters must be set (thanks to Ian Kahan &lt;&lt;kahan@informatik.tu-muenchen.de&gt; for</span><br><span class="line"># sending the correct chat script for the passwd program in Debian Sarge).</span><br><span class="line">   passwd program = /usr/bin/passwd %u</span><br><span class="line">   passwd chat = *Enter\snew\s*\spassword:* %n\n *Retype\snew\s*\spassword:* %n\n *password\supdated\ssuccessfully* .</span><br><span class="line"></span><br><span class="line"># This boolean controls whether PAM will be used for password changes</span><br><span class="line"># when requested by an SMB client instead of the program listed in</span><br><span class="line"># &#x27;passwd program&#x27;. The default is &#x27;no&#x27;.</span><br><span class="line">   pam password change = yes</span><br><span class="line"></span><br><span class="line"># This option controls how unsuccessful authentication attempts are mapped</span><br><span class="line"># to anonymous connections</span><br><span class="line">   map to guest = bad user</span><br><span class="line"></span><br><span class="line">########## Domains ###########</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># The following settings only takes effect if &#x27;server role = primary</span><br><span class="line"># classic domain controller&#x27;, &#x27;server role = backup domain controller&#x27;</span><br><span class="line"># or &#x27;domain logons&#x27; is set </span><br><span class="line">#</span><br><span class="line"></span><br><span class="line"># It specifies the location of the user&#x27;s</span><br><span class="line"># profile directory from the client point of view) The following</span><br><span class="line"># required a [profiles] share to be setup on the samba server (see</span><br><span class="line"># below)</span><br><span class="line">;   logon path = \\%N\profiles\%U</span><br><span class="line"># Another common choice is storing the profile in the user&#x27;s home directory</span><br><span class="line"># (this is Samba&#x27;s default)</span><br><span class="line">#   logon path = \\%N\%U\profile</span><br><span class="line"></span><br><span class="line"># The following setting only takes effect if &#x27;domain logons&#x27; is set</span><br><span class="line"># It specifies the location of a user&#x27;s home directory (from the client</span><br><span class="line"># point of view)</span><br><span class="line">;   logon drive = H:</span><br><span class="line">#   logon home = \\%N\%U</span><br><span class="line"></span><br><span class="line"># The following setting only takes effect if &#x27;domain logons&#x27; is set</span><br><span class="line"># It specifies the script to run during logon. The script must be stored</span><br><span class="line"># in the [netlogon] share</span><br><span class="line"># NOTE: Must be store in &#x27;DOS&#x27; file format convention</span><br><span class="line">;   logon script = logon.cmd</span><br><span class="line"></span><br><span class="line"># This allows Unix users to be created on the domain controller via the SAMR</span><br><span class="line"># RPC pipe.  The example command creates a user account with a disabled Unix</span><br><span class="line"># password; please adapt to your needs</span><br><span class="line">; add user script = /usr/sbin/adduser --quiet --disabled-password --gecos &quot;&quot; %u</span><br><span class="line"></span><br><span class="line"># This allows machine accounts to be created on the domain controller via the </span><br><span class="line"># SAMR RPC pipe.  </span><br><span class="line"># The following assumes a &quot;machines&quot; group exists on the system</span><br><span class="line">; add machine script  = /usr/sbin/useradd -g machines -c &quot;%u machine account&quot; -d /var/lib/samba -s /bin/false %u</span><br><span class="line"></span><br><span class="line"># This allows Unix groups to be created on the domain controller via the SAMR</span><br><span class="line"># RPC pipe.  </span><br><span class="line">; add group script = /usr/sbin/addgroup --force-badname %g</span><br><span class="line"></span><br><span class="line">############ Misc ############</span><br><span class="line"></span><br><span class="line"># Using the following line enables you to customise your configuration</span><br><span class="line"># on a per machine basis. The %m gets replaced with the netbios name</span><br><span class="line"># of the machine that is connecting</span><br><span class="line">;   include = /home/samba/etc/smb.conf.%m</span><br><span class="line"></span><br><span class="line"># Some defaults for winbind (make sure you&#x27;re not using the ranges</span><br><span class="line"># for something else.)</span><br><span class="line">;   idmap uid = 10000-20000</span><br><span class="line">;   idmap gid = 10000-20000</span><br><span class="line">;   template shell = /bin/bash</span><br><span class="line"></span><br><span class="line"># Setup usershare options to enable non-root users to share folders</span><br><span class="line"># with the net usershare command.</span><br><span class="line"></span><br><span class="line"># Maximum number of usershare. 0 (default) means that usershare is disabled.</span><br><span class="line">;   usershare max shares = 100</span><br><span class="line"></span><br><span class="line"># Allow users who&#x27;ve been granted usershare privileges to create</span><br><span class="line"># public shares, not just authenticated ones</span><br><span class="line">   usershare allow guests = yes</span><br><span class="line"></span><br><span class="line">#======================= Share Definitions =======================</span><br><span class="line"></span><br><span class="line"># Un-comment the following (and tweak the other settings below to suit)</span><br><span class="line"># to enable the default home directory shares. This will share each</span><br><span class="line"># user&#x27;s home directory as \\server\username</span><br><span class="line">[homes]</span><br><span class="line">   comment = %h server Home Directories</span><br><span class="line">   browseable = yes</span><br><span class="line"></span><br><span class="line"># By default, the home directories are exported read-only. Change the</span><br><span class="line"># next parameter to &#x27;no&#x27; if you want to be able to write to them.</span><br><span class="line">   read only = no</span><br><span class="line"></span><br><span class="line"># File creation mask is set to 0700 for security reasons. If you want to</span><br><span class="line"># create files with group=rw permissions, set next parameter to 0775.</span><br><span class="line">   create mask = 0700</span><br><span class="line"></span><br><span class="line"># Directory creation mask is set to 0700 for security reasons. If you want to</span><br><span class="line"># create dirs. with group=rw permissions, set next parameter to 0775.</span><br><span class="line">   directory mask = 0700</span><br><span class="line"></span><br><span class="line"># By default, \\server\username shares can be connected to by anyone</span><br><span class="line"># with access to the samba server.</span><br><span class="line"># Un-comment the following parameter to make sure that only &quot;username&quot;</span><br><span class="line"># can connect to \\server\username</span><br><span class="line"># This might need tweaking when using external authentication schemes</span><br><span class="line">   valid users = %S</span><br><span class="line"></span><br><span class="line"># Un-comment the following and create the netlogon directory for Domain Logons</span><br><span class="line"># (you need to configure Samba to act as a domain controller too.)</span><br><span class="line">;[netlogon]</span><br><span class="line">;   comment = Network Logon Service</span><br><span class="line">;   path = /home/samba/netlogon</span><br><span class="line">;   guest ok = yes</span><br><span class="line">;   read only = yes</span><br><span class="line"></span><br><span class="line"># Un-comment the following and create the profiles directory to store</span><br><span class="line"># users profiles (see the &quot;logon path&quot; option above)</span><br><span class="line"># (you need to configure Samba to act as a domain controller too.)</span><br><span class="line"># The path below should be writable by all users so that their</span><br><span class="line"># profile directory may be created the first time they log on</span><br><span class="line">;[profiles]</span><br><span class="line">;   comment = Users profiles</span><br><span class="line">;   path = /home/samba/profiles</span><br><span class="line">;   guest ok = no</span><br><span class="line">;   browseable = no</span><br><span class="line">;   create mask = 0600</span><br><span class="line">;   directory mask = 0700</span><br><span class="line"></span><br><span class="line">[printers]</span><br><span class="line">   comment = All Printers</span><br><span class="line">   browseable = no</span><br><span class="line">   path = /var/spool/samba</span><br><span class="line">   printable = yes</span><br><span class="line">   guest ok = no</span><br><span class="line">   read only = yes</span><br><span class="line">   create mask = 0700</span><br><span class="line"></span><br><span class="line"># Windows clients look for this share name as a source of downloadable</span><br><span class="line"># printer drivers</span><br><span class="line">[print$]</span><br><span class="line">   comment = Printer Drivers</span><br><span class="line">   path = /var/lib/samba/printers</span><br><span class="line">   browseable = yes</span><br><span class="line">   read only = yes</span><br><span class="line">   guest ok = no</span><br><span class="line"># Uncomment to allow remote administration of Windows print drivers.</span><br><span class="line"># You may need to replace &#x27;lpadmin&#x27; with the name of the group your</span><br><span class="line"># admin users are members of.</span><br><span class="line"># Please note that you also need to set appropriate Unix permissions</span><br><span class="line"># to the drivers directory for these users to have write rights in it</span><br><span class="line">;   write list = root, @lpadmin</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>使用testparm命令测试samba配置文件是否正确</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">root@bf-pc04:/etc/samba# testparm </span><br><span class="line">Load smb config files from /etc/samba/smb.conf</span><br><span class="line">rlimit_max: increasing rlimit_max (1024) to minimum Windows limit (16384)</span><br><span class="line">WARNING: The &quot;syslog&quot; option is deprecated</span><br><span class="line">Processing section &quot;[printers]&quot;</span><br><span class="line">Processing section &quot;[print$]&quot;</span><br><span class="line">Loaded services file OK.</span><br><span class="line">Server role: ROLE_DOMAIN_MEMBER</span><br><span class="line"></span><br><span class="line">Press enter to see a dump of your service definitions</span><br><span class="line"></span><br><span class="line"># Global parameters</span><br><span class="line">[global]</span><br><span class="line">	workgroup = company</span><br><span class="line">	realm = company.COM</span><br><span class="line">	server string = %h server (Samba, Ubuntu)</span><br><span class="line">	server role = standalone server</span><br><span class="line">	security = ADS</span><br><span class="line">	map to guest = Bad User</span><br><span class="line">	obey pam restrictions = Yes</span><br><span class="line">	pam password change = Yes</span><br><span class="line">	passwd program = /usr/bin/passwd %u</span><br><span class="line">	passwd chat = *Enter\snew\s*\spassword:* %n\n *Retype\snew\s*\spassword:* %n\n *password\supdated\ssuccessfully* .</span><br><span class="line">	unix password sync = Yes</span><br><span class="line">	kerberos method = secrets and keytab</span><br><span class="line">	syslog = 0</span><br><span class="line">	log file = /var/log/samba/log.%m</span><br><span class="line">	max log size = 1000</span><br><span class="line">	client signing = if_required</span><br><span class="line">	dns proxy = No</span><br><span class="line">	usershare allow guests = Yes</span><br><span class="line">	panic action = /usr/share/samba/panic-action %d</span><br><span class="line">	idmap config * : backend = tdb</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[printers]</span><br><span class="line">	comment = All Printers</span><br><span class="line">	path = /var/spool/samba</span><br><span class="line">	create mask = 0700</span><br><span class="line">	printable = Yes</span><br><span class="line">	browseable = No</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[print$]</span><br><span class="line">	comment = Printer Drivers</span><br><span class="line">	path = /var/lib/samba/printers</span><br></pre></td></tr></table></figure>



<p>11.、当所有的配置都修改好了之后，我们就可以测试kerberos权限。这里需要使用域控管理员账号</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo kinit ad_admin_user@DOMAIN.TLD</span><br><span class="line">$ sudo klist</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">root@bf-pc04:/etc/samba# kinit admin@company.COM</span><br><span class="line">Password for admin-@company.COM: </span><br><span class="line"></span><br><span class="line">root@bf-pc04:/etc/samba# klist</span><br><span class="line">Ticket cache: FILE:/tmp/krb5cc_0</span><br><span class="line">Default principal: admin-@company.COM</span><br><span class="line"></span><br><span class="line">Valid starting       Expires              Service principal</span><br><span class="line">2019-05-17T17:12:28  2019-05-18T03:12:28  krbtgt/company.COM@company.COM</span><br><span class="line">	renew until 2019-05-18T17:12:21</span><br></pre></td></tr></table></figure>

<h1 id="Step-3-Join-Ubuntu-to-Samba4-Realm"><a href="#Step-3-Join-Ubuntu-to-Samba4-Realm" class="headerlink" title="Step 3: Join Ubuntu to Samba4 Realm"></a>Step 3: Join Ubuntu to Samba4 Realm</h1><p>12、使用realm加入域控</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo realm discover -v DOMAIN.TLD</span><br><span class="line">$ sudo realm list</span><br><span class="line">$ sudo realm join TECMINT.LAN -U ad_admin_user -v</span><br><span class="line">$ sudo net ads join -k  # 这一步要执行</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">root@bf-pc04:/etc/samba# realm discover -v company.COM</span><br><span class="line"> * Resolving: _ldap._tcp.company.com</span><br><span class="line"> * Performing LDAP DSE lookup on: 10.0.13.253</span><br><span class="line"> * Performing LDAP DSE lookup on: 10.0.17.228</span><br><span class="line"> * Performing LDAP DSE lookup on: 10.0.13.252</span><br><span class="line"> * Successfully discovered: company.com</span><br><span class="line">company.com</span><br><span class="line">  type: kerberos</span><br><span class="line">  realm-name: company.COM</span><br><span class="line">  domain-name: company.com</span><br><span class="line">  configured: kerberos-member</span><br><span class="line">  server-software: active-directory</span><br><span class="line">  client-software: sssd</span><br><span class="line">  required-package: sssd-tools</span><br><span class="line">  required-package: sssd</span><br><span class="line">  required-package: libnss-sss</span><br><span class="line">  required-package: libpam-sss</span><br><span class="line">  required-package: adcli</span><br><span class="line">  required-package: samba-common-bin</span><br><span class="line">  login-formats: %U</span><br><span class="line">  login-policy: allow-realm-logins</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">root@bf-pc04:/etc/samba# realm list</span><br><span class="line">company.com</span><br><span class="line">  type: kerberos</span><br><span class="line">  realm-name: company.COM</span><br><span class="line">  domain-name: company.com</span><br><span class="line">  configured: kerberos-member</span><br><span class="line">  server-software: active-directory</span><br><span class="line">  client-software: winbind</span><br><span class="line">  required-package: winbind</span><br><span class="line">  required-package: libpam-winbind</span><br><span class="line">  required-package: samba-common-bin</span><br><span class="line">  login-formats: company\%U</span><br><span class="line">  login-policy: allow-any-login</span><br><span class="line">company.com</span><br><span class="line">  type: kerberos</span><br><span class="line">  realm-name: company.COM</span><br><span class="line">  domain-name: company.com</span><br><span class="line">  configured: kerberos-member</span><br><span class="line">  server-software: active-directory</span><br><span class="line">  client-software: sssd</span><br><span class="line">  required-package: sssd-tools</span><br><span class="line">  required-package: sssd</span><br><span class="line">  required-package: libnss-sss</span><br><span class="line">  required-package: libpam-sss</span><br><span class="line">  required-package: adcli</span><br><span class="line">  required-package: samba-common-bin</span><br><span class="line">  login-formats: %U</span><br><span class="line">  login-policy: allow-realm-logins</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">root@bf-pc04:/etc/samba# realm join company.COM -U admin- -v</span><br><span class="line"> * Resolving: _ldap._tcp.company.com</span><br><span class="line"> * Performing LDAP DSE lookup on: 10.0.13.253</span><br><span class="line"> * Performing LDAP DSE lookup on: 10.0.13.252</span><br><span class="line"> * Successfully discovered: company.com</span><br><span class="line">realm: 已加入该域</span><br><span class="line">root@bf-pc04:/etc/samba# </span><br></pre></td></tr></table></figure>


<p>13、After the domain binding took place, run the below command to assure that all domain accounts are permitted to authenticate on the machine.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo realm permit --all</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ sudo realm deny -a</span><br><span class="line">$ realm permit --groups ‘domain.tld\Linux Admins’</span><br><span class="line">$ realm permit user@domain.lan</span><br><span class="line">$ realm permit DOMAIN\\User2</span><br></pre></td></tr></table></figure>
<p>这一步会报错.目前还没查明怎么弄???</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@bf-pc04:/var/log# realm deny -a</span><br><span class="line">See: journalctl REALMD_OPERATION=r151224.2915</span><br><span class="line">realm: Couldn&#x27;t change permitted logins: The Samba provider cannot restrict permitted logins.</span><br></pre></td></tr></table></figure>

<p>14、从Windows域控上就可以看到这台linux计算机了</p>
<h1 id="Step-4-Configure-AD-Accounts-Authentication"><a href="#Step-4-Configure-AD-Accounts-Authentication" class="headerlink" title="Step 4: Configure AD Accounts Authentication"></a>Step 4: Configure AD Accounts Authentication</h1><p>15、In order to authenticate on Ubuntu machine with domain accounts you need to run pam-auth-update command with root privileges and enable all PAM profiles including the option to automatically create home directories for each domain account at the first login.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo pam-auth-update</span><br></pre></td></tr></table></figure>


<p>16、On systems manually edit &#x2F;etc&#x2F;pam.d&#x2F;common-account file and the following line in order to automatically create homes for authenticated domain users.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session    required    pam_mkhomedir.so    skel=/etc/skel/    umask=0022</span><br></pre></td></tr></table></figure>


<p>17、If Active Directory users can’t change their password from command line in Linux, open &#x2F;etc&#x2F;pam.d&#x2F;common-password file and remove the use_authtok statement from password line to finally look as on the below excerpt.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password       [success=1 default=ignore]      pam_winbind.so try_first_pass</span><br></pre></td></tr></table></figure>





<p>23、To use a domain account with root privileges on your Ubuntu machine, you need to add the AD username to the sudo system group by issuing the below command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo usermod -aG sudo your_domain_user@domain.tld</span><br></pre></td></tr></table></figure>
<p>24、To add root privileges for a domain group, open end edit &#x2F;etc&#x2F;sudoers file using visudo command and add the following line as illustrated.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%domain\ admins@tecmint.lan       		 ALL=(ALL:ALL) ALL</span><br></pre></td></tr></table></figure>

<p>25、To use domain account authentication for Ubuntu Desktop modify LightDM display manager by editing &#x2F;usr&#x2F;share&#x2F;lightdm&#x2F;lightdm.conf.d&#x2F;50-ubuntu.conf file, append the following two lines and restart lightdm service or reboot the machine apply changes.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">greeter-show-manual-login=true</span><br><span class="line">greeter-hide-users=true</span><br></pre></td></tr></table></figure>


<p>26、To use short name format for Samba AD accounts, edit &#x2F;etc&#x2F;sssd&#x2F;sssd.conf file, add the following line in [sssd] block as illustrated below.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">full_name_format = %1$s</span><br></pre></td></tr></table></figure>

<p>27、In case you cannot login due to enumerate&#x3D;true argument set in sssd.conf you must clear sssd cached database by issuing the below command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rm /var/lib/sss/db/cache_tecmint.lan.ldb</span><br></pre></td></tr></table></figure>


<h1 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h1><p>The Pluggable Authentication Modules library, or PAM</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">To enable this module we need to add the following line to /etc/pam.d/common-account:</span><br><span class="line"></span><br><span class="line">session    required   pam_mkhomedir.so skel=/etc/skel/ umask=0022</span><br></pre></td></tr></table></figure>
<p>The common-account file is included by several other authentication files, so it will take effect for remote SSH logins, local GDM logins, and console logins too.</p>
<p>This is very handy but if your users are also able to access through Samba no home directory will be created, since it does not authenticate through PAM. The only way around this I found was through using the ‘root preexec’ directive in smb.conf for the home share. Like this: </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">root preexec = /usr/sbin/smb-mkhomedir.sh %U</span><br><span class="line">root preexec = mkhomedir_helper &quot;%u&quot;</span><br><span class="line"></span><br><span class="line">#!/bin/bash</span><br><span class="line">#smb-mkhomedir.sh</span><br><span class="line"></span><br><span class="line">DHOME=&quot;/home&quot;</span><br><span class="line">USERS_GID=&quot;1000&quot;</span><br><span class="line">SKEL=&quot;/etc/skel&quot;</span><br><span class="line"></span><br><span class="line"># Reads config file (will override defaults above)</span><br><span class="line">[ -r /etc/adduser.conf ] &amp;&amp; . /etc/adduser.conf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if [ -z $1 ]; then</span><br><span class="line">        echo &quot;Usage: $0 username&quot; 1&gt;&amp;2</span><br><span class="line">        exit 1</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">if [ ! -e $DHOME/$1 ]; then</span><br><span class="line">        mkdir -m $DIR_MODE -p $DHOME/$1</span><br><span class="line">        cp -R $SKEL/* $DHOME/$1</span><br><span class="line">        chown -R $1:$USERS_GID $DHOME/$1</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">exit 0</span><br></pre></td></tr></table></figure>

<p>pam exec 模块</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">[ &quot;$PAM_TYPE&quot; = &quot;open_session&quot; ] || exit 0</span><br><span class="line">&#123;</span><br><span class="line">  echo &quot;User: $PAM_USER&quot;</span><br><span class="line">  echo &quot;Ruser: $PAM_RUSER&quot;</span><br><span class="line">  echo &quot;Rhost: $PAM_RHOST&quot;</span><br><span class="line">  echo &quot;Service: $PAM_SERVICE&quot;</span><br><span class="line">  echo &quot;TTY: $PAM_TTY&quot;</span><br><span class="line">  echo &quot;Date: `date`&quot;</span><br><span class="line">  echo &quot;Server: `uname -a`&quot;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">root@fs-share:/var/log# cat pam_exec.log</span><br><span class="line"># 登陆账户</span><br><span class="line">*** Tue Jun  4 13:32:39 2019</span><br><span class="line">MAIL=/var/mail/bright.ma</span><br><span class="line">PAM_USER=bright.ma</span><br><span class="line">PAM_TYPE=open_session</span><br><span class="line">PAM_RUSER=root</span><br><span class="line">PAM_SERVICE=su</span><br><span class="line">PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games</span><br><span class="line">PAM_TTY=/dev/pts/0</span><br><span class="line">LANG=en_US.UTF-8</span><br><span class="line">PWD=/tmp</span><br><span class="line"></span><br><span class="line"># 下面是 退出登陆</span><br><span class="line">*** Tue Jun  4 13:32:50 2019</span><br><span class="line">PAM_USER=bright.ma</span><br><span class="line">PAM_TYPE=close_session</span><br><span class="line">PAM_RUSER=root</span><br><span class="line">PAM_SERVICE=su</span><br><span class="line">PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games</span><br><span class="line">PAM_TTY=/dev/pts/0</span><br><span class="line">LANG=en_US.UTF-8</span><br><span class="line">PWD=/tmp</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">默认配置 </span><br><span class="line">ldap_id_mapping = <span class="literal">true</span></span><br><span class="line">ldap_idmap_range_min = 100000</span><br><span class="line">ldap_idmap_range_max = 2000100000</span><br><span class="line">ldap_idmap_range_size = 2000000000</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://magesfc.github.io">mage</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://magesfc.github.io/mage/faa877ef8e26557441db9099437ab98d161e5dbf/">https://magesfc.github.io/mage/faa877ef8e26557441db9099437ab98d161e5dbf/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://magesfc.github.io" target="_blank">马哥私房菜</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ubuntu/">ubuntu</a><a class="post-meta__tags" href="/tags/windows/">windows</a><a class="post-meta__tags" href="/tags/ad/">ad</a><a class="post-meta__tags" href="/tags/sssd/">sssd</a><a class="post-meta__tags" href="/tags/realm/">realm</a></div><div class="post_share"><div class="social-share" data-image="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="/null" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="/null" alt="支付寶"/></a><div class="post-qr-code-desc">支付寶</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/mage/0f82a538ae2222b1e1f51fa097614ce2767185b6/"><img class="prev-cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Ubuntu学习笔记之调试Samba</div></div></a></div><div class="next-post pull-right"><a href="/mage/06aebecf548b5dba3ab91ec2c3f47a8645651694/"><img class="next-cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Ubuntu学习笔记之分区详解之LVM</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/mage/0092c74723dc205077d9e5927bb577a5995af9be/" title="Ubuntu学习笔记之ubuntu加入Windows的AD域使用Samba和Winbind的方式"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">Ubuntu学习笔记之ubuntu加入Windows的AD域使用Samba和Winbind的方式</div></div></a></div><div><a href="/mage/34e4d0939638b865838f594d333311f5fce82bca/" title="ELK学习之elasticsearch的安装之Ubuntu上安装elasticsearch"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">ELK学习之elasticsearch的安装之Ubuntu上安装elasticsearch</div></div></a></div><div><a href="/mage/6018e727e97bd487ee0f5b15648a257010d6c4e3/" title="ELK学习之elasticsearch的安装之Ubuntu上安装kibana"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">ELK学习之elasticsearch的安装之Ubuntu上安装kibana</div></div></a></div><div><a href="/mage/d98e027b6b2926e6955f7d6fb21ccb408c1319ac/" title="Ubuntu学习笔记之BackupYourSystem使用tar命令"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">Ubuntu学习笔记之BackupYourSystem使用tar命令</div></div></a></div><div><a href="/mage/35bdc5bde6c79f7d9baa28f71b48588bac55bf8a/" title="Ubuntu学习笔记之hide-process-from-other-user"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">Ubuntu学习笔记之hide-process-from-other-user</div></div></a></div><div><a href="/mage/2b79139b936cd1db08d4688a6b499ddedf7d91a5/" title="Ubuntu学习笔记之test-disk-IO-performance"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">Ubuntu学习笔记之test-disk-IO-performance</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">mage</div><div class="author-info__description"> 这里是 马哥 的个人博客 </div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">161</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">180</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">34</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/mamh2021"><i class="fab fa-github"></i><span>GitHub</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/mamh2021" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Step-1-Initial-Configurations-to-Join-Ubuntu-to-Samba4-AD"><span class="toc-number">1.</span> <span class="toc-text">Step 1: Initial Configurations to Join Ubuntu to Samba4 AD</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Step-3-Join-Ubuntu-to-Samba4-Realm"><span class="toc-number">2.</span> <span class="toc-text">Step 3: Join Ubuntu to Samba4 Realm</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Step-4-Configure-AD-Accounts-Authentication"><span class="toc-number">3.</span> <span class="toc-text">Step 4: Configure AD Accounts Authentication</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A1%A5%E5%85%85"><span class="toc-number">4.</span> <span class="toc-text">补充</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/mage/84776adcfbfc963bd1f2f6d5bd3fd8d22c6a46a5/" title="jenkins插件学习之show-build-parameters-plugin"><img src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="jenkins插件学习之show-build-parameters-plugin"/></a><div class="content"><a class="title" href="/mage/84776adcfbfc963bd1f2f6d5bd3fd8d22c6a46a5/" title="jenkins插件学习之show-build-parameters-plugin">jenkins插件学习之show-build-parameters-plugin</a><time datetime="2022-11-04T03:53:50.000Z" title="更新于 2022-11-04 11:53:50">2022-11-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/23369f1e1080d1a6749c477927cb9acccf216b36/" title="jenkins插件学习之matrix-project-plugin"><img src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="jenkins插件学习之matrix-project-plugin"/></a><div class="content"><a class="title" href="/mage/23369f1e1080d1a6749c477927cb9acccf216b36/" title="jenkins插件学习之matrix-project-plugin">jenkins插件学习之matrix-project-plugin</a><time datetime="2022-11-04T03:53:32.000Z" title="更新于 2022-11-04 11:53:32">2022-11-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/f69d2317dbb9ce1dbfccbd61f81a402200d7547f/" title="jenkins插件学习之job-parameter-summary-plugin"><img src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="jenkins插件学习之job-parameter-summary-plugin"/></a><div class="content"><a class="title" href="/mage/f69d2317dbb9ce1dbfccbd61f81a402200d7547f/" title="jenkins插件学习之job-parameter-summary-plugin">jenkins插件学习之job-parameter-summary-plugin</a><time datetime="2022-11-04T03:53:14.000Z" title="更新于 2022-11-04 11:53:14">2022-11-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/dd153582d58799584987955d6355cf3c32f1bc7f/" title="jenkins插件学习之hidden-parameter-plugin"><img src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="jenkins插件学习之hidden-parameter-plugin"/></a><div class="content"><a class="title" href="/mage/dd153582d58799584987955d6355cf3c32f1bc7f/" title="jenkins插件学习之hidden-parameter-plugin">jenkins插件学习之hidden-parameter-plugin</a><time datetime="2022-11-04T03:52:57.000Z" title="更新于 2022-11-04 11:52:57">2022-11-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/a718e01bee375dd72d94fd15211e2e4f41c0a52c/" title="Linux学习之bash学习之cookbook技巧"><img src= "/img/loading.gif" data-lazy-src="https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux学习之bash学习之cookbook技巧"/></a><div class="content"><a class="title" href="/mage/a718e01bee375dd72d94fd15211e2e4f41c0a52c/" title="Linux学习之bash学习之cookbook技巧">Linux学习之bash学习之cookbook技巧</a><time datetime="2022-11-04T03:48:18.000Z" title="更新于 2022-11-04 11:48:18">2022-11-04</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://office-1256119282.file.myqcloud.com/2022/official-web/cdn/20220301/pc_bg_05.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2022 By mage</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>