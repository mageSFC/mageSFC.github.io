<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Ansible自动化运维工具之总体介绍总结 | 马哥私房菜</title><meta name="author" content="mage"><meta name="copyright" content="mage"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ansible1 ansible概述介绍来自 https:&#x2F;&#x2F;www.cnblogs.com&#x2F;keerya&#x2F;p&#x2F;7987886.html 1.0 ansible 是什么？ ansible是新出现的自动化运维工具，基于Python开发，集合了众多运维工具（puppet、chef、func、fabric)的优点，实现了批量系统配置、批量程序部署、批量运行命令等功能。ansible是基于 paramik">
<meta property="og:type" content="article">
<meta property="og:title" content="Ansible自动化运维工具之总体介绍总结">
<meta property="og:url" content="https://magesfc.github.io/mage/3988ad506287c3c5ea81a4669e671c026ed1520e/">
<meta property="og:site_name" content="马哥私房菜">
<meta property="og:description" content="ansible1 ansible概述介绍来自 https:&#x2F;&#x2F;www.cnblogs.com&#x2F;keerya&#x2F;p&#x2F;7987886.html 1.0 ansible 是什么？ ansible是新出现的自动化运维工具，基于Python开发，集合了众多运维工具（puppet、chef、func、fabric)的优点，实现了批量系统配置、批量程序部署、批量运行命令等功能。ansible是基于 paramik">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://t.mwm.moe/fj/">
<meta property="article:published_time" content="2022-04-04T03:38:43.000Z">
<meta property="article:modified_time" content="2022-10-31T08:45:25.000Z">
<meta property="article:author" content="mage">
<meta property="article:tag" content="ansible">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://t.mwm.moe/fj/"><link rel="shortcut icon" href="https://www.zeekrlife.com/favicon.png"><link rel="canonical" href="https://magesfc.github.io/mage/3988ad506287c3c5ea81a4669e671c026ed1520e/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":150,"languages":{"author":"作者: mage","link":"链接: ","source":"来源: 马哥私房菜","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Ansible自动化运维工具之总体介绍总结',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-10-31 16:45:25'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><style type="text/css">.card-announcement .social-button{margin:.6rem 0 0 0;text-align:center}.card-announcement .social-button a{display:block;background-color:var(--btn-bg);color:var(--btn-color);text-align:center;line-height:2.4;margin:4px 0}.card-announcement .social-button a:hover{background-color:var(--btn-hover-color)}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">217</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">233</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">40</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> 精选文档</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/21cfbf15/"><span> 🚀 快速开始</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/dc584b87/"><span> 📑 主题页面</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4aa8abbe/"><span> 🛠 主题配置-1</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/ceeb73f/"><span> 🛠 主题配置-2</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/98d20436/"><span> ❓ 主题问答</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4073eda/"><span> ⚡️ 进阶教程</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/198a4240/"><span> ✨ 更新日志</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://butterfly.js.org/link/"><i class="fa-fw fas fa-thumbs-up"></i><span> 其他示例</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://t.mwm.moe/fj/')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">马哥私房菜</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> 精选文档</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/21cfbf15/"><span> 🚀 快速开始</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/dc584b87/"><span> 📑 主题页面</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4aa8abbe/"><span> 🛠 主题配置-1</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/ceeb73f/"><span> 🛠 主题配置-2</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/98d20436/"><span> ❓ 主题问答</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4073eda/"><span> ⚡️ 进阶教程</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/198a4240/"><span> ✨ 更新日志</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://butterfly.js.org/link/"><i class="fa-fw fas fa-thumbs-up"></i><span> 其他示例</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Ansible自动化运维工具之总体介绍总结</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-04-04T03:38:43.000Z" title="发表于 2022-04-04 11:38:43">2022-04-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-10-31T08:45:25.000Z" title="更新于 2022-10-31 16:45:25">2022-10-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ansible/">ansible</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Ansible自动化运维工具之总体介绍总结"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="ansible"><a href="#ansible" class="headerlink" title="ansible"></a>ansible</h1><h1 id="1-ansible概述介绍"><a href="#1-ansible概述介绍" class="headerlink" title="1 ansible概述介绍"></a>1 ansible概述介绍</h1><p>来自 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/keerya/p/7987886.html">https://www.cnblogs.com/keerya/p/7987886.html</a></p>
<p>1.0 ansible 是什么？</p>
<p>ansible是新出现的自动化运维工具，基于Python开发，集合了众多运维工具（puppet、chef、func、fabric)的优点，实现了批量系统配置、批量程序部署、批量运行命令等功能。<br>ansible是基于 paramiko 开发的,并且基于模块化工作，本身没有批量部署的能力。真正具有批量部署的是ansible所运行的模块，ansible只是提供一种框架。ansible不需要在远程主机上安装client&#x2F;agents，因为它们是基于ssh来和远<br>程主机通讯的。ansible目前已经已经被红帽官方收购，是自动化运维工具中大家认可度最高的，并且上手容易，学习简单。是每位运维工程师必须掌握的技能之一。</p>
<p>1.1ansible 特点</p>
<pre><code>部署简单，只需在主控端部署Ansible环境，被控端无需做任何操作；
默认使用SSH协议对设备进行管理；
有大量常规运维操作模块，可实现日常绝大部分操作；
配置简单、功能强大、扩展性强；
支持API及自定义模块，可通过Python轻松扩展；
通过Playbooks来定制强大的配置、状态管理；
轻量级，无需在客户端安装agent，更新时，只需在操作机上进行一次更新即可；
提供一个功能强大、操作性强的Web管理界面和REST API接口——AWX平台。
</code></pre>
<p>1.2ansible 架构图</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://images2017.cnblogs.com/blog/1204916/201712/1204916-20171205163000628-69838828.png" alt="ansible架构图"></p>
<p>上图中我们看到的主要模块如下：</p>
<pre><code>Ansible：Ansible核心程序。
HostInventory：记录由Ansible管理的主机信息，包括端口、密码、ip等。
Playbooks：“剧本”YAML格式文件，多个任务定义在一个文件中，定义主机需要调用哪些模块来完成的功能。
CoreModules：核心模块，主要操作是通过调用核心模块来完成管理任务。
CustomModules：自定义模块，完成核心模块无法完成的功能，支持多种语言。
ConnectionPlugins：连接插件，Ansible和Host通信使用
</code></pre>
<p>1.3ansible 任务执行模式</p>
<p>Ansible 系统由控制主机对被管节点的操作方式可分为两类，即adhoc和playbook：</p>
<pre><code>ad-hoc模式(点对点模式)
　　使用单个模块，支持批量执行单条命令。ad-hoc 命令是一种可以快速输入的命令，而且不需要保存起来的命令。就相当于bash中的一句话shell。
playbook模式(剧本模式)
　　是Ansible主要管理方式，也是Ansible功能强大的关键所在。playbook通过多个task集合完成一类功能，如Web服务的安装部署、数据库服务器的批量备份等。可以简单地把playbook理解为通过组合多条ad-hoc操作的配置文件。
</code></pre>
<p>1.4ansible 执行流程</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://images2017.cnblogs.com/blog/1204916/201712/1204916-20171205162615738-1292598736.png" alt="ansible架构图"></p>
<p>简单理解就是Ansible在运行时， 首先读取ansible.cfg中的配置， 根据规则获取Inventory中的管理主机列表， 并行的在这些主机中执行配置的任务， 最后等待执行返回的结果。</p>
<p>1.5ansible 命令执行过程</p>
<pre><code>加载自己的配置文件，默认/etc/ansible/ansible.cfg；
查找对应的主机配置文件，找到要执行的主机或者组；
加载自己对应的模块文件，如 command；
通过ansible将模块或命令生成对应的临时py文件(python脚本)， 并将该文件传输至远程服务器；
对应执行用户的家目录的.ansible/tmp/XXX/XXX.PY文件；
给文件 +x 执行权限；
执行并返回结果；
删除临时py文件，sleep 0退出；
</code></pre>
<p>来自 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xuwymm/p/15157466.html">https://www.cnblogs.com/xuwymm/p/15157466.html</a></p>
<p>1.0 ansible概述</p>
<pre><code>Ansible 是一个 IT 自动化的“配置管理”工具，自动化主要体现在 Ansible 集成了丰富模块，以及强大的功能组件，可以通过一个命令行完成一系列的操作。进而能减少我们重复性的工作，以提高工作的效率。
创始人，Michael DeHaan(Cobbler 与 Func 的作者)。
2015-10-17，Red Hat宣布收购。
</code></pre>
<p>1.1 ansible的功能</p>
<pre><code>批量执行远程命令，可以对N多台主机同时进行命令的执行。
批量配置软件服务，可以进行自动化的方式配置和管理服务。
实现软件开发功能， jumpserver 底层使用 ansible 来实现的自动化管理。
编排高级的IT任务， Ansible 的 Playbook 是一门编程语言，可以用来描绘一套 IT 架构。
</code></pre>
<p>1.2 ansible的特性</p>
<pre><code>容易学习：无代理，基于SSH实现，不像 saltstack既要学客户端与服务端，还需要学习客户端与服务端中间通讯协议；
操作灵活： Ansible 有较多的模块，提供了丰富的功能、 playbook 则提供类似于编程语言的复杂功能；
简单易用：体现在 Ansible 一个命令可以完成很多事情；
安全可靠：因为 Ansible 使用了 SSH 协议进行通讯，既稳定也安全；
移植性高：可以将写好的 playbook 拷贝至任意机器进行执行；
幂等性：一个任务执行1遍和执行n遍效果一样，不会因为重复执行带来意外情况；
</code></pre>
<p>1.3 ansible的架构<br><a target="_blank" rel="noopener" href="https://img2020.cnblogs.com/blog/2367894/202108/2367894-20210818163717051-274279688.png">https://img2020.cnblogs.com/blog/2367894/202108/2367894-20210818163717051-274279688.png</a></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://img2020.cnblogs.com/blog/2367894/202108/2367894-20210818163717051-274279688.png" alt="ansible基本架构"></p>
<pre><code>ANSIBLE PLAYBOOKS：任务剧本（任务集)，编排定义Ansible任务集的配置文件，由Ansible顺序依次执行，通常是JSON格式的YAML文件;

INVENTORY：Ansible管理主机的清单/etc/anaible/hosts;

MODULES：Ansible执行命令的功能模块，多数为内置核心模块，也可自定义;

PLUGINS：模块功能的补充，如连接类型插件、循环插件、变量插件、过滤插件等，该功能不常用;

API：供第三方程序调用的应用程序编程接口;

Ansible主要操作对象：HOSTS主机，主机组和NETWORKING网络设备;
</code></pre>
<p>利用ansible实现管理的方式：</p>
<pre><code>Ad-Hoc
即执行单条的ansible命令，主要用于临时命令使用场景；

Ansible-playbook
主要用于长期规划好的，大型项目的场景，需要有前提的规划；

执行过程：
将已有编排好的任务集写入Ansible-Playbook

通过ansible-playbook命令分拆任务集至逐条ansible命令，按预定规则逐条执行。
</code></pre>
<p>1.4 ansible注意事项</p>
<pre><code>执行ansible的主机一般称为主控端，中控，master或堡垒机；
主控端Python版本需要2.6或以上；
被控端Python版本小于2.4需要安装python-simplejson；
被控端如开启SELinux需要安装libselinux-python；
windows不能做为主控端；
建议使用ssh的秘钥验证方式管理被控主机；
</code></pre>
<p>来自 <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c82737b5485c">https://www.jianshu.com/p/c82737b5485c</a></p>
<p>ansible是一种自动化运维工具,基于paramiko开发的,并且基于模块化工作，Ansible是一种集成IT系统的配置管理、应用部署、执行特定任务的开源平台，它是基于python语言，由Paramiko和PyYAML两个关键模块构建。集合了众多运维工具的优点，实现了批量系统配置、批量程序部署、批量运行命令等功能.ansible是基于模块工作的,本身没有批量部署的能力.真正具有批量部署的是ansible所运行的模块，ansible只是提供一种框架.ansible不需要在远程主机上安装client&#x2F;agents，因为它们是基于ssh来和远程主机通讯的.</p>
<p>1.1 ansible基本架构<br>ansible系统由控制主机和被管理主机组成,控制主机不支持windows平台</p>
<p><a target="_blank" rel="noopener" href="https://upload-images.jianshu.io/upload_images/6078939-1799907d732a3e87.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/885/format/webp">https://upload-images.jianshu.io/upload_images/6078939-1799907d732a3e87.png?imageMogr2/auto-orient/strip|imageView2/2/w/885/format/webp</a></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://upload-images.jianshu.io/upload_images/6078939-1799907d732a3e87.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/885/format/webp" alt="ansible基本架构"></p>
<pre><code>核心: ansible
Core Modules: ansible自带的模块
Custom Modules: 核心模块功能不足时,用户可以添加扩展模块
Plugins: 通过插件来实现记录日志,发送邮件或其他功能
Playbooks: 剧本,YAML格式文件，多个任务定义在一个文件中，定义主机需要调用哪些模块来完成的功能
Connectior Plugins: ansible基于连接插件连接到各个主机上,默认是使用ssh
Host Inventory: 记录由Ansible管理的主机信息，包括端口、密码、ip等
</code></pre>
<p>1.2 ansible特点</p>
<p>部署简单, 只需要在控制主机上部署ansible环境,被控制端上只要求安装ssh和python 2.5以上版本,这个对于类unix系统来说相当与无需配置.</p>
<pre><code>no angents: 被管控节点无需安装agent
no server: 无服务端,使用是直接调用命名
modules in any languages: 基于模块工作, 可以使用任意语言开发模块
易读的语法: 基于yaml语法编写playbook
基于推送模式: 不同于puppet的拉取模式,直接由调用者控制变更在服务器上发生的时间
模块是幂等性的:定义的任务已存在则不会做任何事情,意味着在同一台服务器上多次执行同一个playbook是安全的
</code></pre>
<p>1.3 ansible程序目录结构:</p>
<pre><code>配置文件: /etc/ansible/
执行文件目录: /usr/bin/
lib依赖库: /usr/lib/python2.7/site-packages/ansible/
help文件: /usr/lib/python2.7/site-packages/ansible
</code></pre>
<p>2.ansible任务执行</p>
<p>2.1 ansible任务执行模式</p>
<p>Ansible任务执行模式分为以下两种:</p>
<pre><code>ad-hoc模式(点对点模块)  使用单个模块,支持批量执行单条命令,相当与在bash中执行一句shell命令
playbook模式(剧本模式)  ansible主要的管理方式,通过多个task的集合完成一类功能,可以理解为多个ad-hoc的配置文件
</code></pre>
<p>2.2 ansible执行流程:</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://upload-images.jianshu.io/upload_images/6078939-2d6e5a817186480d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/547/format/webp" alt="ansible执行流程"></p>
<h1 id="2-ansible使用安装"><a href="#2-ansible使用安装" class="headerlink" title="2 ansible使用安装"></a>2 ansible使用安装</h1><pre><code>Ansible 是一种安装在控制节点上的无代理自动化工具。
Ansible 是一个无代理自动化工具，您可以安装在控制节点上。
Ansible 从控制节点远程管理机器和其他设备（默认情况下，通过 SSH 协议)。 
要安装 Ansible 以在命令行中使用，只需在一台机器上安装 Ansible 包（很容易就是一台笔记本电脑)。 您不需要安装数据库或运行任何守护程序。 Ansible 可以从一个控制节点管理一整套远程机器。 

控制节点需要 安装 python 和对应的 ansible 工具

被控制节点需要 python
尽管您的托管节点上不需要守护进程，但您确实需要一种 Ansible 与它们进行通信的方式。 对于大多数受管节点，Ansible 通过 SSH 建立连接并使用 SFTP 传输模块。 如果 SSH 有效但 SFTP 在您的某些受管节点上不可用，您可以在 ansible.cfg 中切换到 SCP。 对于任何可以运行 Python 的机器或设备，您还需要 Python 2（版本 2.6 或更高版本)或 Python 3（版本 3.5 或更高版本)。 
</code></pre>
<p>1 编译安装 </p>
<p>ansible依赖于Python 2.6或更高的版本、paramiko、PyYAML及Jinja2。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># yum -y install python-jinja2 PyYAML python-paramiko python-babel python-crypto</span><br><span class="line"># tar xf ansible-1.5.4.tar.gz</span><br><span class="line"># cd ansible-1.5.4</span><br><span class="line"># python setup.py build</span><br><span class="line"># python setup.py install</span><br><span class="line"># mkdir /etc/ansible</span><br><span class="line"># cp -r examples/* /etc/ansible</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>2 Ubuntu上安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$ sudo apt update</span><br><span class="line">$ sudo apt install software-properties-common</span><br><span class="line">$ sudo add-apt-repository --yes --update ppa:ansible/ansible</span><br><span class="line">$ sudo apt install ansible</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Ubuntu上安装20.04上面安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ansible@ansible:~$ sudo apt install ansible</span><br><span class="line">Reading package lists... Done</span><br><span class="line">Building dependency tree</span><br><span class="line">Reading state information... Done</span><br><span class="line">The following additional packages will be installed:</span><br><span class="line">  ieee-data python3-argcomplete python3-crypto python3-dnspython python3-jmespath python3-kerberos python3-libcloud python3-lockfile python3-netaddr python3-ntlm-auth python3-requests-kerberos python3-requests-ntlm python3-selinux python3-winrm python3-xmltodict</span><br><span class="line">Suggested packages:</span><br><span class="line">  cowsay sshpass python-lockfile-doc ipython3 python-netaddr-docs</span><br><span class="line">The following NEW packages will be installed:</span><br><span class="line">  ansible ieee-data python3-argcomplete python3-crypto python3-dnspython python3-jmespath python3-kerberos python3-libcloud python3-lockfile python3-netaddr python3-ntlm-auth python3-requests-kerberos python3-requests-ntlm python3-selinux python3-winrm python3-xmltodict</span><br><span class="line">0 upgraded, 16 newly installed, 0 to remove and 132 not upgraded.</span><br><span class="line">Need to get 9,644 kB of archives.</span><br><span class="line">After this operation, 90.2 MB of additional disk space will be used.</span><br><span class="line">Do you want to continue? [Y/n]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ansible@ansible:~$ ansible --version</span><br><span class="line">ansible 2.9.6</span><br><span class="line">  config file = /etc/ansible/ansible.cfg</span><br><span class="line">  configured module search path = [&#x27;/home/ansible/.ansible/plugins/modules&#x27;, &#x27;/usr/share/ansible/plugins/modules&#x27;]</span><br><span class="line">  ansible python module location = /usr/lib/python3/dist-packages/ansible</span><br><span class="line">  executable location = /usr/bin/ansible</span><br><span class="line">  python version = 3.8.10 (default, Sep 28 2021, 16:10:42) [GCC 9.3.0]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>3 conda 环境下安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">bin/conda create --name ansible python=3.8  # 创建个 3.8的python虚拟环境</span><br><span class="line"></span><br><span class="line">bin/conda install -n ansible -c conda-forge ansible  # 安装 ansible 模块</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>4centos 上安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> # wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo</span><br><span class="line"> # yum install ansible</span><br><span class="line">Installed:</span><br><span class="line">  ansible.noarch 0:2.9.23-1.el7</span><br><span class="line"> </span><br><span class="line">Dependency Installed:</span><br><span class="line">  PyYAML.x86_64 0:3.10-11.el7                libyaml.x86_64 0:0.1.4-11.el7_0                                 python-babel.noarch 0:0.9.6-8.el7          </span><br><span class="line">  python-backports.x86_64 0:1.0-8.el7        python-backports-ssl_match_hostname.noarch 0:3.5.0.1-1.el7      python-cffi.x86_64 0:1.6.0-5.el7           </span><br><span class="line">  python-enum34.noarch 0:1.0.4-1.el7         python-idna.noarch 0:2.4-1.el7                                  python-ipaddress.noarch 0:1.0.16-2.el7     </span><br><span class="line">  python-jinja2.noarch 0:2.7.2-4.el7         python-markupsafe.x86_64 0:0.11-10.el7                          python-paramiko.noarch 0:2.1.1-9.el7       </span><br><span class="line">  python-ply.noarch 0:3.4-11.el7             python-pycparser.noarch 0:2.14-1.el7                            python-setuptools.noarch 0:0.9.8-7.el7     </span><br><span class="line">  python-six.noarch 0:1.9.0-2.el7            python2-cryptography.x86_64 0:1.7.2-2.el7                       python2-httplib2.noarch 0:0.18.1-3.el7     </span><br><span class="line">  python2-jmespath.noarch 0:0.9.4-2.el7      python2-pyasn1.noarch 0:0.1.9-7.el7                            </span><br><span class="line"></span><br><span class="line">Complete!</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>5pip安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">pip是安装python的工具。</span><br><span class="line"></span><br><span class="line"># yum install python3 python3-devel python3-pip - y</span><br><span class="line"># pip3 install --upgrade pip -i https://pypi.douban.com/simple/ </span><br><span class="line"># pip3 install ansible -i https://pypi.douban.com/simple/ </span><br><span class="line"># /usr/local/bin/ansible --version</span><br><span class="line"></span><br><span class="line">查看ansible的安装信息，包括版本以及各种文件的路径</span><br><span class="line"># ansible --version</span><br><span class="line">ansible 2.9.23</span><br><span class="line">  config file = /etc/ansible/ansible.cfg</span><br><span class="line">  configured module search path = [u&#x27;/root/.ansible/plugins/modules&#x27;, u&#x27;/usr/share/ansible/plugins/modules&#x27;]</span><br><span class="line">  ansible python module location = /usr/lib/python2.7/site-packages/ansible</span><br><span class="line">  executable location = /usr/bin/ansible</span><br><span class="line">  python version = 2.7.5 (default, Apr  2 2020, 13:16:51) [GCC 4.8.5 20150623 (Red Hat 4.8.5-39)]</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ansible安装后修改配置文件</p>
<p>ansible与我们其他的服务在这一点上有很大不同，这里的配置文件查找是从多个地方找的，顺序如下：</p>
<pre><code>检查环境变量ANSIBLE_CONFIG指向的路径文件(export ANSIBLE_CONFIG=/etc/ansible.cfg)；
~/.ansible.cfg，检查当前目录下的ansible.cfg配置文件；
/etc/ansible.cfg检查etc目录的配置文件。
</code></pre>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Ansible 的配置文件可以存放在任何位置，但配置文件有读取顺序，查找顺序如下：</span><br><span class="line">        最先查找 $ANSIBLE_CONFIG 变量；</span><br><span class="line">        其次查找当前项目目录下 $PWD/ansible.cfg；</span><br><span class="line">        然后查找用户家目录下的 $HOME/.ansible.cfg；</span><br><span class="line">        最后查找 /etc/ansible/ansible.cfg；</span><br></pre></td></tr></table></figure>

<p>ansible 的配置文件为&#x2F;etc&#x2F;ansible&#x2F;ansible.cfg，主配置文件，配置 ansible 工作特性.ansible 有许多参数，下面我们列出一些常见的参数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">inventory = /etc/ansible/hosts		#这个参数表示资源清单inventory文件的位置</span><br><span class="line">library = /usr/share/ansible		#指向存放Ansible模块的目录，支持多个目录方式，只要用冒号（：)隔开就可以</span><br><span class="line">forks = 5		#并发连接数，默认为5</span><br><span class="line">sudo_user = root		#设置默认执行命令的用户</span><br><span class="line">remote_port = 22		#指定连接被管节点的管理端口，默认为22端口，建议修改，能够更加安全</span><br><span class="line">host_key_checking = False		#设置是否检查SSH主机的密钥，值为True/False。关闭后第一次连接不会提示配置实例</span><br><span class="line">timeout = 60		#设置SSH连接的超时时间，单位为秒</span><br><span class="line">log_path = /var/log/ansible.log		#指定一个存储ansible日志的文件（默认不记录日志)</span><br></pre></td></tr></table></figure>
<p>ansible 的主配置文件存在 &#x2F;etc&#x2F;anible&#x2F;ansible.cfg ，其中大部分的配置内容无需进行修改；</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[defaults]</span><br><span class="line">#inventory = /etc/ansible/hosts  </span><br><span class="line">`主机清单配置文件`</span><br><span class="line">#library = /usr/share/my_modules/  </span><br><span class="line">`库文件存放目录，存放模块`</span><br><span class="line">#module_utils   = /usr/share/my_module_utils/  </span><br><span class="line">`用到的utils工具存放目录`</span><br><span class="line">#remote_tmp = $HOME/.ansible/tmp</span><br><span class="line">`临时py命令文件存放在远程主机目录，先把ansible执行的指令，先生成py程序，然后放在本地的目录里，然后再用ssh协议，将生成的py程序复制到被管理的机器remote_tmp目录下，复制过去后，拿出来执行，执行完毕后会将该程序删除`</span><br><span class="line">#local_tmp = $HOME/.ansible/tmp </span><br><span class="line">`本机的临时命令执行目录`</span><br><span class="line">#forks = 5 #</span><br><span class="line">`默认并发数`</span><br><span class="line">#poll_interval  = 15 </span><br><span class="line">`每隔15秒去查看对方的状态`</span><br><span class="line">#sudo_user = root </span><br><span class="line">`默认sudo 用户 `</span><br><span class="line">#ask_sudo_pass = True </span><br><span class="line">#ask_pass = True</span><br><span class="line">`每次执行ansible命令是否询问ssh密码`</span><br><span class="line">#remote_port = 22</span><br><span class="line">`客户端的ssh端口`</span><br><span class="line">#host_key_checking = False  </span><br><span class="line">`检查对应服务器的host_key，建议取消注释，用于取消第一次连接问yes|no，若设置为true，则没有输入过yes|no的主机不能使用ansible管理。</span><br><span class="line">#log_path=/var/log/ansible.log </span><br><span class="line">`日志文件，建议取消注释，可以记录日志`</span><br><span class="line"></span><br><span class="line">[privilege_escalation] #如果是普通用户则需要配置提权 </span><br><span class="line">#become=True </span><br><span class="line">#become_method=sudo </span><br><span class="line">#become_user=root </span><br><span class="line">#become_ask_pass=False</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>我的配置文件，我比较喜欢修改的几个选项，在自己的home目录下面配置个 .ansible.cfg 文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[defaults]           </span><br><span class="line">inventory       = ./hosts            #这样写就是 账号 home 目录下面</span><br><span class="line">remote_tmp      = /tmp/ansibletmpr</span><br><span class="line">local_tmp       = /tmp/ansibletmpl</span><br><span class="line">remote_user = ansible           # 这样要设置一下，不然ssh 连接被控节点 都是以 jenkins 账号去连接了          </span><br><span class="line">executable = /bin/bash </span><br><span class="line">[ssh_connection]   </span><br><span class="line">control_path_dir = /tmp/ansibletmpl/cp                           </span><br><span class="line">control_path = %(directory)s/ansible-ssh-%%h-%%p-%%r</span><br></pre></td></tr></table></figure>


<h1 id="ansible主机清单inventory介绍"><a href="#ansible主机清单inventory介绍" class="headerlink" title="ansible主机清单inventory介绍"></a>ansible主机清单inventory介绍</h1><p>在配置文件中，我们提到了资源清单，这个清单就是我们的主机清单，里面保存的是一些 ansible 需要连接管理的主机列表。我们可以来看看他的定义方式：</p>
<p>1、 直接指明主机地址或主机名：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">## green.example.com#</span><br><span class="line"># blue.example.com#</span><br><span class="line"># 192.168.100.1</span><br><span class="line"># 192.168.100.10</span><br></pre></td></tr></table></figure>

<p>2、 定义一个主机组[组名]把地址或主机名加进去</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[mysql_test]</span><br><span class="line">192.168.253.159</span><br><span class="line">192.168.253.160</span><br><span class="line">192.168.253.153</span><br><span class="line"></span><br><span class="line">可以将同一个主机同时归并到多个不同的组中，如192.168.169.129同时存在于[web]与[app]中：</span><br><span class="line"></span><br><span class="line">[web]</span><br><span class="line">192.168.169.128</span><br><span class="line">192.168.169.129</span><br><span class="line">[app]</span><br><span class="line">192.168.169.130</span><br><span class="line">192.168.169.129</span><br><span class="line"></span><br><span class="line">支持主机名写法，并且支持通配符：</span><br><span class="line">[web]</span><br><span class="line">www[01:50].example.com       &lt;==支持通配符匹配www01 www02 ...www50</span><br><span class="line"></span><br><span class="line">当如若目标主机使用了非默认的SSH端口，还可以在主机名称之后使用冒号加端口号来标明：</span><br><span class="line">[web]</span><br><span class="line">www.example.com:2222</span><br></pre></td></tr></table></figure>

<p>可以使用基于用户名密码的方式连接被控主机，可以在主机清单中定义被控主机的用户名密码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[webservers] </span><br><span class="line">10.0.0.31 ansible_ssh_port=22 ansible_ssh_user=root ansible_ssh_pass=&#x27;123456&#x27; </span><br><span class="line">10.0.0.41 ansible_ssh_port=22 ansible_ssh_user=root ansible_ssh_pass=&#x27;123456&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">(ansible) ansible@jenkins-master:~$ cat tools/ansible/inventory.conf</span><br><span class="line"># This is the default ansible &#x27;hosts&#x27; file.</span><br><span class="line">#</span><br><span class="line"># It should live in /etc/ansible/hosts</span><br><span class="line">#</span><br><span class="line">#   - Comments begin with the &#x27;#&#x27; character</span><br><span class="line">#   - Blank lines are ignored</span><br><span class="line">#   - Groups of hosts are delimited by [header] elements</span><br><span class="line">#   - You can enter hostnames or ip addresses</span><br><span class="line">#   - A hostname/ip can be a member of multiple groups</span><br><span class="line"></span><br><span class="line"># Ex 1: Ungrouped hosts, specify before any group headers:</span><br><span class="line"></span><br><span class="line">## green.example.com</span><br><span class="line">## blue.example.com</span><br><span class="line">## 192.168.100.1</span><br><span class="line">## 192.168.100.10</span><br><span class="line"></span><br><span class="line"># Ex 2: A collection of hosts belonging to the &#x27;webservers&#x27; group:</span><br><span class="line"></span><br><span class="line">## [webservers]</span><br><span class="line">## alpha.example.org</span><br><span class="line">## beta.example.org</span><br><span class="line">## 192.168.1.100</span><br><span class="line">## 192.168.1.110</span><br><span class="line"></span><br><span class="line"># If you have multiple hosts following a pattern, you can specify</span><br><span class="line"># them like this:</span><br><span class="line"></span><br><span class="line">## www[001:006].example.com</span><br><span class="line"></span><br><span class="line"># Ex 3: A collection of database servers in the &#x27;dbservers&#x27; group:</span><br><span class="line"></span><br><span class="line">## [dbservers]</span><br><span class="line">##</span><br><span class="line">## db01.intranet.mydomain.net</span><br><span class="line">## db02.intranet.mydomain.net</span><br><span class="line">## 10.25.1.56</span><br><span class="line">## 10.25.1.57</span><br><span class="line"></span><br><span class="line"># Here&#x27;s another example of host ranges, this time there are no</span><br><span class="line"># leading 0s:</span><br><span class="line"></span><br><span class="line">## db-[99:101]-node.example.com</span><br><span class="line"></span><br><span class="line">[bf]</span><br><span class="line">192.168.xxxxxx.[31:45]</span><br><span class="line">192.168.xxxxxx.[31:48]</span><br><span class="line"></span><br><span class="line">[gb]</span><br><span class="line">192.168.xxxxxx.[46:90]</span><br><span class="line"></span><br><span class="line">[app]</span><br><span class="line">192.168.xxxxxx.101</span><br><span class="line">192.168.xxxxxx.98</span><br><span class="line">192.168.xxxxxx.99</span><br><span class="line"></span><br><span class="line">[bfdocker]</span><br><span class="line">192.168.xxxxxx.[93:97]</span><br><span class="line">[anbf]</span><br><span class="line">192.168.xxxxxx.[98:100]</span><br><span class="line"></span><br><span class="line">[rmsh]</span><br><span class="line">192.168.xxxxxx.[111:142]</span><br><span class="line">192.168.xxxxxx.[145:150]</span><br><span class="line"></span><br><span class="line">[rmnj]</span><br><span class="line">192.168.xxxxxx.[211:217]</span><br><span class="line">[rmsz]</span><br><span class="line">192.168.xxxxxx.[171:176]</span><br><span class="line"></span><br><span class="line">[core]</span><br><span class="line">192.168.xxxxxx.xxx</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>




<h1 id="ansible-常用命令介绍"><a href="#ansible-常用命令介绍" class="headerlink" title="ansible 常用命令介绍"></a>ansible 常用命令介绍</h1><p>0.总览介绍</p>
<pre><code>/usr/bin/ansible　　Ansibe AD-Hoc 临时命令执行工具，常用于临时命令的执行
/usr/bin/ansible-doc 　　Ansible 模块功能查看工具
/usr/bin/ansible-galaxy　　下载/上传优秀代码或Roles模块 的官网平台，基于网络的
/usr/bin/ansible-playbook　　Ansible 定制自动化的任务集编排工具
/usr/bin/ansible-pull　　Ansible远程执行命令的工具，拉取配置而非推送配置（使用较少，海量机器时使用，对运维的架构能力要求较高)
/usr/bin/ansible-vault　　Ansible 文件加密工具
/usr/bin/ansible-console　　Ansible基于Linux Consoble界面可与用户交互的命令执行工具
其中，我们比较常用的是/usr/bin/ansible和/usr/bin/ansible-playbook。

ansible-doc 命令常用于获取模块信息及其使用帮助，一般用法如下：
ansible-doc -l				#获取全部模块的信息
ansible-doc -s MOD_NAME		#获取指定模块的使用帮助
</code></pre>
<p>1.ansible 命令详解</p>
<p>ansible 命令详解　　命令的具体格式如下：c</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">    ansible &lt;host-pattern&gt; [-f forks] [-m module_name] [-a args]</span><br><span class="line"></span><br><span class="line">-a MODULE_ARGS　　　#模块的参数，如果执行默认COMMAND的模块，即是命令参数，如： “date”，“pwd”等等</span><br><span class="line">-k，--ask-pass	#ask for SSH password。登录密码，提示输入SSH密码而不是假设基于密钥的验证</span><br><span class="line">--ask-su-pass	#ask for su password。su切换密码</span><br><span class="line">-K，--ask-sudo-pass	#ask for sudo password。提示密码使用sudo，sudo表示提权操作</span><br><span class="line">--ask-vault-pass	#ask for vault password。假设我们设定了加密的密码，则用该选项进行访问</span><br><span class="line">-B SECONDS	#后台运行超时时间</span><br><span class="line">-C	#模拟运行环境并进行预运行，可以进行查错测试</span><br><span class="line">-c CONNECTION	#连接类型使用</span><br><span class="line">-f FORKS	#并行任务数，默认为5</span><br><span class="line">-i INVENTORY	#指定主机清单的路径，默认为/etc/ansible/hosts</span><br><span class="line">--list-hosts	#查看有哪些主机组</span><br><span class="line">-m MODULE_NAME	#执行模块的名字，默认使用 command 模块，所以如果是只执行单一命令可以不用 -m参数</span><br><span class="line">-o	#压缩输出，尝试将所有结果在一行输出，一般针对收集工具使用</span><br><span class="line">-S	#用 su 命令</span><br><span class="line">-R SU_USER	#指定 su 的用户，默认为 root 用户</span><br><span class="line">-s	#用 sudo 命令</span><br><span class="line">-U SUDO_USER	#指定 sudo 到哪个用户，默认为 root 用户</span><br><span class="line">-T TIMEOUT	#指定 ssh 默认超时时间，默认为10s，也可在配置文件中修改</span><br><span class="line">-u REMOTE_USER	#远程用户，默认为 root 用户</span><br><span class="line">-v	#查看详细信息，同时支持-vvv，-vvvv可查看更详细信息</span><br></pre></td></tr></table></figure>

<p>ansible-doc 命令常用于获取模块信息及其使用帮助，一般用法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># ansible-doc</span><br><span class="line">Usage: ansible-doc [options] [module...]</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -h, --help            show this help message and exit　　# 显示命令参数API文档</span><br><span class="line">  -l, --list            List available modules　　#列出可用的模块</span><br><span class="line">  -M MODULE_PATH, --module-path=MODULE_PATH　　#指定模块的路径</span><br><span class="line">                        specify path(s) to module library (default=None)</span><br><span class="line">  -s, --snippet         Show playbook snippet for specified module(s)　　#显示playbook制定模块的用法</span><br><span class="line">  -v, --verbose         verbose mode (-vvv for more, -vvvv to enable　　# 显示ansible-doc的版本号查看模块列表：</span><br><span class="line">                        connection debugging)</span><br><span class="line">  --version             show program&#x27;s version number and exit</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">查看shell模块的帮助信息：</span><br><span class="line">ansible-doc shell </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">查看模块的简要说明，主要包括用法和选项：</span><br><span class="line">ansible-doc -s shell</span><br><span class="line"></span><br><span class="line">查看ansible共加载了多少模块：</span><br><span class="line">ansible-doc -l | wc -l</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ansible-playbook 功能：用于执行配置好的剧本。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ansible-playbook &lt;filename.yml&gt; ... [options]</span><br><span class="line"></span><br><span class="line">-C，--check 	只检测可能会发生的改变，但不真正执行操作</span><br><span class="line">--list-hosts 	列出运行任务的主机</span><br><span class="line">--limit 主机列表 	只针对主机列表中的主机执行</span><br><span class="line">-v 	显示过程 -vv -vvv 更详细</span><br><span class="line">--syntax-check 	检查语法</span><br><span class="line">-e 	向playbook命令中传递变量</span><br><span class="line">-i 	指定inventory主机清单文件，默认为/etc/ansible/roles</span><br><span class="line"></span><br><span class="line">#只检测</span><br><span class="line">ansible-playbook file.yml --check</span><br><span class="line"></span><br><span class="line">#执行剧本</span><br><span class="line">ansible-playbook file.yml</span><br><span class="line"></span><br><span class="line">#执行剧本，只针对hosts中的websrvs组</span><br><span class="line">ansible-playbook file.yml --limit websrvss</span><br></pre></td></tr></table></figure>

<p>ansible-galaxy 主要功能：管理从 <a target="_blank" rel="noopener" href="https://galaxy.ansible.com/">https://galaxy.ansible.com</a> 下载的各种roles</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">列出所有已安装的galaxy</span><br><span class="line">ansible-galaxy list</span><br><span class="line"># /root/.ansible/roles</span><br><span class="line">- geerlingguy.apache, 3.1.4</span><br><span class="line"># /usr/share/ansible/roles</span><br><span class="line"># /etc/ansible/roles</span><br><span class="line"></span><br><span class="line">安装galaxy</span><br><span class="line"> ansible-galaxy install geerlingguy.apache</span><br><span class="line">- downloading role &#x27;apache&#x27;, owned by geerlingguy</span><br><span class="line">- downloading role from https://github.com/geerlingguy/ansible-role-apache/archive/3.1.4.tar.gz</span><br><span class="line">- extracting geerlingguy.apache to /root/.ansible/roles/geerlingguy.apache</span><br><span class="line">- geerlingguy.apache (3.1.4) was installed successfully</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">删除galaxy</span><br><span class="line">ansible-galaxy remove geerlingguy.apache</span><br><span class="line">- successfully removed geerlingguy.apache</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ansible-console 2.0+新增，可交互执行命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">ansible-console</span><br><span class="line"></span><br><span class="line">Welcome to the ansible console.</span><br><span class="line">Type help or ? to list commands.</span><br><span class="line"></span><br><span class="line">root@all (2)[f:5]# forks 5     &lt;==设置并发数</span><br><span class="line"></span><br><span class="line">root@all (2)[f:5]# cd NginxWebs   &lt;==切换主机组</span><br><span class="line"></span><br><span class="line">root@NginxWebs (2)[f:5]# list   &lt;==列出主机组的成员</span><br><span class="line">192.168.20.22</span><br><span class="line">192.168.20.23</span><br><span class="line"></span><br><span class="line">root@NginxWebs (2)[f:5]# shell df  &lt;==直接输入模块和服务名，不需要加-m和-a</span><br><span class="line">192.168.20.23 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">Filesystem              1K-blocks    Used Available Use% Mounted on</span><br><span class="line">devtmpfs                   485896       0    485896   0% /dev</span><br><span class="line">tmpfs                      497840       0    497840   0% /dev/shm</span><br><span class="line">tmpfs                      497840    7864    489976   2% /run</span><br><span class="line">tmpfs                      497840       0    497840   0% /sys/fs/cgroup</span><br><span class="line">/dev/mapper/centos-root  52403200 3284320  49118880   7% /</span><br><span class="line">/dev/sda1                 1038336  139940    898396  14% /boot</span><br><span class="line">/dev/mapper/centos-home 154057220  119636 153937584   1% /data</span><br><span class="line">tmpfs                       99572       0     99572   0% /run/user/0</span><br><span class="line">192.168.20.22 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">Filesystem              1K-blocks    Used Available Use% Mounted on</span><br><span class="line">devtmpfs                   485896       0    485896   0% /dev</span><br><span class="line">tmpfs                      497840       0    497840   0% /dev/shm</span><br><span class="line">tmpfs                      497840    7924    489916   2% /run</span><br><span class="line">tmpfs                      497840       0    497840   0% /sys/fs/cgroup</span><br><span class="line">/dev/mapper/centos-root  52403200 3338584  49064616   7% /</span><br><span class="line">/dev/sda1                 1038336  139940    898396  14% /boot</span><br><span class="line">/dev/mapper/centos-home 154057220  202628 153854592   1% /data</span><br><span class="line">tmpfs                       99572       0     99572   0% /run/user/0</span><br><span class="line"></span><br><span class="line">root@NginxWebs (2)[f:5]# help    &lt;==列出所有的内置命令</span><br><span class="line"></span><br><span class="line">Documented commands (type help &lt;topic&gt;):</span><br><span class="line">========================================</span><br><span class="line">EOF</span><br><span class="line">a10</span><br><span class="line">a10_server</span><br><span class="line">a10_server_axapi3</span><br><span class="line">a10_service_group</span><br><span class="line">a10_virtual_server</span><br><span class="line">accelerate</span><br><span class="line">aci</span><br><span class="line">......</span><br><span class="line"></span><br></pre></td></tr></table></figure>


</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://magesfc.github.io">mage</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://magesfc.github.io/mage/3988ad506287c3c5ea81a4669e671c026ed1520e/">https://magesfc.github.io/mage/3988ad506287c3c5ea81a4669e671c026ed1520e/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://magesfc.github.io" target="_blank">马哥私房菜</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ansible/">ansible</a></div><div class="post_share"><div class="social-share" data-image="https://t.mwm.moe/fj/" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="/null" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="/null" alt="支付寶"/></a><div class="post-qr-code-desc">支付寶</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/mage/c17549d1cd4516fc242a8551d78cc1754d69a33e/"><img class="prev-cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Ansible自动化运维工具之常用的模块</div></div></a></div><div class="next-post pull-right"><a href="/mage/531887d5e7eb014078dd6f2951d13500e0551ca5/"><img class="next-cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Ansible自动化运维工具之playbook介绍</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/mage/9797fe175c0183a6563e7397692d780ecf683a6f/" title="Ansible自动化运维工具之ansible-resources"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-16</div><div class="title">Ansible自动化运维工具之ansible-resources</div></div></a></div><div><a href="/mage/531887d5e7eb014078dd6f2951d13500e0551ca5/" title="Ansible自动化运维工具之playbook介绍"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-04</div><div class="title">Ansible自动化运维工具之playbook介绍</div></div></a></div><div><a href="/mage/c480dbde40d58e354795a1a408fdb8bad06fe7cc/" title="Ansible自动化运维工具之role介绍"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-01</div><div class="title">Ansible自动化运维工具之role介绍</div></div></a></div><div><a href="/mage/a0bfcc2b49b5167196ecf1ed7f20f9eb180d9a43/" title="Ansible自动化运维工具之synchronize模块学习"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-13</div><div class="title">Ansible自动化运维工具之synchronize模块学习</div></div></a></div><div><a href="/mage/c17549d1cd4516fc242a8551d78cc1754d69a33e/" title="Ansible自动化运维工具之常用的模块"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-04</div><div class="title">Ansible自动化运维工具之常用的模块</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">mage</div><div class="author-info__description"> 这里是 马哥 的个人博客 </div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">217</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">233</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">40</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/mamh2021"><i class="fab fa-github"></i><span>GitHub</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/mamh2021" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ansible"><span class="toc-number">1.</span> <span class="toc-text">ansible</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-ansible%E6%A6%82%E8%BF%B0%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.</span> <span class="toc-text">1 ansible概述介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-ansible%E4%BD%BF%E7%94%A8%E5%AE%89%E8%A3%85"><span class="toc-number">3.</span> <span class="toc-text">2 ansible使用安装</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ansible%E4%B8%BB%E6%9C%BA%E6%B8%85%E5%8D%95inventory%E4%BB%8B%E7%BB%8D"><span class="toc-number">4.</span> <span class="toc-text">ansible主机清单inventory介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ansible-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E4%BB%8B%E7%BB%8D"><span class="toc-number">5.</span> <span class="toc-text">ansible 常用命令介绍</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/mage/ee6e53b9fbe2f10991d150675f0b88ed427b1150/" title="Android下的配置管理之道之repo-diffmanifests源码分析"><img src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android下的配置管理之道之repo-diffmanifests源码分析"/></a><div class="content"><a class="title" href="/mage/ee6e53b9fbe2f10991d150675f0b88ed427b1150/" title="Android下的配置管理之道之repo-diffmanifests源码分析">Android下的配置管理之道之repo-diffmanifests源码分析</a><time datetime="2024-05-18T03:58:53.000Z" title="更新于 2024-05-18 11:58:53">2024-05-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/a52bd2f9ab320c603de205368472b5caa19b7207/" title="Android下的配置管理之道之repo-sync源码分析"><img src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android下的配置管理之道之repo-sync源码分析"/></a><div class="content"><a class="title" href="/mage/a52bd2f9ab320c603de205368472b5caa19b7207/" title="Android下的配置管理之道之repo-sync源码分析">Android下的配置管理之道之repo-sync源码分析</a><time datetime="2024-05-18T02:15:08.000Z" title="更新于 2024-05-18 10:15:08">2024-05-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/0bd8125569ad5e0222f4ca4e90e626be2ee24c26/" title="Jenkins学习之DataBoundConstructor和DataBoundSetter"><img src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Jenkins学习之DataBoundConstructor和DataBoundSetter"/></a><div class="content"><a class="title" href="/mage/0bd8125569ad5e0222f4ca4e90e626be2ee24c26/" title="Jenkins学习之DataBoundConstructor和DataBoundSetter">Jenkins学习之DataBoundConstructor和DataBoundSetter</a><time datetime="2024-03-31T06:28:23.000Z" title="更新于 2024-03-31 14:28:23">2024-03-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/4b00a873b39948044a79c7e53eedd63d7af0bfa6/" title="Docker学习之安装docker-swarm集群"><img src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Docker学习之安装docker-swarm集群"/></a><div class="content"><a class="title" href="/mage/4b00a873b39948044a79c7e53eedd63d7af0bfa6/" title="Docker学习之安装docker-swarm集群">Docker学习之安装docker-swarm集群</a><time datetime="2024-03-31T06:28:19.000Z" title="更新于 2024-03-31 14:28:19">2024-03-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/44f033ce59a71a67f64e3c2e330151f82f8754f4/" title="Jenkins学习之master服务器安装使用docker安装"><img src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Jenkins学习之master服务器安装使用docker安装"/></a><div class="content"><a class="title" href="/mage/44f033ce59a71a67f64e3c2e330151f82f8754f4/" title="Jenkins学习之master服务器安装使用docker安装">Jenkins学习之master服务器安装使用docker安装</a><time datetime="2024-03-24T03:25:01.000Z" title="更新于 2024-03-24 11:25:01">2024-03-24</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://t.mwm.moe/fj/')"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By mage</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>