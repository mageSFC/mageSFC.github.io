<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹å¸¸ç”¨çš„æ¨¡å— | é©¬å“¥ç§æˆ¿èœ</title><meta name="author" content="mage"><meta name="copyright" content="mage"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ansible å¸¸ç”¨æ¨¡å—ansible å¸¸ç”¨æ¨¡å—1)pingæ¨¡å—ä¸»æœºè¿é€šæ€§æµ‹è¯• æˆ‘ä»¬ä½¿ç”¨ansible web -m pingå‘½ä»¤æ¥è¿›è¡Œä¸»æœºè¿é€šæ€§æµ‹è¯•ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š 12345678910111213141516171819202122ansible@ansible:~$ ansible all -m ping 192.168.xxxxxx.92 | SUCCESS &#x3D;&gt; &amp;#123;">
<meta property="og:type" content="article">
<meta property="og:title" content="Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹å¸¸ç”¨çš„æ¨¡å—">
<meta property="og:url" content="https://magesfc.github.io/mage/c17549d1cd4516fc242a8551d78cc1754d69a33e/">
<meta property="og:site_name" content="é©¬å“¥ç§æˆ¿èœ">
<meta property="og:description" content="ansible å¸¸ç”¨æ¨¡å—ansible å¸¸ç”¨æ¨¡å—1)pingæ¨¡å—ä¸»æœºè¿é€šæ€§æµ‹è¯• æˆ‘ä»¬ä½¿ç”¨ansible web -m pingå‘½ä»¤æ¥è¿›è¡Œä¸»æœºè¿é€šæ€§æµ‹è¯•ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š 12345678910111213141516171819202122ansible@ansible:~$ ansible all -m ping 192.168.xxxxxx.92 | SUCCESS &#x3D;&gt; &amp;#123;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://t.mwm.moe/fj/">
<meta property="article:published_time" content="2022-04-04T03:38:58.000Z">
<meta property="article:modified_time" content="2022-10-31T08:44:04.000Z">
<meta property="article:author" content="mage">
<meta property="article:tag" content="ansible">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://t.mwm.moe/fj/"><link rel="shortcut icon" href="https://www.zeekrlife.com/favicon.png"><link rel="canonical" href="https://magesfc.github.io/mage/c17549d1cd4516fc242a8551d78cc1754d69a33e/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":150,"languages":{"author":"ä½œè€…: mage","link":"é“¾æ¥: ","source":"æ¥æº: é©¬å“¥ç§æˆ¿èœ","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹å¸¸ç”¨çš„æ¨¡å—',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-10-31 16:44:04'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><style type="text/css">.card-announcement .social-button{margin:.6rem 0 0 0;text-align:center}.card-announcement .social-button a{display:block;background-color:var(--btn-bg);color:var(--btn-color);text-align:center;line-height:2.4;margin:4px 0}.card-announcement .social-button a:hover{background-color:var(--btn-hover-color)}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">212</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">230</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">40</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> ç›®å½•</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> ç²¾é€‰æ–‡æ¡£</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/21cfbf15/"><span> ğŸš€ å¿«é€Ÿå¼€å§‹</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/dc584b87/"><span> ğŸ“‘ ä¸»é¢˜é¡µé¢</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4aa8abbe/"><span> ğŸ›  ä¸»é¢˜é…ç½®-1</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/ceeb73f/"><span> ğŸ›  ä¸»é¢˜é…ç½®-2</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/98d20436/"><span> â“ ä¸»é¢˜é—®ç­”</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4073eda/"><span> âš¡ï¸ è¿›é˜¶æ•™ç¨‹</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/198a4240/"><span> âœ¨ æ›´æ–°æ—¥å¿—</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://butterfly.js.org/link/"><i class="fa-fw fas fa-thumbs-up"></i><span> å…¶ä»–ç¤ºä¾‹</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://t.mwm.moe/fj/')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">é©¬å“¥ç§æˆ¿èœ</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-compass"></i><span> ç›®å½•</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i><span> ç²¾é€‰æ–‡æ¡£</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/21cfbf15/"><span> ğŸš€ å¿«é€Ÿå¼€å§‹</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/dc584b87/"><span> ğŸ“‘ ä¸»é¢˜é¡µé¢</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4aa8abbe/"><span> ğŸ›  ä¸»é¢˜é…ç½®-1</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/ceeb73f/"><span> ğŸ›  ä¸»é¢˜é…ç½®-2</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/98d20436/"><span> â“ ä¸»é¢˜é—®ç­”</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/4073eda/"><span> âš¡ï¸ è¿›é˜¶æ•™ç¨‹</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://butterfly.js.org/posts/198a4240/"><span> âœ¨ æ›´æ–°æ—¥å¿—</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://butterfly.js.org/link/"><i class="fa-fw fas fa-thumbs-up"></i><span> å…¶ä»–ç¤ºä¾‹</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹å¸¸ç”¨çš„æ¨¡å—</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2022-04-04T03:38:58.000Z" title="å‘è¡¨äº 2022-04-04 11:38:58">2022-04-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-10-31T08:44:04.000Z" title="æ›´æ–°äº 2022-10-31 16:44:04">2022-10-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ansible/">ansible</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹å¸¸ç”¨çš„æ¨¡å—"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="ansible-å¸¸ç”¨æ¨¡å—"><a href="#ansible-å¸¸ç”¨æ¨¡å—" class="headerlink" title="ansible å¸¸ç”¨æ¨¡å—"></a>ansible å¸¸ç”¨æ¨¡å—</h1><h1 id="ansible-å¸¸ç”¨æ¨¡å—-1"><a href="#ansible-å¸¸ç”¨æ¨¡å—-1" class="headerlink" title="ansible å¸¸ç”¨æ¨¡å—"></a>ansible å¸¸ç”¨æ¨¡å—</h1><h2 id="1-pingæ¨¡å—"><a href="#1-pingæ¨¡å—" class="headerlink" title="1)pingæ¨¡å—"></a>1)pingæ¨¡å—</h2><p>ä¸»æœºè¿é€šæ€§æµ‹è¯• æˆ‘ä»¬ä½¿ç”¨ansible web -m pingå‘½ä»¤æ¥è¿›è¡Œä¸»æœºè¿é€šæ€§æµ‹è¯•ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">ansible@ansible:~$ ansible all -m ping </span><br><span class="line">192.168.xxxxxx.92 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python3&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;changed&quot;: false,</span><br><span class="line">    &quot;ping&quot;: &quot;pong&quot;</span><br><span class="line">&#125;</span><br><span class="line">192.168.xxxxxx.114 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python3&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;changed&quot;: false,</span><br><span class="line">    &quot;ping&quot;: &quot;pong&quot;</span><br><span class="line">&#125;</span><br><span class="line">192.168.xxxxxx.87 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python3&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;changed&quot;: false,</span><br><span class="line">    &quot;ping&quot;: &quot;pong&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-commandæ¨¡å—"><a href="#2-commandæ¨¡å—" class="headerlink" title="2)commandæ¨¡å—"></a>2)commandæ¨¡å—</h2><p>è¿™ä¸ªæ¨¡å—å¯ä»¥ç›´æ¥åœ¨è¿œç¨‹ä¸»æœºä¸Šæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶å°†ç»“æœè¿”å›æœ¬ä¸»æœºã€‚</p>
<p>commandæ¨¡å—çš„å¸¸ç”¨å‚æ•°å¦‚ä¸‹ï¼š</p>
<pre><code>chdir           # åœ¨æ‰§è¡Œå‘½ä»¤ä¹‹å‰ï¼Œå…ˆåˆ‡æ¢åˆ°è¯¥ç›®å½•
executable      # åˆ‡æ¢shellæ¥æ‰§è¡Œå‘½ä»¤ï¼Œéœ€è¦ä½¿ç”¨å‘½ä»¤çš„ç»å¯¹è·¯å¾„
free_form       # è¦æ‰§è¡Œçš„LinuxæŒ‡ä»¤ï¼Œä¸€èˆ¬ä½¿ç”¨Ansibleçš„-aå‚æ•°ä»£æ›¿ã€‚
creates         # ä¸€ä¸ªæ–‡ä»¶åï¼Œå½“è¿™ä¸ªæ–‡ä»¶å­˜åœ¨ï¼Œåˆ™è¯¥å‘½ä»¤ä¸æ‰§è¡Œ,å¯ä»¥ç”¨æ¥åšåˆ¤æ–­
removes         # ä¸€ä¸ªæ–‡ä»¶åï¼Œè¿™ä¸ªæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™è¯¥å‘½ä»¤ä¸æ‰§è¡Œ
</code></pre>
<p>åŠŸèƒ½ï¼šåœ¨è¿œç¨‹ä¸»æœºæ‰§è¡Œ shell å‘½ä»¤ï¼›ä¸ºé»˜è®¤æ¨¡å—ï¼Œå¯çœç•¥ -m é€‰é¡¹ï¼›</p>
<p>æ³¨æ„ï¼šä¸æ”¯æŒç®¡é“å‘½ä»¤ |ï¼›</p>
<p>åœ¨è¢«æ§æœºå™¨ä¸Šæ‰§è¡Œ date å‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ansible@ansible:~$ ansible all -m command -a &#x27;date&#x27;</span><br><span class="line">192.168.xxx.92 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">Tue 07 Dec 2021 02:08:46 PM UTC</span><br><span class="line">192.168.xxx.87 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">Tue 07 Dec 2021 02:08:43 PM UTC</span><br><span class="line">192.168.xxx.114 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">Tue 07 Dec 2021 02:08:46 PM UTC</span><br></pre></td></tr></table></figure>

<p>åœ¨è¢«æ§æœºå™¨ä¸Š è®¾ç½®æ—¶åŒº</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ansible all -m command -a &#x27;sudo timedatectl set-timezone Asia/Shanghai&#x27;</span><br><span class="line">192.168.xxx.87 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line"></span><br><span class="line">192.168.xxx.92 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line"></span><br><span class="line">192.168.xxx.114 | CHANGED | rc=0 &gt;&gt;</span><br></pre></td></tr></table></figure>

<p>åœ¨è¢«æ§æœºå™¨ä¸Š æŸ¥çœ‹è®¾ç½®æ—¶åŒº</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ansible@ansible:~$ ansible all -m command -a &#x27;cat /etc/timezone&#x27;</span><br><span class="line">192.168.xxx.114 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">Asia/Shanghai</span><br><span class="line">192.168.xxx.87 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">Asia/Shanghai</span><br><span class="line">192.168.xxx.92 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">Asia/Shanghai</span><br></pre></td></tr></table></figure>

<p>å‘½ä»¤æ¨¡å—æ¥å—å‘½ä»¤åç§°ï¼Œåé¢æ˜¯ç©ºæ ¼åˆ†éš”çš„åˆ—è¡¨å‚æ•°ã€‚ç»™å®šçš„å‘½ä»¤å°†åœ¨æ‰€æœ‰é€‰å®šçš„èŠ‚ç‚¹ä¸Šæ‰§è¡Œã€‚<br>å®ƒä¸ä¼šé€šè¿‡shellè¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚$HOMEå’Œæ“ä½œå¦‚â€&lt;â€ï¼Œâ€&gt;â€ï¼Œâ€|â€ï¼Œâ€;â€ï¼Œâ€&amp;â€ å·¥ä½œï¼ˆéœ€è¦ä½¿ç”¨ï¼ˆshell)æ¨¡å—å®ç°è¿™äº›åŠŸèƒ½)ã€‚æ³¨æ„ï¼Œè¯¥å‘½ä»¤ä¸æ”¯æŒ| ç®¡é“å‘½ä»¤ã€‚<br>è¦æƒ³ä½¿ç”¨ ç®¡é“ ç­‰ç‰¹æ®Šçš„ç”¨æ³•ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ · åˆ©ç”¨  bash -c è¿™æ ·æ‰§è¡Œä¸€æ®µè„šæœ¬ä»£ç ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">ansible rmsz -m command -a &#x27;bash -c &quot;git config -l|grep push&quot;&#x27;</span><br><span class="line">192.168.xxx.173 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">url.ssh://gerrit.ansible.com.pushinsteadof=ssh://gerrit-sh.ansible.com</span><br><span class="line">url.ssh://gerrit.ansible.com.pushinsteadof=ssh://gerrit-sz.ansible.com</span><br><span class="line">url.ssh://gerrit.ansible.com.pushinsteadof=ssh://gerrit-nj.ansible.com</span><br><span class="line">192.168.xxx.175 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">url.ssh://gerrit.ansible.com.pushinsteadof=ssh://gerrit-sh.ansible.com</span><br><span class="line">url.ssh://gerrit.ansible.com.pushinsteadof=ssh://gerrit-sz.ansible.com</span><br><span class="line">url.ssh://gerrit.ansible.com.pushinsteadof=ssh://gerrit-nj.ansible.com</span><br><span class="line">192.168.xxx.172 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">url.ssh://gerrit.ansible.com.pushinsteadof=ssh://gerrit-sh.ansible.com</span><br><span class="line">url.ssh://gerrit.ansible.com.pushinsteadof=ssh://gerrit-sz.ansible.com</span><br><span class="line">url.ssh://gerrit.ansible.com.pushinsteadof=ssh://gerrit-nj.ansible.com</span><br><span class="line">192.168.xxx.171 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">url.ssh://gerrit.ansible.com.pushinsteadof=ssh://gerrit-sh.ansible.com</span><br><span class="line">url.ssh://gerrit.ansible.com.pushinsteadof=ssh://gerrit-sz.ansible.com</span><br><span class="line">url.ssh://gerrit.ansible.com.pushinsteadof=ssh://gerrit-nj.ansible.com</span><br><span class="line">192.168.xxx.174 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">url.ssh://gerrit.ansible.com.pushinsteadof=ssh://gerrit-sh.ansible.com</span><br><span class="line">url.ssh://gerrit.ansible.com.pushinsteadof=ssh://gerrit-sz.ansible.com</span><br><span class="line">url.ssh://gerrit.ansible.com.pushinsteadof=ssh://gerrit-nj.ansible.com</span><br><span class="line">192.168.xxx.176 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">url.ssh://gerrit.ansible.com.pushinsteadof=ssh://gerrit-sh.ansible.com</span><br><span class="line">url.ssh://gerrit.ansible.com.pushinsteadof=ssh://gerrit-sz.ansible.com</span><br><span class="line">url.ssh://gerrit.ansible.com.pushinsteadof=ssh://gerrit-nj.ansible.com</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ansible rmsz -m command -a &#x27;git config -l|grep push&#x27;</span><br><span class="line">ç›´æ¥è¿™æ ·æ‰§è¡Œ æ˜¯ä¸è¡Œçš„ï¼ï¼ï¼</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ç¤ºä¾‹ä¸€ï¼šcommandæ¨¡å—åŸºç¡€ç”¨æ³•ï¼Œåœ¨è¿œç«¯ä¸»æœºæ‰§è¡Œå‘½ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ansible 192.168.20.22 -a &quot;id&quot;</span><br><span class="line">192.168.20.22 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹äºŒï¼šåœ¨è¢«æ§ç«¯ä¸»æœºåˆ‡æ¢åˆ°æŒ‡å®šç›®å½•ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ansible 192.168.20.22 -a &quot;chdir=/tmp pwd&quot;</span><br><span class="line">192.168.20.22 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">/tmp</span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹ä¸‰ï¼šcreatesï¼šæŒ‡å®šçš„æ–‡ä»¶å­˜åœ¨æ—¶ï¼Œä¸æ‰§è¡Œå¯¹åº”å‘½ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ansible 192.168.20.22 -a &quot;creates=/etc/passwd ls&quot;</span><br><span class="line">192.168.20.22 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">skipped, since /etc/passwd exists   &lt;==è·³è¿‡ï¼Œæœªæ‰§è¡Œï¼›</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹å››ï¼šremovesï¼šä¸createsç›¸åï¼ŒæŒ‡å®šçš„æ–‡ä»¶å­˜åœ¨ï¼Œåˆ™æ‰§è¡Œå¯¹åº”å‘½ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ansible 192.168.20.22 -a &quot;removes=/etc/passwd ls&quot;</span><br><span class="line">192.168.20.22 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">anaconda-ks.cfg</span><br><span class="line">apache-tomcat-10.0.7.tar.gz</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="3-shellæ¨¡å—"><a href="#3-shellæ¨¡å—" class="headerlink" title="3)shellæ¨¡å—"></a>3)shellæ¨¡å—</h2><p>shellæ¨¡å—å¯ä»¥åœ¨è¿œç¨‹ä¸»æœºä¸Šè°ƒç”¨shellè§£é‡Šå™¨è¿è¡Œå‘½ä»¤ï¼Œæ”¯æŒshellçš„å„ç§åŠŸèƒ½ï¼Œä¾‹å¦‚ç®¡é“ç­‰ã€‚</p>
<p>åŠŸèƒ½ï¼šåœ¨è¿œç¨‹ä¸»æœºæ‰§è¡Œ Shell å‘½ä»¤ï¼Œæ”¯æŒç®¡é“ç­‰ç‰¹æ®Šç¬¦å·çš„æ“ä½œï¼Œæ¯”commandæ¨¡å—ä½¿ç”¨å¹¿æ³›ï¼›</p>
<p> shellæ¨¡å—çš„å¸¸ç”¨å‚æ•°å¦‚ä¸‹ï¼š</p>
<pre><code>chdir DIR 	æ‰§è¡Œansibleæ—¶ï¼Œåˆ‡æ¢åˆ°æŒ‡å®šçš„ç›®å½•
creates FILE 	å¦‚æœæ–‡ä»¶FILEå­˜åœ¨ï¼Œåˆ™ä¸æ‰§è¡Œå‘½ä»¤
removes FILE 	å¦‚æœæ–‡ä»¶FILEå­˜åœ¨ï¼Œåˆ™æ‰§è¡Œå‘½ä»¤
</code></pre>
<p>shellæ¨¡å—æ”¯æŒç®¡é“å‘½ä»¤ï¼Œåœ¨è¢«æ§ä¸»æœºä¸Šåˆ›å»ºç”¨æˆ·å’Œå¯†ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ansible 192.168.20.22 -m shell -a &#x27;useradd xxx&#x27;</span><br><span class="line">192.168.20.22 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line"></span><br><span class="line">ansible 192.168.20.22 -m shell -a &#x27;echo 123456 | passwd --stdin xxx&#x27;</span><br><span class="line">192.168.20.22 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">Changing password for user xxx.</span><br><span class="line">passwd: all authentication tokens updated successfully.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼šè°ƒç”¨bashæ‰§è¡Œå‘½ä»¤ ç±»ä¼¼cat &#x2F;tmp&#x2F;stanley.md | awk -Fâ€™|â€™ â€˜{print $1,$2}â€™ &amp;&gt; &#x2F;tmp&#x2F;example.txtè¿™äº›å¤æ‚å‘½ä»¤ï¼Œå³ä½¿ä½¿ç”¨shellä¹Ÿå¯èƒ½ä¼šå¤±è´¥ï¼Œè§£å†³åŠæ³•ï¼šå†™åˆ°è„šæœ¬ä¸­ï¼Œcopyåˆ°è¿œç¨‹ï¼Œæ‰§è¡Œï¼Œå†æŠŠéœ€è¦çš„ç»“æœæ‹‰å›æ‰§è¡Œå‘½ä»¤çš„æœºå™¨ã€‚</p>
<p>æ³¨æ„ï¼šè™½ç„¶å¯ä»¥ä½¿ç”¨shellæ¨¡å—å®Œæˆç»å¤§å¤šæ•°æ“ä½œï¼Œä½†æ˜¯shellæ¨¡å—æ— æ³•å¾ˆå¥½çš„ä¿è¯ansibleçš„å¹‚ç­‰æ€§ï¼Œå› æ­¤å»ºè®®ä½¿ç”¨ä»¥ä¸‹å„ä¸ªä¸“ç”¨æ¨¡å—å®Œæˆç‰¹å®šçš„åŠŸèƒ½ï¼Œå¯ä»¥ä¿è¯å¹‚ç­‰æ€§ã€‚</p>
<h2 id="4-copyæ¨¡å—"><a href="#4-copyæ¨¡å—" class="headerlink" title="4)copyæ¨¡å—"></a>4)copyæ¨¡å—</h2><p>è¿™ä¸ªæ¨¡å—ç”¨äºå°†æ–‡ä»¶å¤åˆ¶åˆ°è¿œç¨‹ä¸»æœºï¼ŒåŒæ—¶æ”¯æŒç»™å®šå†…å®¹ç”Ÿæˆæ–‡ä»¶å’Œä¿®æ”¹æƒé™ç­‰ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">src 	å¤åˆ¶çš„æºæ–‡ä»¶è·¯å¾„ï¼Œè‹¥æºæ–‡ä»¶ä¸ºç›®å½•ï¼Œé»˜è®¤è¿›è¡Œé€’å½’å¤åˆ¶ï¼Œå¦‚æœè·¯åŠ²ä»¥â€œ/â€ç»“å°¾ï¼Œä»…ä¼šå¤åˆ¶ç›®å½•ä¸‹çš„å†…å®¹ï¼Œè¯¥ç›®å½•æœ¬èº«ä¸ä¼šå¤åˆ¶ï¼Œå¦‚æœè·¯å¾„ä¸å¸¦â€œ/â€ï¼Œç›®å½•æœ¬èº«å’Œç›®å½•ä¸‹çš„å†…å®¹ä¼šä¸€å¹¶å¤åˆ¶è¿‡å»ã€‚</span><br><span class="line">dest 	ç›®æ ‡ç»å¯¹è·¯å¾„ï¼Œå¦‚æœæºæ˜¯æ–‡ä»¶å¤¹ï¼Œç›®æ ‡ä¹Ÿå¿…é¡»æ˜¯æ–‡ä»¶å¤¹ï¼Œä¸å­˜åœ¨å°†åˆ›å»º</span><br><span class="line">backup 	å¦‚æœç›®æ ‡ä¸»æœºå·²ç»æœ‰æºæ–‡ä»¶ï¼Œä¼šäº‹å…ˆå¤‡ä»½ï¼Œé˜²æ­¢è¦†ç›–</span><br><span class="line">mode 	æ–‡ä»¶å¤åˆ¶åˆ°è¿œç¨‹å¹¶è®¾å®šæƒé™ï¼Œé»˜è®¤file=644ï¼Œdirectory=755</span><br><span class="line">owner 	æ–‡ä»¶å¤åˆ¶åˆ°è¿œç¨‹å¹¶è®¾å®šå±ä¸»ï¼Œé»˜è®¤ä¸ºroot</span><br><span class="line">group 	æ–‡ä»¶å¤åˆ¶åˆ°è¿œç¨‹å¹¶è®¾å®šå±ç»„ï¼Œé»˜è®¤ä¸ºroot</span><br><span class="line">content 	å°†ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼ŒæŒ‡å®šä¸ºcontentæ‰€å¸¦çš„å­—ç¬¦ä¸²</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>ç¤ºä¾‹ä¸€ï¼šæŠŠ&#x2F;data&#x2F;nginx&#x2F;html&#x2F;web01&#x2F;index.htmlå¤åˆ¶åˆ°è¢«æ§ä¸»æœº&#x2F;tmpç›®å½•ä¸‹ï¼Œå±ä¸»å±ç»„ä¸ºnginxï¼Œæƒé™ä¸º644ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># ansible NginxWebs -m copy -a &quot;src=/data/nginx/html/web01/index.html dest=/tmp owner=nginx group=nginx mode=644&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ll /tmp/index.html </span><br><span class="line">-rw-r--r-- 1 nginx nginx 7 Aug  1 11:16 /tmp/index.html</span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹äºŒï¼šå†æ¬¡å¤åˆ¶ä¸Šä¾‹æ–‡ä»¶ï¼Œå¹¶å¯¹åŸæ–‡ä»¶å¤‡ä»½ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># ansible NginxWebs -m copy -a &quot;src=/data/nginx/html/web01/index.html dest=/tmp owner=nginx group=nginx mode=644 backup=yes&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ll /tmp/index.html*</span><br><span class="line">-rw-r--r-- 1 nginx nginx 10 Aug  1 11:20 /tmp/index.html</span><br><span class="line">-rw-r--r-- 1 nginx nginx  7 Aug  1 11:16 /tmp/index.html.6043.2021-08-01@11:20:39~   &lt;==å¤‡ä»½çš„åŸæ–‡ä»¶</span><br></pre></td></tr></table></figure>

<p>å¾€è¿œç¨‹çš„ä¸»æœºæ–‡ä»¶ä¸­å†™å…¥å†…å®¹ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># ansible NginxWebs -m copy -a &quot;content=&quot;Http_Server\n&quot; dest=/var/www/html/index.html&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># cat /var/www/html/index.html </span><br><span class="line">Http_Server</span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹å››ï¼šå¤åˆ¶ç›®å½•åˆ°ç›®æ ‡ä¸»æœºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># ansible NginxWebs -m copy -a &quot;src=/root/test dest=/root&quot;</span><br><span class="line"></span><br><span class="line"># ll /root/test/</span><br><span class="line">total 4</span><br><span class="line">-rw-r--r-- 1 root root 3258 Aug  1 11:26 nginx.conf</span><br></pre></td></tr></table></figure>


<p>ç¤ºä¾‹ 5ï¼šå¤åˆ¶ç›®å½•åˆ°ç›®æ ‡ä¸»æœºï¼šç›®æ ‡ç›®å½•ä¸å­˜åœ¨ï¼Œç›®æ ‡ç›®å½•å¤šä¸€çº§ç›®å½•çš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ ansible 10.0.12.31 -m copy -a &#x27;src=./telegraf dest=/tmp/telegraf&#x27;</span><br><span class="line">10.0.12.31 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true,</span><br><span class="line">    &quot;dest&quot;: &quot;/tmp/telegraf/&quot;,</span><br><span class="line">    &quot;src&quot;: &quot;/home/buildfarm/./telegraf&quot;</span><br><span class="line">&#125;</span><br><span class="line">$ tree /tmp/telegraf/  # åœ¨ç›®æ ‡ æœºå™¨ä¸ŠæŸ¥çœ‹å‘ç° ç›®å½•ç»“æ„ æ˜¯ /tmp/telegraf/telegraf è¿™æ ·çš„ï¼Œæ˜¯æŠŠæºç›®å½•telegraf å¤åˆ¶åˆ° ç›®æ ‡ /tmp/telegraf ç›®å½•é‡Œé¢ äº†ã€‚ç›®æ ‡ç›®å½•ä¸å­˜åœ¨æ˜¯ä¼šè‡ªåŠ¨åˆ›å»ºçš„</span><br><span class="line">/tmp/telegraf/</span><br><span class="line">â””â”€â”€ telegraf</span><br><span class="line">    â”œâ”€â”€ telegraf</span><br><span class="line">    â”œâ”€â”€ telegraf.conf</span><br><span class="line">    â”œâ”€â”€ telegraf.log</span><br><span class="line">    â”œâ”€â”€ telegraf.pid</span><br><span class="line">    â”œâ”€â”€ telegraf.service</span><br><span class="line">    â””â”€â”€ telegraf.sh</span><br><span class="line"></span><br><span class="line">1 directory, 6 files</span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹ 6ï¼šå¤åˆ¶ç›®å½•åˆ°ç›®æ ‡ä¸»æœºï¼šç›®æ ‡ç›®å½•åªæœ‰ä¸€çº§ç›®å½•çš„ï¼Œ </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ ansible 10.0.12.31 -m copy -a &#x27;src=./telegraf dest=/tmp/&#x27;</span><br><span class="line">10.0.12.31 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true,</span><br><span class="line">    &quot;dest&quot;: &quot;/tmp/&quot;,</span><br><span class="line">    &quot;src&quot;: &quot;/home/buildfarm/./telegraf&quot;</span><br><span class="line">&#125;</span><br><span class="line">$ tree /tmp/telegraf/ # åœ¨ç›®æ ‡ æœºå™¨ä¸ŠæŸ¥çœ‹å‘ç°ï¼Œè¿™ä¸ªå’Œä¸Šé¢çš„ä¾‹å­å°±å¾ˆå¥½çš„å¯¹æ¯”å‡ºæ¥ å·®å¼‚äº†</span><br><span class="line">/tmp/telegraf/</span><br><span class="line">â”œâ”€â”€ telegraf</span><br><span class="line">â”œâ”€â”€ telegraf.conf</span><br><span class="line">â”œâ”€â”€ telegraf.log</span><br><span class="line">â”œâ”€â”€ telegraf.pid</span><br><span class="line">â”œâ”€â”€ telegraf.service</span><br><span class="line">â””â”€â”€ telegraf.sh</span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹ 6ï¼šå¤åˆ¶ç›®å½•åˆ°ç›®æ ‡ä¸»æœºï¼šç›®æ ‡ç›®å½•ä¸å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å¤šçº§çº§ç›®å½•çš„ï¼Œ </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$ ansible 10.0.12.31 -m copy -a &#x27;src=./telegraf dest=/tmp/a/b/c/telegraf&#x27;</span><br><span class="line">10.0.12.31 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true,</span><br><span class="line">    &quot;dest&quot;: &quot;/tmp/a/b/c/telegraf/&quot;,</span><br><span class="line">    &quot;src&quot;: &quot;/home/buildfarm/./telegraf&quot;</span><br><span class="line">&#125;</span><br><span class="line">$ tree /tmp/a   è¿™ä¸ªå’Œ ä¾‹ 5 ä¸€æ ·çš„ï¼Œä¼šæ”¾åˆ°ç›®æ ‡ ç›®å½• é‡Œé¢ï¼Œç­‰äº  /tmp/a/b/c/telegraf/telegraf </span><br><span class="line">/tmp/a</span><br><span class="line">â””â”€â”€ b</span><br><span class="line">    â””â”€â”€ c</span><br><span class="line">        â””â”€â”€ telegraf</span><br><span class="line">            â””â”€â”€ telegraf</span><br><span class="line">                â”œâ”€â”€ telegraf</span><br><span class="line">                â”œâ”€â”€ telegraf.conf</span><br><span class="line">                â”œâ”€â”€ telegraf.log</span><br><span class="line">                â”œâ”€â”€ telegraf.pid</span><br><span class="line">                â”œâ”€â”€ telegraf.service</span><br><span class="line">                â””â”€â”€ telegraf.sh</span><br><span class="line"></span><br><span class="line">4 directories, 6 files</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ç¤ºä¾‹ 7ï¼šå¤åˆ¶ç›®å½•åˆ°ç›®æ ‡ä¸»æœºï¼šç›®æ ‡ç›®å½•ä¸å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å¤šçº§çº§ç›®å½•çš„ï¼Œ  è¿™ä¸ªå’Œ ä¸Šé¢çš„ ä¾‹6 åšä¸ª å¯¹æ¯”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ ansible 10.0.12.31 -m copy -a &#x27;src=./telegraf/ dest=/tmp/a/b/c/telegraf&#x27;</span><br><span class="line">10.0.12.31 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true,</span><br><span class="line">    &quot;dest&quot;: &quot;/tmp/a/b/c/telegraf/&quot;,</span><br><span class="line">    &quot;src&quot;: &quot;/home/buildfarm/./telegraf/&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$ tree /tmp/a        è¿™ä¸ªå’Œ ä¾‹ 6  åšä¸ª å¯¹æ¯” ï¼Œ ç­‰äº  /tmp/a/b/c/telegrafï¼Œ æºç›®å½•å¦‚æœ / ç»“å°¾çš„è¯ æƒ…å†µå°±ä¸ä¸€æ ·äº†ï¼Œè¿™ä¸ªå’Œrsync å¾ˆç±»ä¼¼ </span><br><span class="line">/tmp/a</span><br><span class="line">â””â”€â”€ b</span><br><span class="line">    â””â”€â”€ c</span><br><span class="line">        â””â”€â”€ telegraf</span><br><span class="line">            â”œâ”€â”€ telegraf</span><br><span class="line">            â”œâ”€â”€ telegraf.conf</span><br><span class="line">            â”œâ”€â”€ telegraf.log</span><br><span class="line">            â”œâ”€â”€ telegraf.pid</span><br><span class="line">            â”œâ”€â”€ telegraf.service</span><br><span class="line">            â””â”€â”€ telegraf.sh</span><br><span class="line"></span><br><span class="line">3 directories, 6 files</span><br></pre></td></tr></table></figure>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">$ ansible 10.0.12.31 -m copy -a &#x27;src=./telegraf dest=/tmp/a/b/c/telegraf/&#x27;</span><br><span class="line">10.0.12.31 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true,</span><br><span class="line">    &quot;dest&quot;: &quot;/tmp/a/b/c/telegraf/&quot;,</span><br><span class="line">    &quot;src&quot;: &quot;/home/buildfarm/./telegraf&quot;</span><br><span class="line">&#125;</span><br><span class="line">$ tree /tmp/a</span><br><span class="line">/tmp/a</span><br><span class="line">â””â”€â”€ b</span><br><span class="line">    â””â”€â”€ c</span><br><span class="line">        â””â”€â”€ telegraf</span><br><span class="line">            â””â”€â”€ telegraf</span><br><span class="line">                â”œâ”€â”€ telegraf</span><br><span class="line">                â”œâ”€â”€ telegraf.conf</span><br><span class="line">                â”œâ”€â”€ telegraf.log</span><br><span class="line">                â”œâ”€â”€ telegraf.pid</span><br><span class="line">                â”œâ”€â”€ telegraf.service</span><br><span class="line">                â””â”€â”€ telegraf.sh</span><br><span class="line"></span><br><span class="line">ç»“æœåŒ ç¤ºä¾‹ 6ï¼Œ</span><br><span class="line"></span><br><span class="line">$ ansible 10.0.12.31 -m copy -a &#x27;src=./telegraf/ dest=/tmp/a/b/c/telegraf/&#x27;</span><br><span class="line">10.0.12.31 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true,</span><br><span class="line">    &quot;dest&quot;: &quot;/tmp/a/b/c/telegraf/&quot;,</span><br><span class="line">    &quot;src&quot;: &quot;/home/buildfarm/./telegraf/&quot;  </span><br><span class="line">&#125;</span><br><span class="line">$ tree /tmp/a</span><br><span class="line">/tmp/a</span><br><span class="line">â””â”€â”€ b</span><br><span class="line">    â””â”€â”€ c</span><br><span class="line">        â””â”€â”€ telegraf</span><br><span class="line">            â”œâ”€â”€ telegraf</span><br><span class="line">            â”œâ”€â”€ telegraf.conf</span><br><span class="line">            â”œâ”€â”€ telegraf.log</span><br><span class="line">            â”œâ”€â”€ telegraf.pid</span><br><span class="line">            â”œâ”€â”€ telegraf.service</span><br><span class="line">            â””â”€â”€ telegraf.sh</span><br><span class="line"></span><br><span class="line">ç»“æœåŒ ç¤ºä¾‹ 7</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æœ€ç»ˆ  æ”¾ä¸æ”¾åˆ°å­ç›®å½•é‡Œé¢ï¼Œæ˜¯è¦çœ‹ æºè·¯å¾„ ä¸Š æ˜¯å¦ /  ç»“å°¾çš„ï¼Œç±»ä¼¼ rsync å‘½ä»¤</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="5-fetchæ¨¡å—"><a href="#5-fetchæ¨¡å—" class="headerlink" title="5)fetchæ¨¡å—"></a>5)fetchæ¨¡å—</h2><p>ä½œç”¨ï¼šä»å®¢æˆ·ç«¯å–æ–‡ä»¶ï¼ˆåªèƒ½æ˜¯æ–‡ä»¶,ä¸æ”¯æŒç›®å½•)è‡³æœåŠ¡å™¨ç«¯çš„ç›®å½•é‡Œï¼Œä¸copyç›¸åï¼Œå¦‚æœä¸€å®šè¦æ‹‰å–ç›®å½•ï¼Œå¯ä»¥å…ˆå°†ç›®å½•tarï¼Œå†æ‹‰å–ã€‚</p>
<p>ä¸»è¦å‚æ•°å¦‚ä¸‹ï¼š</p>
<pre><code>å‚æ•° 	è¯´æ˜
src 	å¤åˆ¶çš„æºæ–‡ä»¶è·¯å¾„ï¼Œæºæ–‡ä»¶åªèƒ½æ˜¯æ–‡ä»¶
dest 	ç›®æ ‡ç»å¯¹è·¯å¾„
</code></pre>
<p>ç¤ºä¾‹ä¸€ï¼šæŠŠè¢«æ§ä¸»æœºçš„&#x2F;etc&#x2F;nginx&#x2F;nginx&#x2F;confé…ç½®æ–‡ä»¶æ‹·è´åˆ°æœ¬æœºçš„&#x2F;root&#x2F;nginxç›®å½•ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$ ansible 10.0.12.31 -m fetch -a &#x27;src=/etc/hostname dest=/tmp/fetch/aaaaa&#x27;</span><br><span class="line">10.0.12.31 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true,</span><br><span class="line">    &quot;checksum&quot;: &quot;8260afc442f28647c4a78cdcc12c492f7b580f15&quot;,</span><br><span class="line">    &quot;dest&quot;: &quot;/tmp/fetch/aaaaa/10.0.12.31/etc/hostname&quot;,</span><br><span class="line">    &quot;md5sum&quot;: &quot;b9613c443c158f95653754a49b211171&quot;,</span><br><span class="line">    &quot;remote_checksum&quot;: &quot;8260afc442f28647c4a78cdcc12c492f7b580f15&quot;,</span><br><span class="line">    &quot;remote_md5sum&quot;: null</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#æ³¨æ„ï¼šæŠŠè¿œç¨‹ä¸»æœºæ–‡ä»¶æ‹·è´åˆ°æœ¬æœºæ—¶ï¼Œä¼šä¸ºæ¯ä¸ªè¿œç¨‹ä¸»æœºå»ºç«‹ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œåç§°å°±æ˜¯è¯¥è¿œç¨‹ä¸»æœºçš„ipåœ°å€ï¼Œç„¶åæŠŠæ–‡ä»¶åˆ†åˆ«æ”¾åˆ°å¯¹åº”ä¸»æœºçš„ç›®å½•ä¸‹ï¼›</span><br><span class="line">#ç›®æ ‡ç›®å½•ä¸å­˜åœ¨æ˜¯å¯ä»¥åˆ›å»ºå‡ºæ¥çš„ï¼Œæºæ–‡ä»¶å¿…é¡»æ˜¯ä¸€ä¸ªå­˜åœ¨çš„æ–‡ä»¶ï¼ï¼ï¼</span><br><span class="line">$ tree /tmp/fetch/</span><br><span class="line">/tmp/fetch/</span><br><span class="line">â””â”€â”€ aaaaa</span><br><span class="line">    â””â”€â”€ 10.0.12.31</span><br><span class="line">        â””â”€â”€ etc</span><br><span class="line">            â””â”€â”€ hostname</span><br><span class="line"></span><br><span class="line">3 directories, 1 file</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹äºŒï¼šæ‹·è´è¿œç¨‹ä¸»æœºçš„ç›®å½•åˆ°æœ¬æœº</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">#1.é¦–å…ˆéœ€è¦æŠŠè¿œç¨‹ä¸»æœºçš„ç›®å½•æ‰“åŒ…ï¼Œé»˜è®¤æ‰“åŒ…åˆ°è¿œç¨‹ä¸»æœºçš„å®¶ç›®å½•ä¸‹ï¼ˆ/root)</span><br><span class="line"># ansible NginxWebs -m shell -a &#x27;tar jcf log.tar.bzip2 /var/log/nginx/access*&#x27;</span><br><span class="line">192.168.20.23 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">tar: Removing leading `/&#x27; from member names</span><br><span class="line">192.168.20.22 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">tar: Removing leading `/&#x27; from member names</span><br><span class="line"></span><br><span class="line">#2.æŠŠæ‰“åŒ…æ–‡ä»¶å–å›æœ¬æœºï¼š</span><br><span class="line"># ansible NginxWebs -m fetch -a &#x27;src=/root/log.tar.bzip2 dest=/root/nginx&#x27;</span><br><span class="line">192.168.20.23 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;checksum&quot;: &quot;832b6b9863baf60970f0972c749df8a26221ab26&quot;, </span><br><span class="line">    &quot;dest&quot;: &quot;/root/nginx/192.168.20.23/root/log.tar.bzip2&quot;, </span><br><span class="line">    &quot;md5sum&quot;: &quot;86c762c3ab6f3253c6b6be1739a95ac8&quot;, </span><br><span class="line">    &quot;remote_checksum&quot;: &quot;832b6b9863baf60970f0972c749df8a26221ab26&quot;, </span><br><span class="line">    &quot;remote_md5sum&quot;: null</span><br><span class="line">&#125;</span><br><span class="line">192.168.20.22 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;checksum&quot;: &quot;c66537be74f74e1c03254be3400ce7af4a1fe4bb&quot;, </span><br><span class="line">    &quot;dest&quot;: &quot;/root/nginx/192.168.20.22/root/log.tar.bzip2&quot;, </span><br><span class="line">    &quot;md5sum&quot;: &quot;74671b6a38285ae2d576451b3b248f3e&quot;, </span><br><span class="line">    &quot;remote_checksum&quot;: &quot;c66537be74f74e1c03254be3400ce7af4a1fe4bb&quot;, </span><br><span class="line">    &quot;remote_md5sum&quot;: null</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># tree /root/nginx</span><br><span class="line">/root/nginx</span><br><span class="line">â”œâ”€â”€ 192.168.20.22</span><br><span class="line">â”‚   â”œâ”€â”€ etc</span><br><span class="line">â”‚   â”‚   â””â”€â”€ nginx</span><br><span class="line">â”‚   â”‚       â””â”€â”€ nginx.conf</span><br><span class="line">â”‚   â””â”€â”€ root</span><br><span class="line">â”‚       â””â”€â”€ log.tar.bzip2</span><br><span class="line">â””â”€â”€ 192.168.20.23</span><br><span class="line">    â”œâ”€â”€ etc</span><br><span class="line">    â”‚   â””â”€â”€ nginx</span><br><span class="line">    â”‚       â””â”€â”€ nginx.conf</span><br><span class="line">    â””â”€â”€ root</span><br><span class="line">        â””â”€â”€ log.tar.bzip2</span><br><span class="line"></span><br><span class="line">8 directories, 4 files</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="6-fileæ¨¡å—"><a href="#6-fileæ¨¡å—" class="headerlink" title="6)fileæ¨¡å—"></a>6)fileæ¨¡å—</h2><p>åŠŸèƒ½ï¼šä¸ºè¢«æ§ç«¯åˆ›å»ºæ–‡ä»¶æˆ–ç›®å½•ï¼Œè®¾å®šæƒé™å±æ€§ï¼›</p>
<p>ä¸»è¦å‚æ•°å¦‚ä¸‹ï¼š</p>
<pre><code>path 	æŒ‡å®šè¿œç¨‹æœåŠ¡å™¨çš„è·¯å¾„ï¼Œä¹Ÿå¯ä»¥å†™æˆâ€˜destâ€™ï¼Œâ€˜nameâ€™
state 	çŠ¶æ€ï¼Œå¯ä»¥å°†å€¼è®¾å®šä¸ºdirectoryè¡¨ç¤ºåˆ›å»ºç›®å½•ï¼Œè®¾å®šä¸ºtouchè¡¨ç¤ºåˆ›å»ºæ–‡ä»¶ï¼Œè®¾å®šä¸ºlinkè¡¨ç¤ºåˆ›å»ºè½¯è¿æ¥ï¼Œè®¾å®šä¸ºhardè¡¨ç¤ºåˆ›å»ºç¡¬è¿æ¥ï¼Œè®¾å®šä¸ºabsentè¡¨ç¤ºåˆ é™¤ç›®å½•æ–‡ä»¶æˆ–é“¾æ¥
mode 	æ–‡ä»¶å¤åˆ¶åˆ°è¿œç¨‹å¹¶è®¾å®šæƒé™ï¼Œé»˜è®¤file=644ï¼Œdirectory=755
owner 	æ–‡ä»¶å¤åˆ¶åˆ°è¿œç¨‹å¹¶è®¾å®šå±ä¸»ï¼Œé»˜è®¤ä¸ºroot
group 	æ–‡ä»¶å¤åˆ¶åˆ°è¿œç¨‹å¹¶è®¾å®šå±ç»„ï¼Œé»˜è®¤ä¸ºroot
recurese 	é€’å½’ä¿®æ”¹
</code></pre>
<p>ç¤ºä¾‹ä¸€ï¼šåˆ›å»ºæ–‡ä»¶&#x2F;root&#x2F;f1.shï¼Œå¹¶è®¾å®šå±ä¸»ã€å±ç»„ã€æƒé™</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"># ansible NginxWebs -m file -a &#x27;path=/root/f1.sh owner=root group=root mode=755 state=touch&#x27;</span><br><span class="line">192.168.20.23 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python&quot;</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;dest&quot;: &quot;/root/f1.sh&quot;, </span><br><span class="line">    &quot;gid&quot;: 0, </span><br><span class="line">    &quot;group&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;mode&quot;: &quot;0755&quot;, </span><br><span class="line">    &quot;owner&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;size&quot;: 0, </span><br><span class="line">    &quot;state&quot;: &quot;file&quot;, </span><br><span class="line">    &quot;uid&quot;: 0</span><br><span class="line">&#125;</span><br><span class="line">192.168.20.22 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python&quot;</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;dest&quot;: &quot;/root/f1.sh&quot;, </span><br><span class="line">    &quot;gid&quot;: 0, </span><br><span class="line">    &quot;group&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;mode&quot;: &quot;0755&quot;, </span><br><span class="line">    &quot;owner&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;size&quot;: 0, </span><br><span class="line">    &quot;state&quot;: &quot;file&quot;, </span><br><span class="line">    &quot;uid&quot;: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>ç¤ºä¾‹äºŒï¼šä¿®æ”¹ä¸Šä¾‹ä¸­æ–‡ä»¶çš„å±ä¸»å±ç»„ä¸ºxuï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"># ansible NginxWebs -m file -a &#x27;path=/root/f1.sh owner=xu group=xu&#x27;</span><br><span class="line">192.168.20.22 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python&quot;</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;gid&quot;: 1000, </span><br><span class="line">    &quot;group&quot;: &quot;xu&quot;, </span><br><span class="line">    &quot;mode&quot;: &quot;0755&quot;, </span><br><span class="line">    &quot;owner&quot;: &quot;xu&quot;, </span><br><span class="line">    &quot;path&quot;: &quot;/root/f1.sh&quot;, </span><br><span class="line">    &quot;size&quot;: 0, </span><br><span class="line">    &quot;state&quot;: &quot;file&quot;, </span><br><span class="line">    &quot;uid&quot;: 1000</span><br><span class="line">&#125;</span><br><span class="line">192.168.20.23 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python&quot;</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;gid&quot;: 1000, </span><br><span class="line">    &quot;group&quot;: &quot;xu&quot;, </span><br><span class="line">    &quot;mode&quot;: &quot;0755&quot;, </span><br><span class="line">    &quot;owner&quot;: &quot;xu&quot;, </span><br><span class="line">    &quot;path&quot;: &quot;/root/f1.sh&quot;, </span><br><span class="line">    &quot;size&quot;: 0, </span><br><span class="line">    &quot;state&quot;: &quot;file&quot;, </span><br><span class="line">    &quot;uid&quot;: 1000</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># ll /root/f1.sh </span><br><span class="line">-rwxr-xr-x 1 xu xu 0 Aug  1 22:22 /root/f1.sh</span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹ä¸‰ï¼šåˆ›å»ºç›®å½•&#x2F;root&#x2F;test&#x2F;ï¼Œå¹¶è®¾å®šå±ä¸»ã€å±ç»„ã€æƒé™</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"># ansible NginxWebs -m file -a &#x27;path=/root/test owner=root group=root mode=755 state=directory&#x27; </span><br><span class="line">192.168.20.23 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python&quot;</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;gid&quot;: 0, </span><br><span class="line">    &quot;group&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;mode&quot;: &quot;0755&quot;, </span><br><span class="line">    &quot;owner&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;path&quot;: &quot;/root/test&quot;, </span><br><span class="line">    &quot;size&quot;: 6, </span><br><span class="line">    &quot;state&quot;: &quot;directory&quot;, </span><br><span class="line">    &quot;uid&quot;: 0</span><br><span class="line">&#125;</span><br><span class="line">192.168.20.22 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python&quot;</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;gid&quot;: 0, </span><br><span class="line">    &quot;group&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;mode&quot;: &quot;0755&quot;, </span><br><span class="line">    &quot;owner&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;path&quot;: &quot;/root/test&quot;, </span><br><span class="line">    &quot;size&quot;: 6, </span><br><span class="line">    &quot;state&quot;: &quot;directory&quot;, </span><br><span class="line">    &quot;uid&quot;: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># ll /root/test/ -d</span><br><span class="line">drwxr-xr-x 2 root root 6 Aug  1 22:26 /root/test/</span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹å››ï¼šä¸º&#x2F;root&#x2F;f1.shåˆ›å»ºè½¯é“¾æ¥æ–‡ä»¶&#x2F;root&#x2F;f1.sh.linkï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"># ansible NginxWebs -m file -a &#x27;src=/root/f1.sh dest=/root/f1.sh.link state=link&#x27; </span><br><span class="line">192.168.20.23 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python&quot;</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;dest&quot;: &quot;/root/f1.sh.link&quot;, </span><br><span class="line">    &quot;gid&quot;: 0, </span><br><span class="line">    &quot;group&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;mode&quot;: &quot;0777&quot;, </span><br><span class="line">    &quot;owner&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;size&quot;: 11, </span><br><span class="line">    &quot;src&quot;: &quot;/root/f1.sh&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;link&quot;, </span><br><span class="line">    &quot;uid&quot;: 0</span><br><span class="line">&#125;</span><br><span class="line">192.168.20.22 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python&quot;</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;dest&quot;: &quot;/root/f1.sh.link&quot;, </span><br><span class="line">    &quot;gid&quot;: 0, </span><br><span class="line">    &quot;group&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;mode&quot;: &quot;0777&quot;, </span><br><span class="line">    &quot;owner&quot;: &quot;root&quot;, </span><br><span class="line">    &quot;size&quot;: 11, </span><br><span class="line">    &quot;src&quot;: &quot;/root/f1.sh&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;link&quot;, </span><br><span class="line">    &quot;uid&quot;: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># ll /root/f1.sh*</span><br><span class="line">-rwxr-xr-x 1 xu   xu    0 Aug  1 22:22 /root/f1.sh</span><br><span class="line">lrwxrwxrwx 1 root root 11 Aug  1 22:28 /root/f1.sh.link -&gt; /root/f1.sh</span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹äº”ï¼šåˆ é™¤ä»¥ä¸Šç¤ºä¾‹ä¸­åˆ›å»ºçš„ç›®å½•å’Œæ–‡ä»¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># ansible NginxWebs -m file -a &#x27;path=/root/f1.sh.link state=absent&#x27; </span><br><span class="line">192.168.20.23 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python&quot;</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;path&quot;: &quot;/root/f1.sh.link&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;absent&quot;</span><br><span class="line">&#125;</span><br><span class="line">192.168.20.22 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python&quot;</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;path&quot;: &quot;/root/f1.sh.link&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;absent&quot;</span><br><span class="line">&#125;</span><br><span class="line"># ansible NginxWebs -m file -a &#x27;path=/root/f1.sh state=absent&#x27; </span><br><span class="line"></span><br><span class="line"># ansible NginxWebs -m file -a &#x27;path=/root/test state=absent&#x27; </span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹å…­ï¼šä¹Ÿå¯ä»¥åˆ é™¤ä¸€çº§ç›®å½•ï¼ˆæŒ‚è½½ç‚¹)ï¼Œä¼šæŠ¥é”™ï¼Œä½†æ˜¯å¯ä»¥æ¸…æ¥šæ•°æ®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> #ansible app -m file -a &#x27;dest=/data/ state=absent&#x27;</span><br><span class="line">192.168.169.130 | FAILED! =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: false,      &lt;==æŠ¥é”™</span><br><span class="line"></span><br><span class="line"> #ansible app  -a &#x27;ls -l /data/&#x27;</span><br><span class="line">total 0               &lt;==æ•°æ®å·²ç»æ¸…ç©º</span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹ä¸ƒï¼šé€’å½’æˆæƒç›®å½•ï¼Œç±»ä¼¼äº-Rçš„ä½œç”¨ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ansible webservers -m file -a &quot;path=/tmp/foo state=directory owner=root group=root mode=777 recurse=yes&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="7-yumæ¨¡å—"><a href="#7-yumæ¨¡å—" class="headerlink" title="7)yumæ¨¡å—"></a>7)yumæ¨¡å—</h2><p>åŠŸèƒ½ï¼šç®¡ç†è½¯ä»¶åŒ…ï¼Œéœ€è¦ç¡®è®¤è¢«ç®¡ç†ç«¯ä¸ºçº¢å¸½ç³»åˆ—çš„ï¼Œå¹¶ä¸”éœ€è¦è¢«ç®¡ç†ç«¯é…ç½®å¥½yumæºã€‚</p>
<p>ä¸»è¦çš„å‚æ•°å¦‚ä¸‹ï¼š</p>
<pre><code>    name            æŒ‡å®šå®‰è£…è½¯ä»¶åŒ…åæˆ–è½¯ä»¶åŒ…URL
    state           æŒ‡å®šyumå¯¹åº”çš„æ–¹æ³•ï¼Œpresent(Defaults)è¡¨ç¤ºå®‰è£…ï¼›absentè¡¨ç¤ºå¸è½½ï¼›latestè¡¨ç¤ºå®‰è£…æœ€æ–°ç‰ˆæœ¬è½¯ä»¶åŒ…ï¼Œæ”¯æŒå¤šç¨‹åºä¸€èµ·å®‰è£…ï¼Œç”¨é€—å·éš”å¼€
    enablerepo      å…è®¸ä»å“ªäº›ä»“åº“è·å–è½¯ä»¶
    disablerepo     ç¦æ­¢ä»å“ªäº›ä»“åº“è·å–è½¯ä»¶
    exclude         æ’é™¤æŸäº›è½¯ä»¶åŒ…ï¼Œä¾‹å¦‚kernel
    download_only   ä»…ä¸‹è½½è½¯ä»¶åŒ…ï¼Œä¸å®‰è£…
    disable_gpg_check   ä¸è¿›è¡Œgpgæ£€æµ‹
    update_cache        å¯ä»¥åœ¨å®‰è£…åŒ…çš„åŒæ—¶æ›´æ–°yumç¼“å­˜
</code></pre>
<p>ç¤ºä¾‹ä¸€ï¼šåœ¨è¢«æ§ç«¯å®‰è£…vsftpdï¼Œapacheè½¯ä»¶åŒ…ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"># ansible 192.168.20.23 -m yum -a &#x27;name=vsftpd,httpd state=present&#x27;</span><br><span class="line">192.168.20.23 | CHANGED =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python&quot;</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;changes&quot;: &#123;</span><br><span class="line">        &quot;installed&quot;: [</span><br><span class="line">            &quot;vsftpd&quot;, </span><br><span class="line">            &quot;httpd&quot;</span><br><span class="line">        ]</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;msg&quot;: &quot;&quot;, </span><br><span class="line">    &quot;rc&quot;: 0, </span><br><span class="line">    &quot;results&quot;: [</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># rpm -q httpd</span><br><span class="line">httpd-2.4.6-93.el7.centos.x86_64</span><br><span class="line"># rpm -q vsftpd</span><br><span class="line">vsftpd-3.0.2-27.el7.x86_64</span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹äºŒï¼šå®‰è£…å½“å‰æœ€æ–°çš„Apacheè½¯ä»¶ï¼Œé€šè¿‡epelä»“åº“å®‰è£…ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># ansible webservers -m yum -a &quot;name=httpd state=present enablerepo=epel&quot;</span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹ä¸‰ï¼šé€šè¿‡å…¬ç½‘URLå®‰è£… rpm è½¯ä»¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># ansible webservers -m yum -a &quot;name=https://xx.rpm state=present&quot;</span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹å››ï¼šå¸è½½è¢«æ§ä¸»æœºçš„vsftpdï¼Œapacheè½¯ä»¶åŒ…ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># ansible 192.168.20.23 -m yum -a &#x27;name=vsftpd,httpd state=absent&#x27;</span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹äº”ï¼šå®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Apache è½¯ä»¶ï¼Œå¦‚æœå­˜åœ¨åˆ™æ›´æ–° Apacheï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># ansible webservers -m yum -a &quot;name=httpd state=latest</span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹å…­ï¼šæ›´æ–°æ‰€æœ‰çš„è½¯ä»¶åŒ…ï¼Œä½†æ’é™¤å’Œkernelç›¸å…³çš„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># ansible webservers -m yum -a &quot;name=* state=latest exclude=kernel&quot;</span><br></pre></td></tr></table></figure>

<h2 id="8-systemdæ¨¡å—"><a href="#8-systemdæ¨¡å—" class="headerlink" title="8)systemdæ¨¡å—"></a>8)systemdæ¨¡å—</h2><p>åŠŸèƒ½ï¼šç®¡ç†æœåŠ¡å¯åŠ¨ä¸åœæ­¢ï¼Œä¸ service æ¨¡å—ç”¨æ³•ä¸€è‡´ï¼›</p>
<p>ä¸»è¦å‚æ•°å¦‚ä¸‹ï¼š</p>
<pre><code>    name        æŒ‡å®šéœ€è¦æ§åˆ¶çš„æœåŠ¡åç§°
    state       æŒ‡å®šæœåŠ¡çŠ¶æ€ï¼Œå…¶å€¼å¯ä»¥ä¸ºstoppedã€startedã€reloadedã€restartedã€running
    enabled         æŒ‡å®šæœåŠ¡æ˜¯å¦ä¸ºå¼€æœºå¯åŠ¨ï¼Œyesä¸ºå¯åŠ¨ï¼Œnoä¸ºä¸å¯åŠ¨
    daemon_reload   yesï¼šé‡å¯systemdæœåŠ¡ï¼Œè®©unitæ–‡ä»¶ç”Ÿæ•ˆ
</code></pre>
<p>ç¤ºä¾‹ä¸€ï¼šå¯åŠ¨nginxæœåŠ¡ï¼Œå¹¶è®¾ç½®ä¸ºå¼€æœºè‡ªå¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># ansible 192.168.20.23 -m service -a &#x27;name=nginx state=started enabled=yes&#x27;</span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹äºŒï¼šé‡æ–°å¯åŠ¨nginxæœåŠ¡ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># ansible 192.168.20.23 -m service -a &#x27;name=nginx state=restarted&#x27;</span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹ä¸‰ï¼šé‡è½½nginxæœåŠ¡ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># ansible 192.168.20.23 -m service -a &#x27;name=nginx state=reloaded&#x27;</span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹å››ï¼šåœæ­¢nginxæœåŠ¡ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># ansible 192.168.20.23 -m service -a &#x27;name=nginx state=stopped&#x27;</span><br></pre></td></tr></table></figure>


<h2 id="9-cronæ¨¡å—"><a href="#9-cronæ¨¡å—" class="headerlink" title="9)cronæ¨¡å—"></a>9)cronæ¨¡å—</h2><p>åŠŸèƒ½ï¼šç®¡ç†è¢«æ§ç«¯è®¡åˆ’ä»»åŠ¡ï¼›</p>
<p>ä¸»è¦å‚æ•°å¦‚ä¸‹ï¼š</p>
<pre><code>    å‚æ•° 	è¯´æ˜
    name 	å®šæ—¶ä»»åŠ¡åŸºæœ¬æè¿°
    job 	å®šæ—¶ä»»åŠ¡è¦æ‰§è¡Œçš„å‘½ä»¤
    minute 	åˆ†
    hour 	å°æ—¶
    day 	æ—¥
    month 	æœˆ
    weekday 	å‘¨ï¼Œ0-6
    disabled 	yesï¼šç¦ç”¨è®¡åˆ’ä»»åŠ¡ï¼Œnoï¼šå¯ç”¨è®¡åˆ’ä»»åŠ¡
        absentï¼šåˆ é™¤è®¡åˆ’ä»»åŠ¡
</code></pre>
<p>ç¤ºä¾‹ä¸€ï¼šåˆ›å»ºè®¡åˆ’ä»»åŠ¡ï¼Œæ¯10åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡åŒæ­¥æ—¶é—´ï¼Œå°†æ­¤è®¡åˆ’ä»»åŠ¡å‘½åä¸ºsynctimeï¼›</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># ansible NginxWebs -m cron -a &#x27;name=&quot;synctime&quot; job=&quot;ntpdate 192.168.20.1 &amp;&gt; /dev/null&quot; minute=*/10&#x27;</span><br><span class="line"></span><br><span class="line"># crontab -l</span><br><span class="line">#Ansible: synctime</span><br><span class="line">*/10 * * * * ntpdate 192.168.20.1 &amp;&gt; /dev/null</span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹äºŒï¼šæ·»åŠ å®šæ—¶ä»»åŠ¡ï¼Œ æ¯å¤©çš„å‡Œæ™¨2ç‚¹å’Œå‡Œæ™¨5ç‚¹æ‰§è¡Œä¸€æ¬¡lsï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># ansible NginxWebs -m cron -a &#x27;name=&quot;ls&quot; job=&quot;ls &amp;&gt; /dev/null&quot; minute=0 hour=2,5&#x27;</span><br><span class="line"></span><br><span class="line"># crontab -l</span><br><span class="line">#Ansible: synctime</span><br><span class="line">*/10 * * * * ntpdate 192.168.20.1 &amp;&gt; /dev/null</span><br><span class="line">#Ansible: ls</span><br><span class="line">0 2,5 * * * ls &amp;&gt; /dev/null</span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹ä¸‰ï¼šç¦ç”¨ä¸Šé¢ç¤ºä¾‹çš„è®¡åˆ’ä»»åŠ¡ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># ansible NginxWebs -m cron -a &#x27;name=&quot;ls&quot; job=&quot;ls &amp;&gt; /dev/null&quot; minute=0 hour=2,5 disabled=yes&#x27;</span><br><span class="line"></span><br><span class="line"># ansible NginxWebs -m cron -a &#x27;name=&quot;synctime&quot; job=&quot;ntpdate 192.168.20.1 &amp;&gt; /dev/null&quot; minute=*/10 disabled=yes&#x27;</span><br><span class="line"></span><br><span class="line">#è¢«æ§ä¸»æœºè¢«æ³¨é‡Šæ‰äº†</span><br><span class="line"># crontab -l</span><br><span class="line">#Ansible: synctime</span><br><span class="line">#*/10 * * * * ntpdate 192.168.20.1 &amp;&gt; /dev/null</span><br><span class="line">#Ansible: ls</span><br><span class="line">#0 2,5 * * * ls &amp;&gt; /dev/null</span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹å››ï¼šåˆ é™¤ä¸Šè¿°çš„è®¡åˆ’ä»»åŠ¡ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># ansible NginxWebs -m cron -a &#x27;name=&quot;synctime&quot; state=absent&#x27;</span><br><span class="line"></span><br><span class="line"># ansible NginxWebs -m cron -a &#x27;name=&quot;ls&quot; state=absent&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="10-get-urlæ¨¡å—"><a href="#10-get-urlæ¨¡å—" class="headerlink" title="10)get_urlæ¨¡å—"></a>10)get_urlæ¨¡å—</h2><p>åŠŸèƒ½ï¼šé€šè¿‡äº’è”ç½‘ä¸‹è½½è½¯ä»¶è‡³è¢«æ§ç«¯æœ¬åœ°ï¼›</p>
<pre><code>    ä¸»è¦å‚æ•°å¦‚ä¸‹ï¼š
    å‚æ•° 	è¯´æ˜
    url 	èµ„æºæ–‡ä»¶åœ¨äº’è”ç½‘ä¸Šçš„å…·ä½“urlåœ°å€
    dest 	æ–‡ä»¶ä¸‹è½½ä½ç½®çš„ç»å¯¹è·¯å¾„
    mode 	æ–‡ä»¶ä¸‹è½½ä½ç½®çš„ç»å¯¹è·¯å¾„
    checksum 	å¯¹ä¸‹è½½çš„èµ„æºè¿›è¡Œæ ¡éªŒ
    timeout 	URLè¯·æ±‚è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤10s
</code></pre>
<p>ç¤ºä¾‹ä¸€ï¼šä¸‹è½½äº’è”ç½‘çš„è½¯ä»¶è‡³æœ¬åœ°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># ansible webservers -m get_url -a &quot;url=https://raw.githubusercontent.com/psf/black/main/README.md dest=/tmp&quot;</span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹äºŒï¼šä¸‹è½½äº’è”ç½‘æ–‡ä»¶å¹¶è¿›è¡Œ md5 æ ¡éªŒï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># ansible webservers -m get_url -a &quot;url=http,https dest=/opt checksum=md5:76eb3af80ffd&quot;</span><br></pre></td></tr></table></figure>


<h2 id="11-mountæ¨¡å—"><a href="#11-mountæ¨¡å—" class="headerlink" title="11)mountæ¨¡å—"></a>11)mountæ¨¡å—</h2><p>åŠŸèƒ½ï¼šç®¡ç†è¢«æ§ç«¯è®¾å¤‡æŒ‚è½½ï¼›</p>
<pre><code>    ä¸»è¦å‚æ•°å¦‚ä¸‹ï¼š
    å‚æ•° 	è¯´æ˜
    src 	æœ¬åœ°æˆ–è¿œç¨‹è®¾å¤‡çš„è·¯å¾„
    path 	è®¾å¤‡æŒ‚è½½è‡³æœ¬åœ°çš„è·¯å¾„
    fstype 	æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼Œxfsã€nfs...
    opts 	æŒ‚è½½çš„å‚æ•°ï¼Œdefaultsã€ro...
    state 	æŒ‚è½½çš„çŠ¶æ€ï¼Œabsentã€mountedã€unmounted
</code></pre>
<p>ç¯å¢ƒå‡†å¤‡ï¼šå°† ansible ä½œä¸º nfs æœåŠ¡ç«¯ï¼Œ 192.168.20.22ã€192.168.20.23 ä½œä¸º nfså®¢æˆ·ç«¯æŒ‚è½½ï¼›</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># ansible localhost -m yum -a &#x27;name=nfs-utils state=present&#x27;</span><br><span class="line"></span><br><span class="line"># ansible localhost -m file -a &#x27;path=/data/nfs/ owner=nginx group=nginx state=directory&#x27;</span><br><span class="line"></span><br><span class="line"># ansible localhost -m copy -a &#x27;dest=/etc/exports content=&quot;/data/nfs 192.168.20.0/24(rw,all_squash,anonuid=887,anongid=887)\n&quot;&#x27;</span><br><span class="line"></span><br><span class="line"># ansible localhost -m service -a &#x27;name=nfs-server state=started&#x27;</span><br><span class="line"></span><br><span class="line"># exportfs -arv</span><br><span class="line">exporting 192.168.20.0/24:/data/nfs</span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹ä¸€ï¼šæŒ‚è½½ nfs è‡³æœ¬åœ°çš„ &#x2F;opt ç›®å½•ï¼Œå¹¶å®ç°å¼€æœºè‡ªåŠ¨æŒ‚è½½ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># ansible NginxWebs -m mount -a &#x27;src=192.168.20.17:/data/nfs path=/opt fstype=nfs opts=defaults state=mounted&#x27;</span><br><span class="line"></span><br><span class="line"># df </span><br><span class="line">Filesystem              1K-blocks    Used Available Use% Mounted on</span><br><span class="line">192.168.20.17:/data/nfs 154057344   33280 154024064   1% /opt</span><br><span class="line"></span><br><span class="line"># cat /etc/fstab </span><br><span class="line">192.168.20.17:/data/nfs /opt nfs defaults 0 0</span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹äºŒï¼šä¸´æ—¶å¸è½½ nfs çš„æŒ‚è½½ï¼Œä½†ä¸æ¸…ç† &#x2F;etc&#x2F;fstab ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># ansible NginxWebs -m mount -a &#x27;src=192.168.20.17:/data/nfs path=/opt fstype=nfs opts=defaults state=unmounted&#x27;</span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹ä¸‰ï¼šæ°¸ä¹…å¸è½½ nfs æŒ‚è½½ï¼ŒåŒæ—¶æ¸…ç† &#x2F;etc&#x2F;fstabï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># ansible NginxWebs -m mount -a &#x27;src=192.168.20.17:/data/nfs path=/opt fstype=nfs opts=defaults state=absent&#x27;</span><br></pre></td></tr></table></figure>


<h2 id="12-archiveæ¨¡å—"><a href="#12-archiveæ¨¡å—" class="headerlink" title="12)archiveæ¨¡å—"></a>12)archiveæ¨¡å—</h2><p>åŠŸèƒ½ï¼šåœ¨è¿œç«¯ä¸»æœºæ‰“åŒ…ä¸å‹ç¼©ï¼›</p>
<pre><code>ä¸»è¦å‚æ•°å¦‚ä¸‹ï¼š
å‚æ•° 	è¯´æ˜
path 	è¦å‹ç¼©çš„æ–‡ä»¶æˆ–ç›®å½•
dest 	å‹ç¼©åçš„æ–‡ä»¶
format 	æŒ‡å®šæ‰“åŒ…å‹ç¼©çš„ç±»å‹ï¼šbz2ã€gzã€tarã€xzã€zip
</code></pre>
<p>ç¤ºä¾‹ä¸€ï¼šå°† &#x2F;var&#x2F;log ç›®å½•å‹ç¼©ä¸º tar.gz æ ¼å¼ï¼Œå¹¶å­˜å‚¨è‡³ &#x2F;opt ç›®å½•ä¸‹ï¼›</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># ansible 192.168.20.23 -m archive -a &#x27;path=/var/log dest=/opt/log.tar.gz format=gz&#x27;</span><br><span class="line"></span><br><span class="line"># ll /opt</span><br><span class="line">total 692</span><br><span class="line">-rw-r--r-- 1 root root 705807 Aug  2 15:22 log.tar.gz</span><br></pre></td></tr></table></figure>


<h2 id="13-unarchiveæ¨¡å—"><a href="#13-unarchiveæ¨¡å—" class="headerlink" title="13)unarchiveæ¨¡å—"></a>13)unarchiveæ¨¡å—</h2><p>åŠŸèƒ½ï¼šåœ¨è¿œç«¯ä¸»æœºè§£åŒ…ä¸è§£å‹ç¼©ï¼›</p>
<pre><code>ä¸»è¦å‚æ•°å¦‚ä¸‹ï¼š
å‚æ•° 	è¯´æ˜
src 	è¦è§£å‹çš„è½¯ä»¶åŒ…è·¯å¾„
dest 	è§£å‹åˆ°ç›®æ ‡ä½ç½®ï¼Œéœ€è¦æ˜¯ä¸€ä¸ªç›®å½•
remote_src 	yesï¼šè¦è§£å‹çš„åŒ…åœ¨è¢«æ§ç«¯ã€noï¼šè¦è§£å‹çš„åŒ…åœ¨æ§åˆ¶ç«¯
owner 	æ–‡ä»¶å¤åˆ¶åˆ°è¿œç¨‹å¹¶è®¾å®šå±ä¸»ï¼Œé»˜è®¤ä¸ºroot
group 	æ–‡ä»¶å¤åˆ¶åˆ°è¿œç¨‹å¹¶è®¾å®šå±ç»„ï¼Œé»˜è®¤ä¸ºroot
mode 	æ–‡ä»¶å¤åˆ¶åˆ°è¿œç¨‹å¹¶è®¾å®šæƒé™ï¼Œé»˜è®¤file=644ï¼Œdirectory=755
</code></pre>
<p>ç¤ºä¾‹ä¸€ï¼šæŠŠå‹ç¼©åŒ…æ¨é€åˆ°è¢«æ§ç«¯ï¼Œåœ¨è¢«æ§ç«¯ä¸»æœºè§£å‹ç¼©ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#æŠŠå‹ç¼©åŒ…æ‹·è´åˆ°è¿œç«¯ä¸»æœºï¼š</span><br><span class="line"># ansible 192.168.20.23 -m copy -a &#x27;src=/root/nginx-1.20.1.tar.gz dest=/tmp/&#x27;</span><br><span class="line"></span><br><span class="line">#åœ¨è¿œç«¯ä¸»æœºè§£å‹ç¼©ï¼š</span><br><span class="line"># ansible 192.168.20.23 -m copy -a &#x27;src=/tmp/nginx-1.20.1.tar.gz dest=/tmp/nginx-1.20.1 remote_src=yes&#x27;</span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹äºŒï¼šå‹ç¼©åŒ…åœ¨ansibleä¸»æœºä¸Šï¼Œç›´æ¥è§£å‹åˆ°è¢«æ§ä¸»æœºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># ansible 192.168.20.23 -m unarchive -a &#x27;src=/root/nginx-1.20.1.tar.gz dest=/tmp/&#x27;</span><br><span class="line"></span><br><span class="line"># ll /tmp/</span><br><span class="line">total 0</span><br><span class="line">drwxr-xr-x 8 xu1 xu1 158 May 25 20:35 nginx-1.20.1</span><br></pre></td></tr></table></figure>


<h2 id="14-selinuxæ¨¡å—"><a href="#14-selinuxæ¨¡å—" class="headerlink" title="14)selinuxæ¨¡å—"></a>14)selinuxæ¨¡å—</h2><p>åŠŸèƒ½ï¼šç®¡ç†è¿œç«¯ä¸»æœºçš„ SELINUX é˜²ç«å¢™ï¼›</p>
<pre><code>ä¸»è¦å‚æ•°å¦‚ä¸‹ï¼š
å‚æ•° 	è¯´æ˜
state 	Selinuxæ¨¡å¼ï¼šenforcingã€permissiveã€disabled
polocy 	targeted
</code></pre>
<p>ç¤ºä¾‹ä¸€ï¼šè®¾ç½® selinux ä¸º enforcing</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># ansible 192.168.20.23 -m selinux -a &#x27;state=enforcing policy=targeted&#x27;</span><br><span class="line"></span><br><span class="line"># grep &quot;^SELINUX&quot; /etc/selinux/config</span><br><span class="line">SELINUX=enforcing</span><br><span class="line">SELINUXTYPE=targeted</span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹äºŒï¼šè®¾ç½® selinux ä¸º disabledï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># ansible 192.168.20.23 -m selinux -a &#x27;state=disabled&#x27;</span><br><span class="line"></span><br><span class="line"># grep &quot;^SELINUX&quot; /etc/selinux/config</span><br><span class="line">SELINUX=disabled</span><br><span class="line">SELINUXTYPE=targeted</span><br></pre></td></tr></table></figure>


<h2 id="15-service-æ¨¡å—"><a href="#15-service-æ¨¡å—" class="headerlink" title="15)service æ¨¡å—"></a>15)service æ¨¡å—</h2><p>è¯¥æ¨¡å—ç”¨äºæœåŠ¡ç¨‹åºçš„ç®¡ç†ã€‚<br>ã€€ã€€<br>å…¶ä¸»è¦é€‰é¡¹å¦‚ä¸‹ï¼š</p>
<pre><code>    arguments #å‘½ä»¤è¡Œæä¾›é¢å¤–çš„å‚æ•°
    enabled #è®¾ç½®å¼€æœºå¯åŠ¨ã€‚
    name= #æœåŠ¡åç§°
    runlevel #å¼€æœºå¯åŠ¨çš„çº§åˆ«ï¼Œä¸€èˆ¬ä¸ç”¨æŒ‡å®šã€‚
    sleep #åœ¨é‡å¯æœåŠ¡çš„è¿‡ç¨‹ä¸­ï¼Œæ˜¯å¦ç­‰å¾…ã€‚å¦‚åœ¨æœåŠ¡å…³é—­ä»¥åç­‰å¾…2ç§’å†å¯åŠ¨ã€‚(å®šä¹‰åœ¨å‰§æœ¬ä¸­ã€‚)
    state #æœ‰å››ç§çŠ¶æ€ï¼Œåˆ†åˆ«ä¸ºï¼šstarted---&gt;å¯åŠ¨æœåŠ¡ï¼Œ stopped---&gt;åœæ­¢æœåŠ¡ï¼Œ restarted---&gt;é‡å¯æœåŠ¡ï¼Œ reloaded---&gt;é‡è½½é…ç½®
</code></pre>
<p>ç¤ºä¾‹1 å¼€å¯æœåŠ¡å¹¶è®¾ç½®è‡ªå¯åŠ¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># ansible web -m service -a &#x27;name=nginx state=started enabled=true&#x27; </span><br><span class="line">192.168.37.122 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;enabled&quot;: true, </span><br><span class="line">    &quot;name&quot;: &quot;nginx&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;started&quot;, </span><br><span class="line">    â€¦â€¦</span><br><span class="line">&#125;</span><br><span class="line">192.168.37.133 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;enabled&quot;: true, </span><br><span class="line">    &quot;name&quot;: &quot;nginx&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;started&quot;, </span><br><span class="line">    â€¦â€¦</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥å»æŸ¥çœ‹ä¸€ä¸‹ç«¯å£æ˜¯å¦æ‰“å¼€ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># ansible web -m shell -a &#x27;ss -ntl&#x27;</span><br><span class="line">192.168.37.122 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">State      Recv-Q Send-Q Local Address:Port               Peer Address:Port              </span><br><span class="line">LISTEN     0      128          *:80                       *:*                                  </span><br><span class="line"></span><br><span class="line">192.168.37.133 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">State      Recv-Q Send-Q Local Address:Port               Peer Address:Port                    </span><br><span class="line">LISTEN     0      128          *:80                       *:*   </span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹2 å…³é—­æœåŠ¡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># ansible web -m service -a &#x27;name=nginx state=stopped&#x27;</span><br><span class="line">192.168.37.122 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;name&quot;: &quot;nginx&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;stopped&quot;, </span><br><span class="line">	â€¦â€¦</span><br><span class="line">&#125;</span><br><span class="line">192.168.37.133 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;name&quot;: &quot;nginx&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;stopped&quot;, </span><br><span class="line">	â€¦â€¦</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># ansible web -m shell -a &#x27;ss -ntl | grep 80&#x27;</span><br><span class="line">192.168.37.122 | FAILED | rc=1 &gt;&gt;</span><br><span class="line"></span><br><span class="line">192.168.37.133 | FAILED | rc=1 &gt;&gt;</span><br></pre></td></tr></table></figure>

<h2 id="16ï¼‰user-æ¨¡å—"><a href="#16ï¼‰user-æ¨¡å—" class="headerlink" title="16ï¼‰user æ¨¡å—"></a>16ï¼‰user æ¨¡å—</h2><p>è¯¥æ¨¡å—ä¸»è¦æ˜¯ç”¨æ¥ç®¡ç†ç”¨æˆ·è´¦å·ã€‚<br>ã€€ã€€<br>å…¶ä¸»è¦é€‰é¡¹å¦‚ä¸‹ï¼š</p>
<pre><code>commentã€€ã€€# ç”¨æˆ·çš„æè¿°ä¿¡æ¯
createhomeã€€ã€€# æ˜¯å¦åˆ›å»ºå®¶ç›®å½•
forceã€€ã€€# åœ¨ä½¿ç”¨state=absentæ—¶, è¡Œä¸ºä¸userdel â€“forceä¸€è‡´.
groupã€€ã€€# æŒ‡å®šåŸºæœ¬ç»„
groupsã€€ã€€# æŒ‡å®šé™„åŠ ç»„ï¼Œå¦‚æœæŒ‡å®šä¸º(groups=)è¡¨ç¤ºåˆ é™¤æ‰€æœ‰ç»„
homeã€€ã€€# æŒ‡å®šç”¨æˆ·å®¶ç›®å½•
move_homeã€€ã€€# å¦‚æœè®¾ç½®ä¸ºhome=æ—¶, è¯•å›¾å°†ç”¨æˆ·ä¸»ç›®å½•ç§»åŠ¨åˆ°æŒ‡å®šçš„ç›®å½•
nameã€€ã€€# æŒ‡å®šç”¨æˆ·å
non_uniqueã€€ã€€# è¯¥é€‰é¡¹å…è®¸æ”¹å˜éå”¯ä¸€çš„ç”¨æˆ·IDå€¼
passwordã€€ã€€# æŒ‡å®šç”¨æˆ·å¯†ç 
removeã€€ã€€# åœ¨ä½¿ç”¨state=absentæ—¶, è¡Œä¸ºæ˜¯ä¸userdel â€“removeä¸€è‡´
shellã€€ã€€# æŒ‡å®šé»˜è®¤shell
stateã€€ã€€# è®¾ç½®å¸å·çŠ¶æ€ï¼Œä¸æŒ‡å®šä¸ºåˆ›å»ºï¼ŒæŒ‡å®šå€¼ä¸ºabsentè¡¨ç¤ºåˆ é™¤
systemã€€ã€€# å½“åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼Œè®¾ç½®è¿™ä¸ªç”¨æˆ·æ˜¯ç³»ç»Ÿç”¨æˆ·ã€‚è¿™ä¸ªè®¾ç½®ä¸èƒ½æ›´æ”¹ç°æœ‰ç”¨æˆ·
uidã€€ã€€# æŒ‡å®šç”¨æˆ·çš„uid
</code></pre>
<p>â‘  æ·»åŠ ä¸€ä¸ªç”¨æˆ·å¹¶æŒ‡å®šå…¶ uid</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># ansible web -m user -a &#x27;name=keer uid=11111&#x27;</span><br><span class="line">192.168.37.122 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;comment&quot;: &quot;&quot;, </span><br><span class="line">    &quot;createhome&quot;: true, </span><br><span class="line">    &quot;group&quot;: 11111, </span><br><span class="line">    &quot;home&quot;: &quot;/home/keer&quot;, </span><br><span class="line">    &quot;name&quot;: &quot;keer&quot;, </span><br><span class="line">    &quot;shell&quot;: &quot;/bin/bash&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;present&quot;, </span><br><span class="line">    &quot;stderr&quot;: &quot;useradd: warning: the home directory already exists.\nNot copying any file from skel directory into it.\nCreating mailbox file: File exists\n&quot;, </span><br><span class="line">    &quot;system&quot;: false, </span><br><span class="line">    &quot;uid&quot;: 11111</span><br><span class="line">&#125;</span><br><span class="line">192.168.37.133 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;comment&quot;: &quot;&quot;, </span><br><span class="line">    &quot;createhome&quot;: true, </span><br><span class="line">    &quot;group&quot;: 11111, </span><br><span class="line">    &quot;home&quot;: &quot;/home/keer&quot;, </span><br><span class="line">    &quot;name&quot;: &quot;keer&quot;, </span><br><span class="line">    &quot;shell&quot;: &quot;/bin/bash&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;present&quot;, </span><br><span class="line">    &quot;stderr&quot;: &quot;useradd: warning: the home directory already exists.\nNot copying any file from skel directory into it.\nCreating mailbox file: File exists\n&quot;, </span><br><span class="line">    &quot;system&quot;: false, </span><br><span class="line">    &quot;uid&quot;: 11111</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ã€€ã€€æ·»åŠ å®Œæˆï¼Œæˆ‘ä»¬å¯ä»¥å»æŸ¥çœ‹ä¸€ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># ansible web -m shell -a &#x27;cat /etc/passwd |grep keer&#x27;</span><br><span class="line">192.168.37.122 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">keer:x:11111:11111::/home/keer:/bin/bash</span><br><span class="line"></span><br><span class="line">192.168.37.133 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">keer:x:11111:11111::/home/keer:/bin/bash</span><br></pre></td></tr></table></figure>


<p>â‘¡ åˆ é™¤ç”¨æˆ·</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># ansible web -m user -a &#x27;name=keer state=absent&#x27;</span><br><span class="line">192.168.37.122 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;force&quot;: false, </span><br><span class="line">    &quot;name&quot;: &quot;keer&quot;, </span><br><span class="line">    &quot;remove&quot;: false, </span><br><span class="line">    &quot;state&quot;: &quot;absent&quot;</span><br><span class="line">&#125;</span><br><span class="line">192.168.37.133 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;force&quot;: false, </span><br><span class="line">    &quot;name&quot;: &quot;keer&quot;, </span><br><span class="line">    &quot;remove&quot;: false, </span><br><span class="line">    &quot;state&quot;: &quot;absent&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ã€€ã€€ä¸€æ ·çš„ï¼Œåˆ é™¤ä¹‹åï¼Œæˆ‘ä»¬å»çœ‹ä¸€ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># ansible web -m shell -a &#x27;cat /etc/passwd |grep keer&#x27;</span><br><span class="line">192.168.37.122 | FAILED | rc=1 &gt;&gt;</span><br><span class="line"></span><br><span class="line">192.168.37.133 | FAILED | rc=1 &gt;&gt;</span><br></pre></td></tr></table></figure>
<p>ã€€ã€€å‘ç°å·²ç»æ²¡æœ‰è¿™ä¸ªç”¨æˆ·äº†ã€‚</p>
<h2 id="17ï¼‰group-æ¨¡å—"><a href="#17ï¼‰group-æ¨¡å—" class="headerlink" title="17ï¼‰group æ¨¡å—"></a>17ï¼‰group æ¨¡å—</h2><p>è¯¥æ¨¡å—ä¸»è¦ç”¨äºæ·»åŠ æˆ–åˆ é™¤ç»„ã€‚
ã€€ã€€</p>
<pre><code>å¸¸ç”¨çš„é€‰é¡¹å¦‚ä¸‹ï¼š

gid=ã€€ã€€#è®¾ç½®ç»„çš„GIDå·
name=ã€€ã€€#æŒ‡å®šç»„çš„åç§°
state=ã€€ã€€#æŒ‡å®šç»„çš„çŠ¶æ€ï¼Œé»˜è®¤ä¸ºåˆ›å»ºï¼Œè®¾ç½®å€¼ä¸ºabsentä¸ºåˆ é™¤
system=ã€€ã€€#è®¾ç½®å€¼ä¸ºyesï¼Œè¡¨ç¤ºåˆ›å»ºä¸ºç³»ç»Ÿç»„
</code></pre>
<p>â‘  åˆ›å»ºç»„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># ansible web -m group -a &#x27;name=sanguo gid=12222&#x27;</span><br><span class="line">192.168.37.122 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;gid&quot;: 12222, </span><br><span class="line">    &quot;name&quot;: &quot;sanguo&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;present&quot;, </span><br><span class="line">    &quot;system&quot;: false</span><br><span class="line">&#125;</span><br><span class="line">192.168.37.133 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;gid&quot;: 12222, </span><br><span class="line">    &quot;name&quot;: &quot;sanguo&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;present&quot;, </span><br><span class="line">    &quot;system&quot;: false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ã€€ã€€åˆ›å»ºè¿‡åï¼Œæˆ‘ä»¬æ¥æŸ¥çœ‹ä¸€ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># ansible web -m shell -a &#x27;cat /etc/group | grep 12222&#x27; </span><br><span class="line">192.168.37.122 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">sanguo:x:12222:</span><br><span class="line"></span><br><span class="line">192.168.37.133 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">sanguo:x:12222:</span><br></pre></td></tr></table></figure>
<p>ã€€ã€€å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬çš„ç»„å·²ç»åˆ›å»ºæˆåŠŸäº†ã€‚</p>
<p>â‘¡ åˆ é™¤ç»„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># ansible web -m group -a &#x27;name=sanguo state=absent&#x27;</span><br><span class="line">192.168.37.122 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;name&quot;: &quot;sanguo&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;absent&quot;</span><br><span class="line">&#125;</span><br><span class="line">192.168.37.133 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;name&quot;: &quot;sanguo&quot;, </span><br><span class="line">    &quot;state&quot;: &quot;absent&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ã€€ã€€ç…§ä¾‹æŸ¥çœ‹ä¸€ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># ansible web -m shell -a &#x27;cat /etc/group | grep 12222&#x27; </span><br><span class="line">192.168.37.122 | FAILED | rc=1 &gt;&gt;</span><br><span class="line"></span><br><span class="line">192.168.37.133 | FAILED | rc=1 &gt;&gt;</span><br></pre></td></tr></table></figure>
<p>ã€€ã€€å·²ç»æ²¡æœ‰è¿™ä¸ªç»„çš„ç›¸å…³ä¿¡æ¯äº†ã€‚</p>
<h2 id="18ï¼‰script-æ¨¡å—"><a href="#18ï¼‰script-æ¨¡å—" class="headerlink" title="18ï¼‰script æ¨¡å—"></a>18ï¼‰script æ¨¡å—</h2><p>è¯¥æ¨¡å—ç”¨äºå°†æœ¬æœºçš„è„šæœ¬åœ¨è¢«ç®¡ç†ç«¯çš„æœºå™¨ä¸Šè¿è¡Œã€‚</p>
<p>ã€€ã€€è¯¥æ¨¡å—ç›´æ¥æŒ‡å®šè„šæœ¬çš„è·¯å¾„å³å¯ï¼Œæˆ‘ä»¬é€šè¿‡ä¾‹å­æ¥çœ‹ä¸€çœ‹åˆ°åº•å¦‚ä½•ä½¿ç”¨çš„ï¼š</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªè„šæœ¬ï¼Œå¹¶ç»™å…¶åŠ ä¸Šæ‰§è¡Œæƒé™ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># vim /tmp/df.sh</span><br><span class="line">	#!/bin/bash</span><br><span class="line"></span><br><span class="line">	date &gt;&gt; /tmp/disk_total.log</span><br><span class="line">	df -lh &gt;&gt; /tmp/disk_total.log </span><br><span class="line"># chmod +x /tmp/df.sh </span><br></pre></td></tr></table></figure>
<p>ã€€ã€€ç„¶åï¼Œæˆ‘ä»¬ç›´æ¥è¿è¡Œå‘½ä»¤æ¥å®ç°åœ¨è¢«ç®¡ç†ç«¯æ‰§è¡Œè¯¥è„šæœ¬ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># ansible web -m script -a &#x27;/tmp/df.sh&#x27;</span><br><span class="line">192.168.37.122 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;rc&quot;: 0, </span><br><span class="line">    &quot;stderr&quot;: &quot;Shared connection to 192.168.37.122 closed.\r\n&quot;, </span><br><span class="line">    &quot;stdout&quot;: &quot;&quot;, </span><br><span class="line">    &quot;stdout_lines&quot;: []</span><br><span class="line">&#125;</span><br><span class="line">192.168.37.133 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;changed&quot;: true, </span><br><span class="line">    &quot;rc&quot;: 0, </span><br><span class="line">    &quot;stderr&quot;: &quot;Shared connection to 192.168.37.133 closed.\r\n&quot;, </span><br><span class="line">    &quot;stdout&quot;: &quot;&quot;, </span><br><span class="line">    &quot;stdout_lines&quot;: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ã€€ã€€ç…§ä¾‹æŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶å†…å®¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># ansible web -m shell -a &#x27;cat /tmp/disk_total.log&#x27;</span><br><span class="line">192.168.37.122 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">Tue Dec  5 15:58:21 CST 2017</span><br><span class="line">Filesystem      Size  Used Avail Use% Mounted on</span><br><span class="line">/dev/sda2        47G  4.4G   43G  10% /</span><br><span class="line">devtmpfs        978M     0  978M   0% /dev</span><br><span class="line">tmpfs           993M   84K  993M   1% /dev/shm</span><br><span class="line">tmpfs           993M  9.1M  984M   1% /run</span><br><span class="line">tmpfs           993M     0  993M   0% /sys/fs/cgroup</span><br><span class="line">/dev/sda3        47G   33M   47G   1% /app</span><br><span class="line">/dev/sda1       950M  153M  798M  17% /boot</span><br><span class="line">tmpfs           199M   16K  199M   1% /run/user/42</span><br><span class="line">tmpfs           199M     0  199M   0% /run/user/0</span><br><span class="line"></span><br><span class="line">192.168.37.133 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">Tue Dec  5 15:58:21 CST 2017</span><br><span class="line">Filesystem      Size  Used Avail Use% Mounted on</span><br><span class="line">/dev/sda2        46G  4.1G   40G  10% /</span><br><span class="line">devtmpfs        898M     0  898M   0% /dev</span><br><span class="line">tmpfs           912M   84K  912M   1% /dev/shm</span><br><span class="line">tmpfs           912M  9.0M  903M   1% /run</span><br><span class="line">tmpfs           912M     0  912M   0% /sys/fs/cgroup</span><br><span class="line">/dev/sda3       3.7G   15M  3.4G   1% /app</span><br><span class="line">/dev/sda1       1.9G  141M  1.6G   9% /boot</span><br><span class="line">tmpfs           183M   16K  183M   1% /run/user/42</span><br><span class="line">tmpfs           183M     0  183M   0% /run/user/0</span><br></pre></td></tr></table></figure>
<p>ã€€ã€€å¯ä»¥çœ‹å‡ºå·²ç»æ‰§è¡ŒæˆåŠŸäº†ã€‚</p>
<h2 id="19ï¼‰setup-æ¨¡å—"><a href="#19ï¼‰setup-æ¨¡å—" class="headerlink" title="19ï¼‰setup æ¨¡å—"></a>19ï¼‰setup æ¨¡å—</h2><p>è¯¥æ¨¡å—ä¸»è¦ç”¨äºæ”¶é›†ä¿¡æ¯ï¼Œæ˜¯é€šè¿‡è°ƒç”¨factsç»„ä»¶æ¥å®ç°çš„ã€‚</p>
<p>ã€€ã€€factsç»„ä»¶æ˜¯Ansibleç”¨äºé‡‡é›†è¢«ç®¡æœºå™¨è®¾å¤‡ä¿¡æ¯çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨setupæ¨¡å—æŸ¥æœºå™¨çš„æ‰€æœ‰factsä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨filteræ¥æŸ¥çœ‹æŒ‡å®šä¿¡æ¯ã€‚æ•´ä¸ªfactsä¿¡æ¯è¢«åŒ…è£…åœ¨ä¸€ä¸ªJSONæ ¼å¼çš„æ•°æ®ç»“æ„ä¸­ï¼Œansible_factsæ˜¯æœ€ä¸Šå±‚çš„å€¼ã€‚</p>
<p>ã€€ã€€factså°±æ˜¯å˜é‡ï¼Œå†…å»ºå˜é‡ ã€‚æ¯ä¸ªä¸»æœºçš„å„ç§ä¿¡æ¯ï¼Œcpué¢—æ•°ã€å†…å­˜å¤§å°ç­‰ã€‚ä¼šå­˜åœ¨factsä¸­çš„æŸä¸ªå˜é‡ä¸­ã€‚è°ƒç”¨åè¿”å›å¾ˆå¤šå¯¹åº”ä¸»æœºçš„ä¿¡æ¯ï¼Œåœ¨åé¢çš„æ“ä½œä¸­å¯ä»¥æ ¹æ®ä¸åŒçš„ä¿¡æ¯æ¥åšä¸åŒçš„æ“ä½œã€‚å¦‚redhatç³»åˆ—ç”¨yumå®‰è£…ï¼Œè€Œdebianç³»åˆ—ç”¨aptæ¥å®‰è£…è½¯ä»¶ã€‚</p>
<p>â‘  æŸ¥çœ‹ä¿¡æ¯<br>ã€€ã€€æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨å‘½ä»¤è·å–åˆ°å˜é‡çš„å€¼ï¼Œå…·ä½“æˆ‘ä»¬æ¥çœ‹çœ‹ä¾‹å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"># ansible web -m setup -a &#x27;filter=&quot;*mem*&quot;&#x27;	#æŸ¥çœ‹å†…å­˜</span><br><span class="line">192.168.37.122 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;ansible_memfree_mb&quot;: 1116, </span><br><span class="line">        &quot;ansible_memory_mb&quot;: &#123;</span><br><span class="line">            &quot;nocache&quot;: &#123;</span><br><span class="line">                &quot;free&quot;: 1397, </span><br><span class="line">                &quot;used&quot;: 587</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;real&quot;: &#123;</span><br><span class="line">                &quot;free&quot;: 1116, </span><br><span class="line">                &quot;total&quot;: 1984, </span><br><span class="line">                &quot;used&quot;: 868</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;swap&quot;: &#123;</span><br><span class="line">                &quot;cached&quot;: 0, </span><br><span class="line">                &quot;free&quot;: 3813, </span><br><span class="line">                &quot;total&quot;: 3813, </span><br><span class="line">                &quot;used&quot;: 0</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_memtotal_mb&quot;: 1984</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;changed&quot;: false</span><br><span class="line">&#125;</span><br><span class="line">192.168.37.133 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;ansible_memfree_mb&quot;: 1203, </span><br><span class="line">        &quot;ansible_memory_mb&quot;: &#123;</span><br><span class="line">            &quot;nocache&quot;: &#123;</span><br><span class="line">                &quot;free&quot;: 1470, </span><br><span class="line">                &quot;used&quot;: 353</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;real&quot;: &#123;</span><br><span class="line">                &quot;free&quot;: 1203, </span><br><span class="line">                &quot;total&quot;: 1823, </span><br><span class="line">                &quot;used&quot;: 620</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;swap&quot;: &#123;</span><br><span class="line">                &quot;cached&quot;: 0, </span><br><span class="line">                &quot;free&quot;: 3813, </span><br><span class="line">                &quot;total&quot;: 3813, </span><br><span class="line">                &quot;used&quot;: 0</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_memtotal_mb&quot;: 1823</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;changed&quot;: false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ã€€ã€€æˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½ä»¤æŸ¥çœ‹ä¸€ä¸‹å†…å­˜çš„å¤§å°ä»¥ç¡®è®¤ä¸€ä¸‹æ˜¯å¦ä¸€è‡´ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># ansible web -m shell -a &#x27;free -m&#x27;</span><br><span class="line">192.168.37.122 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           1984         404        1122           9         457        1346</span><br><span class="line">Swap:          3813           0        3813</span><br><span class="line"></span><br><span class="line">192.168.37.133 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           1823         292        1207           9         323        1351</span><br><span class="line">Swap:          3813           0        3813</span><br></pre></td></tr></table></figure>
<p>ã€€ã€€å¯ä»¥çœ‹å‡ºä¿¡æ¯æ˜¯ä¸€è‡´çš„ã€‚</p>
<p>â‘¡ ä¿å­˜ä¿¡æ¯</p>
<p>æˆ‘ä»¬çš„setupæ¨¡å—è¿˜æœ‰ä¸€ä¸ªå¾ˆå¥½ç”¨çš„åŠŸèƒ½å°±æ˜¯å¯ä»¥ä¿å­˜æˆ‘ä»¬æ‰€ç­›é€‰çš„ä¿¡æ¯è‡³æˆ‘ä»¬çš„ä¸»æœºä¸Šï¼ŒåŒæ—¶ï¼Œæ–‡ä»¶åä¸ºæˆ‘ä»¬è¢«ç®¡åˆ¶çš„ä¸»æœºçš„IPï¼Œè¿™æ ·æ–¹ä¾¿æˆ‘ä»¬çŸ¥é“æ˜¯å“ªå°æœºå™¨å‡ºçš„é—®é¢˜ã€‚</p>
<p>ã€€ã€€<br>æˆ‘ä»¬å¯ä»¥çœ‹ä¸€çœ‹ä¾‹å­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"># ansible web -m setup -a &#x27;filter=&quot;*mem*&quot;&#x27; --tree /tmp/facts</span><br><span class="line">192.168.37.122 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;ansible_memfree_mb&quot;: 1115, </span><br><span class="line">        &quot;ansible_memory_mb&quot;: &#123;</span><br><span class="line">            &quot;nocache&quot;: &#123;</span><br><span class="line">                &quot;free&quot;: 1396, </span><br><span class="line">                &quot;used&quot;: 588</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;real&quot;: &#123;</span><br><span class="line">                &quot;free&quot;: 1115, </span><br><span class="line">                &quot;total&quot;: 1984, </span><br><span class="line">                &quot;used&quot;: 869</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;swap&quot;: &#123;</span><br><span class="line">                &quot;cached&quot;: 0, </span><br><span class="line">                &quot;free&quot;: 3813, </span><br><span class="line">                &quot;total&quot;: 3813, </span><br><span class="line">                &quot;used&quot;: 0</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_memtotal_mb&quot;: 1984</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;changed&quot;: false</span><br><span class="line">&#125;</span><br><span class="line">192.168.37.133 | SUCCESS =&gt; &#123;</span><br><span class="line">    &quot;ansible_facts&quot;: &#123;</span><br><span class="line">        &quot;ansible_memfree_mb&quot;: 1199, </span><br><span class="line">        &quot;ansible_memory_mb&quot;: &#123;</span><br><span class="line">            &quot;nocache&quot;: &#123;</span><br><span class="line">                &quot;free&quot;: 1467, </span><br><span class="line">                &quot;used&quot;: 356</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;real&quot;: &#123;</span><br><span class="line">                &quot;free&quot;: 1199, </span><br><span class="line">                &quot;total&quot;: 1823, </span><br><span class="line">                &quot;used&quot;: 624</span><br><span class="line">            &#125;, </span><br><span class="line">            &quot;swap&quot;: &#123;</span><br><span class="line">                &quot;cached&quot;: 0, </span><br><span class="line">                &quot;free&quot;: 3813, </span><br><span class="line">                &quot;total&quot;: 3813, </span><br><span class="line">                &quot;used&quot;: 0</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;ansible_memtotal_mb&quot;: 1823</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;changed&quot;: false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ã€€ã€€ç„¶åæˆ‘ä»¬å¯ä»¥å»æŸ¥çœ‹ä¸€ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># cd /tmp/facts/</span><br><span class="line"># ls</span><br><span class="line">192.168.37.122  192.168.37.133</span><br><span class="line"># cat 192.168.37.122 </span><br><span class="line">&#123;&quot;ansible_facts&quot;: &#123;&quot;ansible_memfree_mb&quot;: 1115, &quot;ansible_memory_mb&quot;: &#123;&quot;nocache&quot;: &#123;&quot;free&quot;: 1396, &quot;used&quot;: 588&#125;, &quot;real&quot;: &#123;&quot;free&quot;: 1115, &quot;total&quot;: 1984, &quot;used&quot;: 869&#125;, &quot;swap&quot;: &#123;&quot;cached&quot;: 0, &quot;free&quot;: 3813, &quot;total&quot;: 3813, &quot;used&quot;: 0&#125;&#125;, &quot;ansible_memtotal_mb&quot;: 1984&#125;, &quot;changed&quot;: false&#125;</span><br></pre></td></tr></table></figure>



<h1 id="ansibleæ‰§è¡ŒåŸç†åˆ†æ"><a href="#ansibleæ‰§è¡ŒåŸç†åˆ†æ" class="headerlink" title="ansibleæ‰§è¡ŒåŸç†åˆ†æ"></a>ansibleæ‰§è¡ŒåŸç†åˆ†æ</h1><p>æ‰§è¡Œä¹‹å ä¸»æ§èŠ‚ç‚¹ä¸Šä¼šæ˜¯è¿™æ ·çš„å‡ ä¸ªè¿›ç¨‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">â”‚   â”‚                   â””â”€bash,224417</span><br><span class="line">â”‚   â”‚                       â””â”€ansible,228966 /home/conda/envs/ansible/bin/ansible bf -i hosts -m command -a sleep 100</span><br><span class="line">â”‚   â”‚                           â”œâ”€ansible,228971 /home/conda/envs/ansible/bin/ansible bf -i hosts -m command -a sleep 100</span><br><span class="line">â”‚   â”‚                           â”‚   â””â”€ssh,229034 -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=&quot;ansible&quot; -o ConnectTimeout=10 -o ControlPath=/work/jenkins/.ansible/cp/fd15400aed -tt 192.168.xxx.31 /bin/sh -c &#x27;/usr/bin/python3 /home/ansible/.ansible/tmp/ansible-tmp-1638944600.2393298-228971-228771323588639/AnsiballZ_command.py &amp;&amp; sleep 0&#x27;</span><br><span class="line">â”‚   â”‚                           â”œâ”€ansible,228972 /home/conda/envs/ansible/bin/ansible bf -i hosts -m command -a sleep 100</span><br><span class="line">â”‚   â”‚                           â”‚   â””â”€ssh,229035 -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=&quot;ansible&quot; -o ConnectTimeout=10 -o ControlPath=/work/jenkins/.ansible/cp/0a0c5feff5 -tt 192.168.xxx.32 /bin/sh -c &#x27;/usr/bin/python3 /home/ansible/.ansible/tmp/ansible-tmp-1638944600.239494-228972-9855025113577/AnsiballZ_command.py &amp;&amp; sleep 0&#x27;</span><br><span class="line">â”‚   â”‚                           â”œâ”€ansible,228974 /home/conda/envs/ansible/bin/ansible bf -i hosts -m command -a sleep 100</span><br><span class="line">â”‚   â”‚                           â”‚   â””â”€ssh,229033 -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=&quot;ansible&quot; -o ConnectTimeout=10 -o ControlPath=/work/jenkins/.ansible/cp/bc143f4fd4 -tt 192.168.xxx.33 /bin/sh -c &#x27;/usr/bin/python3 /home/ansible/.ansible/tmp/ansible-tmp-1638944600.2476149-228974-207118697615073/AnsiballZ_command.py &amp;&amp; sleep 0&#x27;</span><br><span class="line">â”‚   â”‚                           â”œâ”€ansible,228976 /home/conda/envs/ansible/bin/ansible bf -i hosts -m command -a sleep 100</span><br><span class="line">â”‚   â”‚                           â”‚   â””â”€ssh,229036 -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=&quot;ansible&quot; -o ConnectTimeout=10 -o ControlPath=/work/jenkins/.ansible/cp/bfd44f17d4 -tt 192.168.xxx.34 /bin/sh -c &#x27;/usr/bin/python3 /home/ansible/.ansible/tmp/ansible-tmp-1638944600.255245-228976-274177687105611/AnsiballZ_command.py &amp;&amp; sleep 0&#x27;</span><br><span class="line">â”‚   â”‚                           â”œâ”€ansible,228979 /home/conda/envs/ansible/bin/ansible bf -i hosts -m command -a sleep 100</span><br><span class="line">â”‚   â”‚                           â”‚   â””â”€ssh,229032 -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=&quot;ansible&quot; -o ConnectTimeout=10 -o ControlPath=/work/jenkins/.ansible/cp/278053c7e1 -tt 192.168.xxx.35 /bin/sh -c &#x27;/usr/bin/python3 /home/ansible/.ansible/tmp/ansible-tmp-1638944600.2513506-228979-200134538240917/AnsiballZ_command.py &amp;&amp; sleep 0&#x27;</span><br><span class="line">â”‚   â”‚                           â””â”€&#123;ansible&#125;,228970</span><br></pre></td></tr></table></figure>

<h2 id="1-å½“æˆ‘ä»¬æ‰§è¡Œansibleå‘½ä»¤-ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"><a href="#1-å½“æˆ‘ä»¬æ‰§è¡Œansibleå‘½ä»¤-ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. å½“æˆ‘ä»¬æ‰§è¡Œansibleå‘½ä»¤ ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"></a>1. å½“æˆ‘ä»¬æ‰§è¡Œansibleå‘½ä»¤ ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ansible 192.168.xxx.31 -f 1 -m command -a &#x27;sleep 100&#x27; -o</span><br><span class="line"></span><br><span class="line">ä¸»æ§èŠ‚ç‚¹ä¸Šæ‰§è¡Œå¦‚ä¸‹ï¼š</span><br><span class="line">ansible,832930 /home/conda/envs/ansible/bin/ansible 192.168.xxx.31 -f 1 -m command -a sleep 100 -o</span><br><span class="line">  â”œâ”€ansible,833070 /home/conda/envs/ansible/bin/ansible 192.168.xxx.31 -f 1 -m command -a sleep 100 -o</span><br><span class="line">  â””â”€ssh,833089 -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=&quot;ansible&quot; -o ConnectTimeout=10 -o ControlPath=/tmp/ansibletmpl/cp/ansible-ssh-%h-%p-%r -tt 192.168.xxx.31 /bin/bash -c &#x27;/usr/bin/python3 /tmp/ansibletmpr/ansible-tmp-1638962875.8801572-833070-192363216003291/AnsiballZ_command.py &amp;&amp; sleep 0&#x27;</span><br><span class="line">  â”‚   â””â”€&#123;ansible&#125;,833069</span><br><span class="line">å¯ä»¥çœ‹åˆ°ä¸»æ§èŠ‚ç‚¹ä¸Šæ˜¯ç›´æ¥æ‰§è¡Œäº† ssh å‘½ä»¤ï¼Œç®€å†™ä¸º ssh 192.168.xxx.31 /bin/bash xxxx</span><br><span class="line">æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ° æ˜¯æ‰§è¡Œäº†è¿œç«¯æœåŠ¡å™¨ä¸Šçš„ä¸€ä¸ªpyè„šæœ¬ã€‚</span><br><span class="line"></span><br><span class="line">è¢«æ§èŠ‚ç‚¹ä¸Šæ‰§è¡Œ</span><br><span class="line">â””â”€bash -c /usr/bin/python3 /tmp/ansibletmpr/ansible-tmp-1638962875.8801572-833070-192363216003291/AnsiballZ_command.py &amp;&amp; sleep 0</span><br><span class="line">    â””â”€python3  /tmp/ansibletmpr/ansible-tmp-1638962875.8801572-833070-192363216003291/AnsiballZ_command.py</span><br><span class="line">    â””â”€sleep  100</span><br><span class="line">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿œç«¯æœåŠ¡å™¨ä¸Šæ˜¯æ‰§è¡Œäº†ä¸€ä¸ªpyè„šæœ¬ï¼Œpyè„šæœ¬é‡Œé¢è°ƒç”¨äº†æˆ‘ä»¬çš„å‘½ä»¤ sleep 100 è¿™ä¸ªã€‚</span><br></pre></td></tr></table></figure>

<h2 id="2-å¦‚ä½•ä½¿ç”¨sudoã€root-ç­‰ç‰¹æƒå‘½ä»¤ï¼Ÿï¼Ÿ"><a href="#2-å¦‚ä½•ä½¿ç”¨sudoã€root-ç­‰ç‰¹æƒå‘½ä»¤ï¼Ÿï¼Ÿ" class="headerlink" title="2. å¦‚ä½•ä½¿ç”¨sudoã€root ç­‰ç‰¹æƒå‘½ä»¤ï¼Ÿï¼Ÿ"></a>2. å¦‚ä½•ä½¿ç”¨sudoã€root ç­‰ç‰¹æƒå‘½ä»¤ï¼Ÿï¼Ÿ</h2><p>ä½¿ç”¨ â€“become-method sudo -b æå‡æƒé™å»æ‰§è¡Œå‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible -i tools/ansible/inventory.conf -m command -a &#x27;sleep 60&#x27; --forks 1  192.168.12.31 -v --become-method sudo -b</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ä¸»æ§æœåŠ¡å™¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â”€ansible,457479 /home/conda/envs/ansible/bin/ansible -i tools/ansible/inventory.conf -m command -a sleep 60 --forks 1 192.168.12.31 -v --become-method sudo -b</span><br><span class="line">   â”œâ”€ansible,457587 /home/conda/envs/ansible/bin/ansible -i tools/ansible/inventory.conf -m command -a sleep 60 --forks 1 192.168.12.31 -v --become-method sudo -b</span><br><span class="line">   â”‚   â””â”€ssh,457596 -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=&quot;buildfarm&quot; -o ConnectTimeout=10 -o ControlPath=/tmp/buildfarm/ansibletmpcp/ansible-ssh-%h-%p-%r -tt 192.168.12.31 /bin/bash -c &#x27;sudo -H -S -n  -u root /bin/bash -c &#x27;&quot;&#x27;&quot;&#x27;echo BECOME-SUCCESS-irtokqitnflolaawnheahtwcoduedpsx ; /usr/bin/python3 /tmp/buildfarm/ansibletmpr/ansible-tmp-1648609937.0120566-457587-22932890217715/AnsiballZ_command.py&#x27;&quot;&#x27;&quot;&#x27; &amp;&amp; sleep 0&#x27;</span><br><span class="line">   â””â”€&#123;ansible&#125;,457586</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯è¢«æ‰§è¡ŒæœåŠ¡å™¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â”‚   â”œâ”€sshd,2313068</span><br><span class="line">â”‚   â”‚   â””â”€sshd,2313079</span><br><span class="line">â”‚   â”‚       â””â”€bash,2313233 -c sudo -H -S -n  -u root /bin/bash -c &#x27;echo BECOME-SUCCESS-irtokqitnflolaawnheahtwcoduedpsx ; /usr/bin/python3 /tmp/buildfarm/ansibletmpr/ansible-tmp-1648609937.0120566-457587-22932890217715/AnsiballZ_command.py&#x27; &amp;&amp; sleep 0</span><br><span class="line">â”‚   â”‚           â””â”€sudo,2313234 -H -S -n -u root /bin/bash -c echo BECOME-SUCCESS-irtokqitnflolaawnheahtwcoduedpsx ; /usr/bin/python3 /tmp/buildfarm/ansibletmpr/ansible-tmp-1648609937.0120566-457587-22932890217715/AnsiballZ_command.py</span><br><span class="line">â”‚   â”‚               â””â”€bash,2313235 -c echo BECOME-SUCCESS-irtokqitnflolaawnheahtwcoduedpsx ; /usr/bin/python3 /tmp/buildfarm/ansibletmpr/ansible-tmp-1648609937.0120566-457587-22932890217715/AnsiballZ_command.py</span><br><span class="line">â”‚   â”‚                   â””â”€python3,2313236 /tmp/buildfarm/ansibletmpr/ansible-tmp-1648609937.0120566-457587-22932890217715/AnsiballZ_command.py</span><br><span class="line">â”‚   â”‚                       â””â”€sleep,2313238 60</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ â€“become-user â€˜â€™ æŒ‡å®šä¸ªç©ºçš„ç”¨æˆ·</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(ansible) buildfarm@jenkins-master:~$ ansible -i tools/ansible/inventory.conf -m command -a &#x27;sleep 60&#x27; --forks 1  192.168.12.31 -v --become-method sudo -b --become-user &#x27;&#x27;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°è¿œç¨‹è¢«æ§æœåŠ¡å™¨å°±ä¼šæ‰§è¡Œsudo -H -S -n &#x2F;bin&#x2F;bash -c â€˜â€™ è¿™æ ·çš„å‘½ä»¤äº†ï¼Œå°‘äº†ä¸€ä¸ª -u root è¿™ä¸ªå‚æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â”‚   â””â”€sshd,2313389</span><br><span class="line">â”‚       â””â”€sshd,2313400</span><br><span class="line">â”‚           â””â”€bash,2313442 -c sudo -H -S -n   /bin/bash -c &#x27;echo BECOME-SUCCESS-rqpombkywyxtrdmhmlrjbsfstljrwscc ; /usr/bin/python3 /tmp/buildfarm/ansibletmpr/ansible-tmp-1648613811.7588933-542772-245836208212105/AnsiballZ_command.py&#x27; &amp;&amp; sleep 0</span><br><span class="line">â”‚               â””â”€sudo,2313443 -H -S -n /bin/bash -c echo BECOME-SUCCESS-rqpombkywyxtrdmhmlrjbsfstljrwscc ; /usr/bin/python3 /tmp/buildfarm/ansibletmpr/ansible-tmp-1648613811.7588933-542772-245836208212105/AnsiballZ_command.py</span><br><span class="line">â”‚                   â””â”€bash,2313445 -c echo BECOME-SUCCESS-rqpombkywyxtrdmhmlrjbsfstljrwscc ; /usr/bin/python3 /tmp/buildfarm/ansibletmpr/ansible-tmp-1648613811.7588933-542772-245836208212105/AnsiballZ_command.py</span><br><span class="line">â”‚                       â””â”€python3,2313446 /tmp/buildfarm/ansibletmpr/ansible-tmp-1648613811.7588933-542772-245836208212105/AnsiballZ_command.py</span><br><span class="line">â”‚                           â””â”€sleep,2313448 60</span><br></pre></td></tr></table></figure>



<h2 id="copyæ¨¡å—æ‰§è¡Œåˆ†æ"><a href="#copyæ¨¡å—æ‰§è¡Œåˆ†æ" class="headerlink" title="copyæ¨¡å—æ‰§è¡Œåˆ†æ"></a>copyæ¨¡å—æ‰§è¡Œåˆ†æ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">ç›®æ ‡æœºå™¨ä¸Šæ‰§è¡Œ AnsiballZ_copy.py</span><br><span class="line"></span><br><span class="line">â”€ansible,1415889 /home/conda/envs/ansible/bin/ansible 10.0.12.31 -m copy -a src=/work/backup/ dest=/tmp/a/b/c/telegraf/</span><br><span class="line">  â”‚   â”‚ â”œâ”€ansible,1415895 /home/conda/envs/ansible/bin/ansible 10.0.12.31 -m copy -a src=/work/backup/ dest=/tmp/a/b/c/telegraf/</span><br><span class="line">  â”‚   â”‚ â”‚   â””â”€sftp,1417138 -b - -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=&quot;buildfarm&quot; -o ConnectTimeout=10 [10.0.12.31]</span><br><span class="line">  â”‚   â”‚ â”‚       â””â”€ssh,1417139 -oForwardX11 no -oForwardAgent no -oPermitLocalCommand no -oClearAllForwardings yes -obatchmode yes -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=&quot;buildfarm&quot; -o ConnectTimeout=10 -oProtocol 2 -s -- 10.0.12.31 sftp</span><br><span class="line">ä¸»æ§æœåŠ¡å™¨ä¼šé€šè¿‡ftp æŠŠ src æŒ‡å®šçš„ æºç›®å½•ä¸‹é¢çš„æ–‡ä»¶ä¸€ä¸ªä¸€ä¸ªä¸Šä¼ åˆ° /tmp/buildfarm/ansibletmpr/xxxxx/source è¿™ä¸ªæ–‡ä»¶ã€‚tmpè·¯å¾„æ˜¯ æˆ‘ä»¬åœ¨ ansible.cfg æ–‡ä»¶ä¸­é…ç½®çš„remote_tmp      = /tmp/$USER/ansibletmpr</span><br><span class="line"></span><br><span class="line">é€šè¿‡ftpä¸Šä¼ åˆ°ç›®æ ‡æœåŠ¡å™¨ä¹‹åï¼Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šä¼šæ‰§è¡Œ ä¸‹é¢è¿™ä¸ª AnsiballZ_copy.py è„šæœ¬çš„</span><br><span class="line">â””â”€bash,1838989 -c /usr/bin/python3 /tmp/buildfarm/ansibletmpr/ansible-tmp-1648990563.6564553-1431017-227311237310306/AnsiballZ_copy.py &amp;&amp; sleep 0</span><br><span class="line">    â””â”€python3,1838990 /tmp/buildfarm/ansibletmpr/ansible-tmp-1648990563.6564553-1431017-227311237310306/AnsiballZ_copy.py</span><br><span class="line"></span><br><span class="line">â”œâ”€â”€ [  60]  /tmp/buildfarm</span><br><span class="line">â”‚Â Â  â””â”€â”€ [  60]  /tmp/buildfarm/ansibletmpr</span><br><span class="line">â”‚Â Â      â””â”€â”€ [ 100]  /tmp/buildfarm/ansibletmpr/ansible-tmp-1648990563.6564553-1431017-227311237310306</span><br><span class="line">â”‚Â Â          â”œâ”€â”€ [133K]  /tmp/buildfarm/ansibletmpr/ansible-tmp-1648990563.6564553-1431017-227311237310306/AnsiballZ_copy.py</span><br><span class="line">â”‚Â Â          â”œâ”€â”€ [128K]  /tmp/buildfarm/ansibletmpr/ansible-tmp-1648990563.6564553-1431017-227311237310306/AnsiballZ_stat.py</span><br><span class="line">â”‚Â Â          â””â”€â”€ [402M]  /tmp/buildfarm/ansibletmpr/ansible-tmp-1648990563.6564553-1431017-227311237310306/source</span><br><span class="line">åœ¨ç›®æ ‡æœºå™¨ä¸Š ä¼šæŠŠ æ–‡ä»¶ /tmp/buildfarm/ansibletmpr/ansible-tmp-1648990563.6564553-1431017-227311237310306/source å†æ¬¡å¤åˆ¶åˆ° destæŒ‡å®šçš„ç›®å½•ä¸‹é¢</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>






</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://magesfc.github.io">mage</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://magesfc.github.io/mage/c17549d1cd4516fc242a8551d78cc1754d69a33e/">https://magesfc.github.io/mage/c17549d1cd4516fc242a8551d78cc1754d69a33e/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://magesfc.github.io" target="_blank">é©¬å“¥ç§æˆ¿èœ</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ansible/">ansible</a></div><div class="post_share"><div class="social-share" data-image="https://t.mwm.moe/fj/" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> æ‰“èµ</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="/null" alt="å¾®ä¿¡"/></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="/null" alt="æ”¯ä»˜å¯¶"/></a><div class="post-qr-code-desc">æ”¯ä»˜å¯¶</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/mage/041aeaf616293d64689343ad605f14cf73b589b0/"><img class="prev-cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">Djangoå­¦ä¹ ä¹‹åˆè¯†</div></div></a></div><div class="next-post pull-right"><a href="/mage/3988ad506287c3c5ea81a4669e671c026ed1520e/"><img class="next-cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹æ€»ä½“ä»‹ç»æ€»ç»“</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/mage/9797fe175c0183a6563e7397692d780ecf683a6f/" title="Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹ansible-resources"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-16</div><div class="title">Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹ansible-resources</div></div></a></div><div><a href="/mage/531887d5e7eb014078dd6f2951d13500e0551ca5/" title="Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹playbookä»‹ç»"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-04</div><div class="title">Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹playbookä»‹ç»</div></div></a></div><div><a href="/mage/c480dbde40d58e354795a1a408fdb8bad06fe7cc/" title="Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹roleä»‹ç»"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-01</div><div class="title">Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹roleä»‹ç»</div></div></a></div><div><a href="/mage/a0bfcc2b49b5167196ecf1ed7f20f9eb180d9a43/" title="Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹synchronizeæ¨¡å—å­¦ä¹ "><img class="cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-13</div><div class="title">Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹synchronizeæ¨¡å—å­¦ä¹ </div></div></a></div><div><a href="/mage/3988ad506287c3c5ea81a4669e671c026ed1520e/" title="Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹æ€»ä½“ä»‹ç»æ€»ç»“"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-04</div><div class="title">Ansibleè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ä¹‹æ€»ä½“ä»‹ç»æ€»ç»“</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">mage</div><div class="author-info__description"> è¿™é‡Œæ˜¯ é©¬å“¥ çš„ä¸ªäººåšå®¢ </div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">212</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">230</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">40</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/mamh2021"><i class="fab fa-github"></i><span>GitHub</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/mamh2021" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ansible-%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97"><span class="toc-number">1.</span> <span class="toc-text">ansible å¸¸ç”¨æ¨¡å—</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ansible-%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97-1"><span class="toc-number">2.</span> <span class="toc-text">ansible å¸¸ç”¨æ¨¡å—</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-ping%E6%A8%A1%E5%9D%97"><span class="toc-number">2.1.</span> <span class="toc-text">1)pingæ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-command%E6%A8%A1%E5%9D%97"><span class="toc-number">2.2.</span> <span class="toc-text">2)commandæ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-shell%E6%A8%A1%E5%9D%97"><span class="toc-number">2.3.</span> <span class="toc-text">3)shellæ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-copy%E6%A8%A1%E5%9D%97"><span class="toc-number">2.4.</span> <span class="toc-text">4)copyæ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-fetch%E6%A8%A1%E5%9D%97"><span class="toc-number">2.5.</span> <span class="toc-text">5)fetchæ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-file%E6%A8%A1%E5%9D%97"><span class="toc-number">2.6.</span> <span class="toc-text">6)fileæ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-yum%E6%A8%A1%E5%9D%97"><span class="toc-number">2.7.</span> <span class="toc-text">7)yumæ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-systemd%E6%A8%A1%E5%9D%97"><span class="toc-number">2.8.</span> <span class="toc-text">8)systemdæ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-cron%E6%A8%A1%E5%9D%97"><span class="toc-number">2.9.</span> <span class="toc-text">9)cronæ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-get-url%E6%A8%A1%E5%9D%97"><span class="toc-number">2.10.</span> <span class="toc-text">10)get_urlæ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-mount%E6%A8%A1%E5%9D%97"><span class="toc-number">2.11.</span> <span class="toc-text">11)mountæ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-archive%E6%A8%A1%E5%9D%97"><span class="toc-number">2.12.</span> <span class="toc-text">12)archiveæ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-unarchive%E6%A8%A1%E5%9D%97"><span class="toc-number">2.13.</span> <span class="toc-text">13)unarchiveæ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-selinux%E6%A8%A1%E5%9D%97"><span class="toc-number">2.14.</span> <span class="toc-text">14)selinuxæ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-service-%E6%A8%A1%E5%9D%97"><span class="toc-number">2.15.</span> <span class="toc-text">15)service æ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16%EF%BC%89user-%E6%A8%A1%E5%9D%97"><span class="toc-number">2.16.</span> <span class="toc-text">16ï¼‰user æ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17%EF%BC%89group-%E6%A8%A1%E5%9D%97"><span class="toc-number">2.17.</span> <span class="toc-text">17ï¼‰group æ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18%EF%BC%89script-%E6%A8%A1%E5%9D%97"><span class="toc-number">2.18.</span> <span class="toc-text">18ï¼‰script æ¨¡å—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19%EF%BC%89setup-%E6%A8%A1%E5%9D%97"><span class="toc-number">2.19.</span> <span class="toc-text">19ï¼‰setup æ¨¡å—</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ansible%E6%89%A7%E8%A1%8C%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90"><span class="toc-number">3.</span> <span class="toc-text">ansibleæ‰§è¡ŒåŸç†åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%BD%93%E6%88%91%E4%BB%AC%E6%89%A7%E8%A1%8Cansible%E5%91%BD%E4%BB%A4-%E4%B9%8B%E5%90%8E%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">3.1.</span> <span class="toc-text">1. å½“æˆ‘ä»¬æ‰§è¡Œansibleå‘½ä»¤ ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8sudo%E3%80%81root-%E7%AD%89%E7%89%B9%E6%9D%83%E5%91%BD%E4%BB%A4%EF%BC%9F%EF%BC%9F"><span class="toc-number">3.2.</span> <span class="toc-text">2. å¦‚ä½•ä½¿ç”¨sudoã€root ç­‰ç‰¹æƒå‘½ä»¤ï¼Ÿï¼Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#copy%E6%A8%A1%E5%9D%97%E6%89%A7%E8%A1%8C%E5%88%86%E6%9E%90"><span class="toc-number">3.3.</span> <span class="toc-text">copyæ¨¡å—æ‰§è¡Œåˆ†æ</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/mage/53776646b88e8b3c368d34d9936b880421441770/" title="Linuxå­¦ä¹ ä¹‹bashå­¦ä¹ ä¹‹åœ¨bashä¸­Quotingçš„è§£é‡Š"><img src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linuxå­¦ä¹ ä¹‹bashå­¦ä¹ ä¹‹åœ¨bashä¸­Quotingçš„è§£é‡Š"/></a><div class="content"><a class="title" href="/mage/53776646b88e8b3c368d34d9936b880421441770/" title="Linuxå­¦ä¹ ä¹‹bashå­¦ä¹ ä¹‹åœ¨bashä¸­Quotingçš„è§£é‡Š">Linuxå­¦ä¹ ä¹‹bashå­¦ä¹ ä¹‹åœ¨bashä¸­Quotingçš„è§£é‡Š</a><time datetime="2024-03-23T10:41:42.000Z" title="æ›´æ–°äº 2024-03-23 18:41:42">2024-03-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/0158e8186f0827d0b00df276735e46e876749b88/" title="Linuxå­¦ä¹ ä¹‹bashå­¦ä¹ ä¹‹åœ¨bashä¸­=å’Œ=~çš„åŒºåˆ«"><img src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linuxå­¦ä¹ ä¹‹bashå­¦ä¹ ä¹‹åœ¨bashä¸­=å’Œ=~çš„åŒºåˆ«"/></a><div class="content"><a class="title" href="/mage/0158e8186f0827d0b00df276735e46e876749b88/" title="Linuxå­¦ä¹ ä¹‹bashå­¦ä¹ ä¹‹åœ¨bashä¸­=å’Œ=~çš„åŒºåˆ«">Linuxå­¦ä¹ ä¹‹bashå­¦ä¹ ä¹‹åœ¨bashä¸­=å’Œ=~çš„åŒºåˆ«</a><time datetime="2024-03-23T10:00:34.000Z" title="æ›´æ–°äº 2024-03-23 18:00:34">2024-03-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/29b1dee9b6336ea01be4716d95ecfbad663018d6/" title="Linuxå­¦ä¹ ä¹‹bashå­¦ä¹ ä¹‹å‡ ä¸ªç‰¹æ®Šå˜é‡"><img src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linuxå­¦ä¹ ä¹‹bashå­¦ä¹ ä¹‹å‡ ä¸ªç‰¹æ®Šå˜é‡"/></a><div class="content"><a class="title" href="/mage/29b1dee9b6336ea01be4716d95ecfbad663018d6/" title="Linuxå­¦ä¹ ä¹‹bashå­¦ä¹ ä¹‹å‡ ä¸ªç‰¹æ®Šå˜é‡">Linuxå­¦ä¹ ä¹‹bashå­¦ä¹ ä¹‹å‡ ä¸ªç‰¹æ®Šå˜é‡</a><time datetime="2024-03-23T09:51:41.000Z" title="æ›´æ–°äº 2024-03-23 17:51:41">2024-03-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/8578f837ae5bc22b09842c0f84ac8860bb13a393/" title="Linuxå­¦ä¹ ä¹‹å¸¸ç”¨çš„githubä»“åº“"><img src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linuxå­¦ä¹ ä¹‹å¸¸ç”¨çš„githubä»“åº“"/></a><div class="content"><a class="title" href="/mage/8578f837ae5bc22b09842c0f84ac8860bb13a393/" title="Linuxå­¦ä¹ ä¹‹å¸¸ç”¨çš„githubä»“åº“">Linuxå­¦ä¹ ä¹‹å¸¸ç”¨çš„githubä»“åº“</a><time datetime="2024-03-23T09:41:50.000Z" title="æ›´æ–°äº 2024-03-23 17:41:50">2024-03-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mage/d09beb62ca31e9a0cf278d3ff1a8795bc551ec06/" title="Linuxå­¦ä¹ ä¹‹æ–‡ä»¶ç³»ç»Ÿzfsæ€§èƒ½ä¼˜åŒ–"><img src= "/img/loading.gif" data-lazy-src="https://t.mwm.moe/fj/" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linuxå­¦ä¹ ä¹‹æ–‡ä»¶ç³»ç»Ÿzfsæ€§èƒ½ä¼˜åŒ–"/></a><div class="content"><a class="title" href="/mage/d09beb62ca31e9a0cf278d3ff1a8795bc551ec06/" title="Linuxå­¦ä¹ ä¹‹æ–‡ä»¶ç³»ç»Ÿzfsæ€§èƒ½ä¼˜åŒ–">Linuxå­¦ä¹ ä¹‹æ–‡ä»¶ç³»ç»Ÿzfsæ€§èƒ½ä¼˜åŒ–</a><time datetime="2024-03-23T09:40:51.000Z" title="æ›´æ–°äº 2024-03-23 17:40:51">2024-03-23</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://t.mwm.moe/fj/')"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By mage</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>